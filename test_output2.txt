
> neurotoxic-game@0.0.0 test
> node --test --import tsx --experimental-test-module-mocks --import ./tests/setup.mjs

[GameState] Regional reputation loss in Berlin due to poor gig performance (-10) 
ÔûÂ Crisis Management Integration
  ÔûÂ Gap A: Regional Reputation Penalty on Poor Performance
    Ô£ö should deduct 10 regional reputation if gig score is < 30 (4.4016ms)
    Ô£ö should NOT deduct regional reputation if gig score is >= 30 (0.3282ms)
  Ô£ö Gap A: Regional Reputation Penalty on Poor Performance (5.5949ms)
  ÔûÂ Gap I & G: Controversy Passive Effects
    Ô£ö should drain more harmony/mood when controversy is >= 50 (0.7085ms)
    Ô£ö should drop sponsor with 20% chance if controversy is >= 80 (0.2982ms)
  Ô£ö Gap I & G: Controversy Passive Effects (1.2198ms)
Ô£ö Crisis Management Integration (7.3933ms)
(node:29496) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ CrowdManager
  Ô£ö loadAssets loads textures correctly (154.6766ms)
  Ô£ö init creates Sprites when texture is available (10.6023ms)
  Ô£ö init creates Graphics when texture is missing (13.5766ms)
  Ô£ö update switches texture to MOSH when combo > 20 (10.5911ms)
  Ô£ö update switches texture to MOSH when toxic mode is on (6.6501ms)
  Ô£ö update handles missing mosh texture gracefully (6.5323ms)
Ô£ö CrowdManager (204.8672ms)
(node:39900) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ EffectManager
  Ô£ö loadAssets loads textures correctly (156.5133ms)
  Ô£ö spawnHitEffect uses blood texture for red colors (8.3442ms)
  Ô£ö spawnHitEffect uses toxic texture for non-red colors (7.408ms)
  Ô£ö spawnHitEffect falls back to generic Sprite if textures missing (7.8905ms)
  Ô£ö update handles lifecycle and cleanup (15.8931ms)
  Ô£ö dispose clears resources and destroys container (11.5141ms)
  Ô£ö spawnHitEffect enforces max active effects limit (50) and recycles (8.7771ms)
  Ô£ö spawnHitEffect reuses sprites from pool (6.1216ms)
  Ô£ö spawnHitEffect removes the oldest effect (lowest life) even if array is unordered (11.7379ms)
Ô£ö EffectManager (236.4514ms)
(node:22740) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ LaneManager
  Ô£ö draws inactive hit bars with translucent lane color fill (88.9915ms)
  Ô£ö draws static lane guide strip for readability (6.0124ms)
  Ô£ö activates hit bars with stronger fill and white border (4.7702ms)
  Ô£ö does not redraw static lanes on first update frame (3.9741ms)
Ô£ö LaneManager (105.8713ms)
(node:27252) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ NoteManager
  Ô£ö acquireSpriteFromPool returns a new sprite if pool is empty (178.3709ms)
  Ô£ö acquireSpriteFromPool reuses a sprite from the pool (11.9291ms)
  Ô£ö createNoteSprite creates a fallback Sprite with WHITE texture if texture is missing (9.7239ms)
  Ô£ö initializeNoteSprite sets properties correctly for fallback sprite (6.5365ms)
  Ô£ö initializeNoteSprite sets correct texture for lightning lane (5.6401ms)
  Ô£ö initializeNoteSprite sets correct texture for skull lane (6.3093ms)
  Ô£ö acquireSpriteFromPool reuses a Sprite for fallback (5.993ms)
  Ô£ö initializeNoteSprite sets jitterOffset property (5.4258ms)
  Ô£ö update spawns notes when time is reached (6.5292ms)
  Ô£ö update positions visible notes (6.8135ms)
  Ô£ö update handles hit notes and calls onHit (8.7934ms)
  Ô£ö dispose clears resources (9.9637ms)
  Ô£ö notesVersion: initial call resets lastNotesVersion from null to 0 (9.8806ms)
  Ô£ö notesVersion: same version on subsequent calls does not reset render index (8.8616ms)
  Ô£ö notesVersion: version change resets render index and destroys existing sprites (8.1235ms)
  Ô£ö notesVersion: dispose resets lastNotesVersion to null (12.1503ms)
  Ô£ö releaseSpriteToPool respects MAX_POOL_SIZE (8.4856ms)
Ô£ö NoteManager (312.4444ms)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
(node:19656) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ Pixi Resolution Capping
  Ô£ö getOptimalResolution caps resolution at 2 (16403.668ms)
  Ô£ö PixiStageController uses capped resolution (8.6884ms)
  Ô£ö TourbusStageController uses capped resolution (7.9463ms)
  Ô£ö RoadieStageController uses capped resolution (8.175ms)
Ô£ö Pixi Resolution Capping (16430.1027ms)
(node:2144) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ PixiStageController
  Ô£ö init initializes managers (162.2885ms)
  Ô£ö handleTicker updates managers (9.0181ms)
  Ô£ö dispose disposes managers (5.5648ms)
Ô£ö PixiStageController (180.3744ms)
(node:20872) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ TourbusStageController
  Ô£ö should initialize correctly (192.027ms)
  Ô£ö should handle asset loading (5.5936ms)
  Ô£ö should run update loop via ticker (5.0448ms)
  Ô£ö should render obstacles in ticker (3.558ms)
  Ô£ö should remove obstacles that disappear from state (4.7956ms)
  Ô£ö should dispose correctly (4.1159ms)
Ô£ö TourbusStageController (217.3617ms)
ÔûÂ Action Creators
  ÔûÂ createChangeSceneAction
    Ô£ö should create correct action (1.0246ms)
  Ô£ö createChangeSceneAction (1.993ms)
  ÔûÂ createUpdatePlayerAction
    Ô£ö should create correct action (1.1507ms)
  Ô£ö createUpdatePlayerAction (1.4102ms)
  ÔûÂ createUpdateBandAction
    Ô£ö should create correct action (0.6694ms)
  Ô£ö createUpdateBandAction (0.9117ms)
  ÔûÂ createUpdateSocialAction
    Ô£ö should create correct action (0.3642ms)
  Ô£ö createUpdateSocialAction (0.7296ms)
  ÔûÂ createUpdateSettingsAction
    Ô£ö should create correct action (0.4575ms)
  Ô£ö createUpdateSettingsAction (0.6965ms)
  ÔûÂ createSetMapAction
    Ô£ö should create correct action (0.2569ms)
  Ô£ö createSetMapAction (0.3871ms)
  ÔûÂ createSetGigAction
    Ô£ö should create correct action (0.2007ms)
  Ô£ö createSetGigAction (0.306ms)
  ÔûÂ createStartGigAction
    Ô£ö should create correct action (0.212ms)
  Ô£ö createStartGigAction (0.3013ms)
  ÔûÂ createSetSetlistAction
    Ô£ö should create correct action (0.2355ms)
  Ô£ö createSetSetlistAction (0.3629ms)
  ÔûÂ createSetLastGigStatsAction
    Ô£ö should create correct action (0.3071ms)
  Ô£ö createSetLastGigStatsAction (0.4129ms)
  ÔûÂ createSetActiveEventAction
    Ô£ö should create correct action with event (0.2815ms)
    Ô£ö should create correct action with null (0.1357ms)
  Ô£ö createSetActiveEventAction (0.5504ms)
  ÔûÂ createAddToastAction
    Ô£ö should create correct action with default type (0.3632ms)
    Ô£ö should create correct action with custom type (0.1696ms)
  Ô£ö createAddToastAction (0.6585ms)
  ÔûÂ createRemoveToastAction
    Ô£ö should create correct action (0.1932ms)
  Ô£ö createRemoveToastAction (0.2756ms)
  ÔûÂ createSetGigModifiersAction
    Ô£ö should create correct action with object (0.5423ms)
    Ô£ö should create correct action with function (0.3598ms)
  Ô£ö createSetGigModifiersAction (1.1081ms)
  ÔûÂ createLoadGameAction
    Ô£ö should create correct action (0.2525ms)
  Ô£ö createLoadGameAction (0.5256ms)
  ÔûÂ createResetStateAction
    Ô£ö should create correct action (0.1712ms)
  Ô£ö createResetStateAction (0.4251ms)
  ÔûÂ createApplyEventDeltaAction
    Ô£ö should create correct action (1.9015ms)
  Ô£ö createApplyEventDeltaAction (2.1407ms)
  ÔûÂ createPopPendingEventAction
    Ô£ö should create correct action (0.2737ms)
  Ô£ö createPopPendingEventAction (0.3959ms)
  ÔûÂ createConsumeItemAction
    Ô£ö should create correct action (0.1812ms)
  Ô£ö createConsumeItemAction (0.279ms)
  ÔûÂ createAdvanceDayAction
    Ô£ö should create correct action (0.227ms)
  Ô£ö createAdvanceDayAction (1.2018ms)
  ÔûÂ createUnlockTraitAction
    Ô£ö creates correct action (0.8079ms)
  Ô£ö createUnlockTraitAction (0.9303ms)
Ô£ö Action Creators (18.3744ms)
[ArrivalLogic] Starting Gig at destination { venue: 'The Club' }
[ArrivalLogic] Starting Gig at destination { venue: 'The Club' }
[ArrivalLogic] Starting Gig at destination { venue: 'The Club' }
[ArrivalLogic] Starting Gig at destination { venue: 'The Club' }
[ErrorHandler] Failed to load song {
  name: 'Error',
  message: 'Failed to load song',
  category: 'unknown',
  severity: 'medium',
  context: {},
  recoverable: true,
  timestamp: 1772193568085,
  stack: 'Error: Failed to load song\n' +
    '    at TestContext.<anonymous> (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/tests/arrivalUtils.test.js:147:19)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at Suite.processPendingSubtests (node:internal/test_runner/test:788:18)\n' +
    '    at Test.postRun (node:internal/test_runner/test:1235:19)\n' +
    '    at Test.run (node:internal/test_runner/test:1163:12)\n' +
    '    at async Suite.processPendingSubtests (node:internal/test_runner/test:788:7)'
}
ÔûÂ handleNodeArrival
  Ô£ö REST_STOP - updates band stamina and mood (2.2625ms)
  Ô£ö START - calls onShowHQ and adds toast (0.5567ms)
  Ô£ö SPECIAL - triggers event when none active (0.4072ms)
  Ô£ö SPECIAL - does not trigger event when already active (0.249ms)
  Ô£ö SPECIAL - adds toast if no event triggered (0.2978ms)
  Ô£ö GIG - starts gig if harmony > 0 (4.3318ms)
  Ô£ö GIG - fails to start gig if harmony <= 0 (0.559ms)
  Ô£ö FESTIVAL - starts gig if harmony > 0 (0.7875ms)
  Ô£ö FESTIVAL - fails to start gig if harmony <= 0 (0.3349ms)
  Ô£ö FINALE - starts gig if harmony > 0 (0.5916ms)
  Ô£ö FINALE - fails to start gig if harmony <= 0 (0.1775ms)
  Ô£ö GIG - handles startGig error (3.6258ms)
Ô£ö handleNodeArrival (16.4674ms)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
[AudioEngine] Audio asset "test-asset.ogg" not found in bundle, falling back to public path: /assets/test-asset.ogg 
[AudioEngine] Decoded audio buffer: "test-asset.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 1 items, 0.00MB 
[AudioEngine] Audio asset "cached-asset.ogg" not found in bundle, falling back to public path: /assets/cached-asset.ogg 
[AudioEngine] Decoded audio buffer: "cached-asset.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 1 items, 0.00MB 
[AudioEngine] Audio asset "missing.ogg" not found in bundle, falling back to public path: /assets/missing.ogg 
[AudioEngine] Failed to load audio "missing.ogg": HTTP 404 from /assets/missing.ogg 
[AudioEngine] Audio asset "network-error.ogg" not found in bundle, falling back to public path: /assets/network-error.ogg 
[AudioEngine] canPlayAudioType check failed, returning false. ReferenceError: Audio is not defined
    at canPlayAudioType (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:66:15)
    at loadAudioBufferInternal (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:241:19)
    at async loadAudioBuffer (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:128:12)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:191:20)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:186:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Failed to decode audio buffer for "network-error.ogg". This browser may not support OGG Vorbis (e.g. Safari/iOS). Consider providing .m4a or .mp3 fallbacks. Error: Network Error
    at <anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:188:13)
    at Object.apply (node:internal/test_runner/mock/mock:757:20)
    at loadAudioBufferInternal (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:171:30)
    at loadAudioBuffer (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:124:19)
    at TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:191:26)
    at Test.runInAsyncScope (node:async_hooks:214:14)
    at Test.run (node:internal/test_runner/test:1106:25)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:186:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Audio asset "bad-audio.ogg" not found in bundle, falling back to public path: /assets/bad-audio.ogg 
[AudioEngine] canPlayAudioType check failed, returning false. ReferenceError: Audio is not defined
    at canPlayAudioType (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:66:15)
    at loadAudioBufferInternal (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:241:19)
    at async loadAudioBuffer (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:128:12)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:201:20)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:195:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Failed to decode audio buffer for "bad-audio.ogg". This browser may not support OGG Vorbis (e.g. Safari/iOS). Consider providing .m4a or .mp3 fallbacks. Error: Decode Error
    at Object.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:198:13)
    at Object.apply (node:internal/test_runner/mock/mock:757:20)
    at loadAudioBufferInternal (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:194:20)
    at async loadAudioBuffer (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:128:12)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:201:20)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:195:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Audio asset "timeout.ogg" not found in bundle, falling back to public path: /assets/timeout.ogg 
[AudioEngine] Audio fetch timed out for "timeout.ogg" (/assets/timeout.ogg) 
[AudioEngine] Audio asset "decode-timeout.ogg" not found in bundle, falling back to public path: /assets/decode-timeout.ogg 
(node:27372) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ Audio Assets Loading Logic
  Ô£ö Input Validation: returns null for invalid filenames (12.4357ms)
  Ô£ö Successful Load: fetches, decodes, and returns buffer (5.2162ms)
  Ô£ö Caching: subsequent calls return cached buffer without fetch (1.5054ms)
  Ô£ö Fetch Failure: returns null on 404 (3.3838ms)
  Ô£ö Network Error: returns null on fetch exception (14.4024ms)
  Ô£ö Decode Error: returns null if decoding fails (2.4299ms)
  Ô£ö Fetch Timeout: returns null if fetch takes too long (2.3819ms)
[AudioEngine] Audio decode timed out for "decode-timeout.ogg" (/assets/decode-timeout.ogg) 
  Ô£ö Decode Timeout: returns null if decoding takes too long (18.6051ms)
Ô£ö Audio Assets Loading Logic (66.9125ms)
(node:5228) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ loadAudioBuffer Deduplication Tests
  Ô£ö Deduplicates simultaneous requests for the same file (47.4574ms)
  Ô£ö Processes distinct files independently (44.3639ms)
  Ô£ö Clears pending request after success (111.3705ms)
  Ô£ö Clears pending request after failure (0.6884ms)
Ô£ö loadAudioBuffer Deduplication Tests (207.7725ms)
[AudioEngine] Bundled 1 OGG asset(s): path/to/nested.ogg 
(node:39972) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ hasAudioAsset
  Ô£ö returns true for existing asset with full path (1.139ms)
  Ô£ö returns true for existing asset with basename (0.3583ms)
  Ô£ö returns true for existing nested asset with full path (0.213ms)
  Ô£ö returns true for existing nested asset by basename (if in map) (0.2177ms)
  Ô£ö returns true when input has ./ prefix (0.192ms)
  Ô£ö returns true when input has / prefix (0.195ms)
  Ô£ö returns true for loose matching by basename even if path is wrong (0.1881ms)
  Ô£ö returns false for non-existent asset (0.1594ms)
  Ô£ö returns false for non-string input (0.2327ms)
  Ô£ö returns false for partial match that is not in map (0.2305ms)
Ô£ö hasAudioAsset (6.6585ms)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
[AudioEngine] Audio asset "small0.ogg" not found in bundle, falling back to public path: /assets/small0.ogg 
[AudioEngine] Decoded audio buffer: "small0.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 1 items, 0.00MB 
[AudioEngine] Audio asset "small1.ogg" not found in bundle, falling back to public path: /assets/small1.ogg 
[AudioEngine] Decoded audio buffer: "small1.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 2 items, 0.00MB 
[AudioEngine] Audio asset "small2.ogg" not found in bundle, falling back to public path: /assets/small2.ogg 
[AudioEngine] Decoded audio buffer: "small2.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 3 items, 0.01MB 
[AudioEngine] Audio asset "small3.ogg" not found in bundle, falling back to public path: /assets/small3.ogg 
[AudioEngine] Decoded audio buffer: "small3.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 4 items, 0.01MB 
[AudioEngine] Audio asset "small4.ogg" not found in bundle, falling back to public path: /assets/small4.ogg 
[AudioEngine] Decoded audio buffer: "small4.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 5 items, 0.01MB 
[AudioEngine] Audio asset "small5.ogg" not found in bundle, falling back to public path: /assets/small5.ogg 
[AudioEngine] Decoded audio buffer: "small5.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 6 items, 0.01MB 
[AudioEngine] Audio asset "small6.ogg" not found in bundle, falling back to public path: /assets/small6.ogg 
[AudioEngine] Decoded audio buffer: "small6.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 7 items, 0.01MB 
[AudioEngine] Audio asset "small7.ogg" not found in bundle, falling back to public path: /assets/small7.ogg 
[AudioEngine] Decoded audio buffer: "small7.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 8 items, 0.02MB 
[AudioEngine] Audio asset "small8.ogg" not found in bundle, falling back to public path: /assets/small8.ogg 
[AudioEngine] Decoded audio buffer: "small8.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 9 items, 0.02MB 
[AudioEngine] Audio asset "small9.ogg" not found in bundle, falling back to public path: /assets/small9.ogg 
[AudioEngine] Decoded audio buffer: "small9.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Audio asset "small10.ogg" not found in bundle, falling back to public path: /assets/small10.ogg 
[AudioEngine] Decoded audio buffer: "small10.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Audio asset "small11.ogg" not found in bundle, falling back to public path: /assets/small11.ogg 
[AudioEngine] Decoded audio buffer: "small11.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Audio asset "small12.ogg" not found in bundle, falling back to public path: /assets/small12.ogg 
[AudioEngine] Decoded audio buffer: "small12.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Audio asset "small13.ogg" not found in bundle, falling back to public path: /assets/small13.ogg 
[AudioEngine] Decoded audio buffer: "small13.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Audio asset "small14.ogg" not found in bundle, falling back to public path: /assets/small14.ogg 
[AudioEngine] Decoded audio buffer: "small14.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Audio asset "small0.ogg" not found in bundle, falling back to public path: /assets/small0.ogg 
[AudioEngine] Decoded audio buffer: "small0.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Audio asset "small1.ogg" not found in bundle, falling back to public path: /assets/small1.ogg 
[AudioEngine] Decoded audio buffer: "small1.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Audio asset "small2.ogg" not found in bundle, falling back to public path: /assets/small2.ogg 
[AudioEngine] Decoded audio buffer: "small2.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Audio asset "small3.ogg" not found in bundle, falling back to public path: /assets/small3.ogg 
[AudioEngine] Decoded audio buffer: "small3.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Audio asset "small4.ogg" not found in bundle, falling back to public path: /assets/small4.ogg 
[AudioEngine] Decoded audio buffer: "small4.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Audio asset "large1.ogg" not found in bundle, falling back to public path: /assets/large1.ogg 
[AudioEngine] Decoded audio buffer: "large1.ogg" (29.7s, 44100Hz, 20.00MB). Cache: 1 items, 20.00MB 
[AudioEngine] Audio asset "large2.ogg" not found in bundle, falling back to public path: /assets/large2.ogg 
[AudioEngine] Decoded audio buffer: "large2.ogg" (29.7s, 44100Hz, 20.00MB). Cache: 2 items, 40.00MB 
[AudioEngine] Audio asset "large3.ogg" not found in bundle, falling back to public path: /assets/large3.ogg 
[AudioEngine] Decoded audio buffer: "large3.ogg" (29.7s, 44100Hz, 20.00MB). Cache: 2 items, 40.00MB 
[AudioEngine] Audio asset "large1.ogg" not found in bundle, falling back to public path: /assets/large1.ogg 
[AudioEngine] Decoded audio buffer: "large1.ogg" (29.7s, 44100Hz, 20.00MB). Cache: 2 items, 40.00MB 
[AudioEngine] Audio asset "huge.ogg" not found in bundle, falling back to public path: /assets/huge.ogg 
[AudioEngine] Decoded audio buffer: "huge.ogg" (89.2s, 44100Hz, 60.00MB). Cache: 1 items, 60.00MB 
[AudioEngine] Audio asset "small.ogg" not found in bundle, falling back to public path: /assets/small.ogg 
[AudioEngine] Decoded audio buffer: "small.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 1 items, 0.00MB 
[AudioEngine] Audio asset "huge.ogg" not found in bundle, falling back to public path: /assets/huge.ogg 
[AudioEngine] Decoded audio buffer: "huge.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 2 items, 0.00MB 
[AudioEngine] Audio asset "file0.ogg" not found in bundle, falling back to public path: /assets/file0.ogg 
[AudioEngine] Decoded audio buffer: "file0.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 1 items, 0.00MB 
[AudioEngine] Audio asset "file1.ogg" not found in bundle, falling back to public path: /assets/file1.ogg 
[AudioEngine] Decoded audio buffer: "file1.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 2 items, 0.00MB 
[AudioEngine] Audio asset "file2.ogg" not found in bundle, falling back to public path: /assets/file2.ogg 
[AudioEngine] Decoded audio buffer: "file2.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 3 items, 0.01MB 
[AudioEngine] Audio asset "file3.ogg" not found in bundle, falling back to public path: /assets/file3.ogg 
[AudioEngine] Decoded audio buffer: "file3.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 4 items, 0.01MB 
[AudioEngine] Audio asset "file4.ogg" not found in bundle, falling back to public path: /assets/file4.ogg 
[AudioEngine] Decoded audio buffer: "file4.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 5 items, 0.01MB 
[AudioEngine] Audio asset "file5.ogg" not found in bundle, falling back to public path: /assets/file5.ogg 
[AudioEngine] Decoded audio buffer: "file5.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 6 items, 0.01MB 
[AudioEngine] Audio asset "file6.ogg" not found in bundle, falling back to public path: /assets/file6.ogg 
[AudioEngine] Decoded audio buffer: "file6.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 7 items, 0.01MB 
[AudioEngine] Audio asset "file7.ogg" not found in bundle, falling back to public path: /assets/file7.ogg 
[AudioEngine] Decoded audio buffer: "file7.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 8 items, 0.02MB 
[AudioEngine] Audio asset "file8.ogg" not found in bundle, falling back to public path: /assets/file8.ogg 
[AudioEngine] Decoded audio buffer: "file8.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 9 items, 0.02MB 
[AudioEngine] Audio asset "file9.ogg" not found in bundle, falling back to public path: /assets/file9.ogg 
[AudioEngine] Decoded audio buffer: "file9.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Audio asset "file10.ogg" not found in bundle, falling back to public path: /assets/file10.ogg 
[AudioEngine] Decoded audio buffer: "file10.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Audio asset "file1.ogg" not found in bundle, falling back to public path: /assets/file1.ogg 
[AudioEngine] Decoded audio buffer: "file1.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
(node:31956) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ audioBufferCache optimization
  Ô£ö respects MAX_AUDIO_BUFFER_CACHE_SIZE (10 items) (23.5964ms)
  Ô£ö respects MAX_AUDIO_BUFFER_BYTE_SIZE (50MB) (3.0894ms)
  Ô£ö always keeps at least one item even if it exceeds byte limit (1.3067ms)
  Ô£ö LRU behavior preserved with item limit (3.4343ms)
Ô£ö audioBufferCache optimization (37.5919ms)
(node:30760) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ clearTransportEvent
  Ô£ö returns early if id is null (1.8322ms)
  Ô£ö returns early if id is undefined (0.4774ms)
  Ô£ö calls transport clear if id is provided (1.2024ms)
  Ô£ö handles errors and logs warning (1.0537ms)
Ô£ö clearTransportEvent (7.3704ms)
ÔûÂ stopAndDisconnectSource
  Ô£ö returns early if source is null (2.2132ms)
  Ô£ö returns early if source is undefined (0.353ms)
  Ô£ö calls stop and disconnect on source (0.3632ms)
  Ô£ö handles stop error and logs debug (0.4625ms)
  Ô£ö handles disconnect error and logs debug (0.7058ms)
  Ô£ö handles both stop and disconnect errors (0.4317ms)
  Ô£ö handles invalid source object (no methods) (0.44ms)
Ô£ö stopAndDisconnectSource (7.0587ms)
ÔûÂ stopTransportAndClear
  Ô£ö stops transport and resets position (0.8353ms)
  Ô£ö cleans up loop and part (0.5086ms)
  Ô£ö cleans up midiParts (0.3899ms)
  Ô£ö handles already null loop and part (0.3466ms)
Ô£ö stopTransportAndClear (2.9586ms)
ÔûÂ cleanupGigPlayback
  Ô£ö cleans up gigSource if present (0.3712ms)
  Ô£ö calls resetGigState even if gigSource is null (0.2427ms)
Ô£ö cleanupGigPlayback (1.0627ms)
ÔûÂ cleanupAmbientPlayback
  Ô£ö cleans up ambientSource if present (0.3317ms)
  Ô£ö does nothing if ambientSource is null (0.168ms)
Ô£ö cleanupAmbientPlayback (0.9155ms)
ÔûÂ cleanupTransportEvents
  Ô£ö clears transport events and resets IDs (6.3756ms)
  Ô£ö handles null IDs gracefully (1.0113ms)
Ô£ö cleanupTransportEvents (8.2048ms)
Ô£ö getPreferredAudioContextState prefers raw context state (1.1283ms)
Ô£ö getPreferredAudioContextState falls back to tone context state (0.1814ms)
Ô£ö getPreferredAudioContextState returns unknown when no state exists (0.1102ms)
Ô£ö canResumeAudioContextState only allows resumable states (0.1238ms)
Ô£ö isClosedAudioContextState only matches closed state (0.1577ms)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
[AudioEngine] Node disposal failed (likely benign) Error: Dispose failed
    at MockPolySynth.MockPolySynth.dispose (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:12:11)
    at safeDispose (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:25:12)
    at disposeAudio (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:115:23)
    at TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:41:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Node disposal failed (likely benign) Error: Dispose failed
    at MockPolySynth.MockPolySynth.dispose (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:12:11)
    at safeDispose (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:25:12)
    at disposeAudio (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:116:21)
    at TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:41:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Node disposal failed (likely benign) Error: Dispose failed
    at MockPolySynth.MockPolySynth.dispose (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:12:11)
    at safeDispose (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:25:12)
    at disposeAudio (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:126:25)
    at TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:41:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Node disposal failed (likely benign) Error: Dispose failed
    at MockPolySynth.MockPolySynth.dispose (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:12:11)
    at safeDispose (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:25:12)
    at disposeAudio (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:129:25)
    at TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:41:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Node disposal failed (likely benign) Error: Dispose failed
    at MockPolySynth.MockPolySynth.dispose (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:12:11)
    at safeDispose (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:25:12)
    at disposeAudio (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:130:25)
    at TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:41:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
(node:33348) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
Ô£ö disposeAudio logs error when dispose fails (43.9334ms)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
ÔûÂ calculateGigTimeMs
  Ô£ö calculates gig time with valid context times (6.1096ms)
  Ô£ö returns offset when start time is invalid (0.2541ms)
  Ô£ö defaults to zero for invalid offset (0.1707ms)
Ô£ö calculateGigTimeMs (8.329ms)
ÔûÂ hasAudioAsset
  Ô£ö returns false for non-string input (0.2577ms)
  Ô£ö returns false for unknown filename (0.2636ms)
Ô£ö hasAudioAsset (1.0513ms)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
ÔûÂ calculateGigPlaybackWindow
  Ô£ö Happy Path: valid inputs within buffer range (4.1202ms)
  Ô£ö Clamps duration to remaining buffer (0.5786ms)
  Ô£ö Resets offsets when they exceed buffer duration (0.6026ms)
  Ô£ö Resets offsets when exactly at buffer duration (0.5192ms)
  Ô£ö Handles null duration (play to end) (0.268ms)
  Ô£ö Handles zero duration request (0.4633ms)
  Ô£ö Handles zero buffer duration (0.5546ms)
  Ô£ö Handles negative inputs (clamps to 0) (0.4118ms)
  Ô£ö Handles NaN inputs (treats as 0) (6.2277ms)
  Ô£ö Handles Infinity inputs (treats as 0) (0.6219ms)
  Ô£ö Handles null/undefined inputs explicitly (0.2609ms)
  Ô£ö Complex scenario: Seek + Base offset near end (0.2606ms)
Ô£ö calculateGigPlaybackWindow (36.6737ms)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
(node:31360) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ setupAudio
  Ô£ö completes successfully (4.6268ms)
  Ô£ö handles concurrent calls (1.8321ms)
  Ô£ö propagates errors to concurrent calls (3.3622ms)
Ô£ö setupAudio (12.9165ms)
[AudioSystem] stopMusic called (was playing: nothing). 
[AudioSystem] Ambient started via OGG buffer playback. 
ÔûÂ AudioManager Tests
  Ô£ö initializes with default values (1.2477ms)
  Ô£ö setMusicVolume updates volume and calls engine (0.4388ms)
  Ô£ö toggleMute updates mute state (0.2991ms)
  Ô£ö resumeMusic resumes paused transport via engine facade (0.4072ms)
  Ô£ö startAmbient calls playRandomAmbientOgg (3.6417ms)
Ô£ö AudioManager Tests (158.2106ms)
(node:40024) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
[audioEngine] Asset basename conflict for "song.ogg". Keeping "/assets/audio/song.ogg" and ignoring "/assets/sfx/song.ogg".
ÔûÂ normalizeMidiPlaybackOptions
  Ô£ö uses defaults when options are undefined (2.2103ms)
  Ô£ö respects explicit clean playback flag (0.3673ms)
  Ô£ö accepts a valid onEnded callback (0.3134ms)
  Ô£ö normalizes stopAfterSeconds (0.2912ms)
  Ô£ö accepts a startTimeSec override (0.2922ms)
Ô£ö normalizeMidiPlaybackOptions (5.7447ms)
ÔûÂ encodePublicAssetPath
  Ô£ö encodes spaces and preserves slashes (0.4803ms)
  Ô£ö handles leading slashes (0.3531ms)
  Ô£ö returns empty string for invalid input (0.2241ms)
  Ô£ö encodes special characters safely (0.2538ms)
Ô£ö encodePublicAssetPath (2.1034ms)
ÔûÂ resolveAssetUrl
  ÔûÂ MIDI assets
    Ô£ö prefers bundled URLs (0.3822ms)
    Ô£ö resolves bundled URLs via basename (0.2214ms)
    Ô£ö falls back to public path when missing (0.2344ms)
    Ô£ö normalizes relative filenames and encodes spaces (0.3969ms)
    Ô£ö supports custom public base path (0.2071ms)
    Ô£ö supports relative base path defaults (0.2054ms)
    Ô£ö returns nulls for empty filename (0.1278ms)
  Ô£ö MIDI assets (3.814ms)
  ÔûÂ non-MIDI assets
    Ô£ö resolves bundled URLs for non-MIDI assets (0.1671ms)
    Ô£ö resolves via basename for nested paths (0.1372ms)
    Ô£ö falls back to public path for missing assets (0.1375ms)
  Ô£ö non-MIDI assets (0.846ms)
Ô£ö resolveAssetUrl (5.0386ms)
ÔûÂ buildAssetUrlMap
  Ô£ö stores relative paths and basenames (0.3723ms)
  Ô£ö warns on basename conflicts and keeps first entry (0.4965ms)
Ô£ö buildAssetUrlMap (1.2143ms)
ÔûÂ buildAssetUrlMap OGG key filtering
  Ô£ö full paths and basenames are both stored for OGG assets (0.1598ms)
  Ô£ö full paths with subdirectories are distinguishable from basenames (0.9124ms)
  Ô£ö path-containing keys can be filtered from basename-only keys (0.504ms)
  Ô£ö root-level assets have no slash in key (0.23ms)
Ô£ö buildAssetUrlMap OGG key filtering (2.4378ms)
ÔûÂ buildAssetUrlMap supports MIDI labeling
  Ô£ö stores relative paths and basenames (0.5239ms)
  Ô£ö warns on basename conflicts and keeps first entry (0.732ms)
Ô£ö buildAssetUrlMap supports MIDI labeling (9.7657ms)
file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/midiPlayback.js:7
import { stopAudio, stopAudioInternal, prepareTransportPlayback } from './playback.js'
                                       ^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: The requested module './playback.js' does not provide an export named 'prepareTransportPlayback'
    at #asyncInstantiate (node:internal/modules/esm/module_job:302:21)
    at async ModuleJob.run (node:internal/modules/esm/module_job:405:5)
    at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:660:26)
    at async <anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioProcedural.test.js:162:26)

Node.js v24.13.0
Ô£û tests\audioProcedural.test.js (730.9626ms)
file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/proceduralMetal.js:3
import { prepareTransportPlayback } from './playback.js'
         ^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: The requested module './playback.js' does not provide an export named 'prepareTransportPlayback'
    at #asyncInstantiate (node:internal/modules/esm/module_job:302:21)
    at async ModuleJob.run (node:internal/modules/esm/module_job:405:5)
    at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:660:26)
    at async <anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioProceduralMetal.test.js:171:3)

Node.js v24.13.0
Ô£û tests\audioProceduralMetal.test.js (797.3168ms)
file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/midiPlayback.js:7
import { stopAudio, stopAudioInternal, prepareTransportPlayback } from './playback.js'
                                       ^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: The requested module './playback.js' does not provide an export named 'prepareTransportPlayback'
    at #asyncInstantiate (node:internal/modules/esm/module_job:302:21)
    at async ModuleJob.run (node:internal/modules/esm/module_job:405:5)
    at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:660:26)
    at async <anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioProceduralPlayNote.test.js:123:28)

Node.js v24.13.0
Ô£û tests\audioProceduralPlayNote.test.js (864.0624ms)
file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/midiPlayback.js:7
import { stopAudio, stopAudioInternal, prepareTransportPlayback } from './playback.js'
                                       ^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: The requested module './playback.js' does not provide an export named 'prepareTransportPlayback'
    at #asyncInstantiate (node:internal/modules/esm/module_job:302:21)
    at async ModuleJob.run (node:internal/modules/esm/module_job:405:5)
    at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:660:26)
    at async <anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioProceduralPlaySong.test.js:133:30)

Node.js v24.13.0
Ô£û tests\audioProceduralPlaySong.test.js (797.0323ms)
ÔûÂ selectRandomItem
  Ô£ö returns null for invalid or empty inputs (1.0646ms)
  Ô£ö returns a stable item with deterministic rng (0.3341ms)
  Ô£ö clamps rng values to valid indices (0.5711ms)
Ô£ö selectRandomItem (4.2482ms)
ÔûÂ getScheduledHitTimeMs
  Ô£ö schedules within lead window (0.9639ms)
  Ô£ö fires immediately when outside lead window (0.3856ms)
  Ô£ö handles clock offsets between gig and audio time (0.2985ms)
Ô£ö getScheduledHitTimeMs (3.772ms)
Ô£ö getRandomChatter supports default chatter in all top-level scenes (6.8713ms)
Ô£ö disallowed scenes are not in ALLOWED_DEFAULT_SCENES (0.5538ms)
Ô£ö harmony chatter fires when band.harmony is low (0.5091ms)
Ô£ö harmony chatter fires when band.harmony is high (0.4276ms)
Ô£ö van chatter fires when fuel is low (1.8609ms)
Ô£ö van chatter fires when condition is critical (0.3357ms)
Ô£ö tour progression chatter fires for late tour (0.4608ms)
Ô£ö tour progression chatter fires for early tour (0.5104ms)
Ô£ö fame chatter fires when fameLevel >= 2 (0.3522ms)
Ô£ö fame chatter fires when fame is low (0.3684ms)
Ô£ö inventory chatter fires when strings are missing (0.276ms)
Ô£ö inventory chatter fires for golden pick (0.2419ms)
Ô£ö gig modifier chatter fires when catering is booked (0.2924ms)
Ô£ö gig modifier chatter fires when nothing is booked (0.2707ms)
Ô£ö luck chatter fires when luck is high (0.2013ms)
Ô£ö luck chatter fires when luck is negative (0.2152ms)
(node:37156) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
Ô£ö getRandomChatter returns null when pool is empty (1.7234ms)
Ô£ö getRandomChatter returns venue-specific chatter (1.036ms)
Ô£ö getRandomChatter falls back to ANY venue chatter (0.5343ms)
Ô£ö getRandomChatter supports legacy lines format (0.4558ms)
Ô£ö getRandomChatter includes standard chatter when conditions met (0.3907ms)
Ô£ö getRandomChatter implements weighted random selection (0.4082ms)
ÔûÂ secureRandom
  Ô£ö should use crypto.getRandomValues when available (1.8484ms)
  Ô£ö should return 0 when random value is 0 (1.1556ms)
  Ô£ö should return correct value for max uint32 (0.9991ms)
  Ô£ö should fallback to Math.random when crypto is undefined (0.8091ms)
  Ô£ö should fallback to Math.random when getRandomValues is missing (0.547ms)
Ô£ö secureRandom (7.9418ms)
Ô£ö CHARACTERS data integrity (1.5125ms)
Ô£ö SONGS_DB data integrity (0.4656ms)
Ô£ö SONGS_DB sourceOgg field (0.6075ms)
Ô£ö ALL_VENUES data integrity (0.3149ms)
Ô£ö EVENTS_DB integrity (1.612ms)
[EventValidation] Event missing ID in transport { category: 'transport', description: 'Missing ID' }
[EventValidation] Duplicate Event ID in transport: valid_event 
(node:29356) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
Ô£ö Event validation filters out invalid events (1.1991ms)
Ô£ö tests\drumMappings.test.js (3762.2195ms)
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2359, income: 2937, expenses: 578 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 10 }
[Economy] Gig Report Generated { net: 1097, income: 1247, expenses: 150 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 1000 }
[Economy] Gig Report Generated { net: 2040, income: 2550, expenses: 510 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 50 }
[Economy] Gig Report Generated { net: 1788, income: 2167, expenses: 379 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 50 }
[Economy] Gig Report Generated { net: 2275, income: 2864, expenses: 589 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 50 }
[Economy] Gig Report Generated { net: 1359, income: 1569, expenses: 210 }
[Economy] Calculating Gig Financials { gig: undefined, score: 40, fame: 100 }
[Economy] Gig Report Generated { net: 2359, income: 2987, expenses: 628 }
[Economy] Calculating Gig Financials { gig: undefined, score: 95, fame: 100 }
[Economy] Gig Report Generated { net: 2764, income: 3662, expenses: 898 }
[Economy] Calculating Gig Financials { gig: undefined, score: 95, fame: 100 }
[Economy] Gig Report Generated { net: 2764, income: 3662, expenses: 898 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2479, income: 3187, expenses: 708 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 1979, income: 2487, expenses: 508 }
[Economy] Calculating Gig Financials { gig: undefined, score: 90, fame: 200 }
[Economy] Gig Report Generated { net: 2748, income: 3267, expenses: 519 }
[Economy] Calculating Gig Financials { gig: undefined, score: 100, fame: 200 }
[Economy] Gig Report Generated { net: 2956, income: 3938, expenses: 982 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2359, income: 2937, expenses: 578 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2359, income: 2937, expenses: 578 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2339, income: 2937, expenses: 598 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2479, income: 3187, expenses: 708 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 700, income: 700, expenses: 0 }
[Economy] Calculating Gig Financials { gig: undefined, score: 0, fame: 100 }
[Economy] Gig Report Generated { net: 2029, income: 2387, expenses: 358 }
[Economy] Calculating Gig Financials { gig: undefined, score: 100, fame: 100 }
[Economy] Gig Report Generated { net: 2674, income: 3462, expenses: 788 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2359, income: 2937, expenses: 578 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2479, income: 3187, expenses: 708 }
[Economy] Calculating Gig Financials { gig: undefined, score: 75, fame: 150 }
[Economy] Gig Report Generated { net: 2425, income: 3025, expenses: 600 }
[Economy] Calculating Gig Financials { gig: undefined, score: 85, fame: 5000 }
[Economy] Gig Report Generated { net: 19475, income: 25075, expenses: 5600 }
[Economy] Calculating Gig Financials { gig: undefined, score: 100, fame: 100 }
[Economy] Gig Report Generated { net: 2244, income: 2898, expenses: 654 }
[Economy] Calculating Gig Financials { gig: undefined, score: 100, fame: 100 }
[Economy] Gig Report Generated { net: 2601, income: 3515, expenses: 914 }
Ô£ö calculateGigFinancials handles base case with ticket sales and guarantee (6.7353ms)
Ô£ö calculateGigFinancials applies fame scaling to fill rate (1.4656ms)
Ô£ö calculateGigFinancials applies promo boost to fill rate (1.3199ms)
Ô£ö calculateGigFinancials applies price sensitivity penalty (0.6167ms)
Ô£ö calculateGigFinancials scales merch sales with performance (0.8274ms)
Ô£ö calculateGigFinancials applies S-rank merch bonus (1.6368ms)
Ô£ö calculateGigFinancials penalizes merch sales for misses (10.1695ms)
Ô£ö calculateGigFinancials handles sold out merch gracefully (7.0611ms)
Ô£ö calculateGigFinancials uses all inventory types for sales limit (3.4145ms)
Ô£ö calculateGigFinancials no longer includes transport/food in gig report (handled via Travel phase) (4.2456ms)
Ô£ö calculateGigFinancials includes catering when enabled (4.6842ms)
Ô£ö calculateGigFinancials supports new merch key (6.0806ms)
Ô£ö calculateGigFinancials handles zero capacity venue (0.8943ms)
Ô£ö calculateGigFinancials handles extreme performance scores (0.4909ms)
Ô£ö calculateGigFinancials merch table modifier increases sales (0.5883ms)
Ô£ö EXPENSE_CONSTANTS are properly defined (0.6931ms)
Ô£ö calculateGigFinancials net profit matches income minus expenses (0.4317ms)
Ô£ö calculateGigFinancials handles high fame with high price (0.3958ms)
Ô£ö calculateTravelExpenses returns correct cost structure (0.4151ms)
Ô£ö calculateTravelExpenses computes distance consistently across node coordinates (0.1897ms)
Ô£ö calculateFuelCost applies van tuning upgrade (0.5293ms)
Ô£ö calculateRefuelCost calculates correctly (0.1668ms)
Ô£ö calculateRepairCost calculates correctly (0.1375ms)
Ô£ö calculateFuelCost applies road_warrior trait discount (0.3461ms)
ÔûÂ calculateEffectiveTicketPrice handles discounts correctly
  Ô£ö returns 0 if no gig data (0.4351ms)
  Ô£ö returns original price if not discounted (0.481ms)
  Ô£ö returns original price if price <= 10 (0.1354ms)
  Ô£ö applies 50% discount if price > 10 and discountedTickets is true (0.2798ms)
Ô£ö calculateEffectiveTicketPrice handles discounts correctly (2.4134ms)
Ô£ö calculateGigFinancials uses effective price (10.1884ms)
ÔûÂ Minigame Economy Calculations
  Ô£ö Travel Minigame Results (1.0486ms)
  Ô£ö Travel Minigame Edge Cases (0.4118ms)
  Ô£ö Roadie Minigame Results (0.3502ms)
  Ô£ö Roadie Minigame Edge Cases (0.1981ms)
Ô£ö Minigame Economy Calculations (4.7822ms)
[ErrorHandler] Test error {
  name: 'StateError',
  message: 'Test error',
  category: 'state',
  severity: 'high',
  context: {},
  recoverable: true,
  timestamp: 1772193569900,
  stack: 'StateError: Test error\n' +
    '    at TestContext.<anonymous> (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/tests/errorHandler.test.js:76:19)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at Test.start (node:internal/test_runner/test:1003:17)\n' +
    '    at node:internal/test_runner/test:1516:71\n' +
    '    at node:internal/per_context/primordials:466:82\n' +
    '    at new Promise (<anonymous>)\n' +
    '    at new SafePromise (node:internal/per_context/primordials:435:3)\n' +
    '    at node:internal/per_context/primordials:466:9\n' +
    '    at Array.map (<anonymous>)'
}
[ErrorHandler] Test error {
  name: 'StateError',
  message: 'Test error',
  category: 'state',
  severity: 'high',
  context: {},
  recoverable: true,
  timestamp: 1772193569905,
  stack: 'StateError: Test error\n' +
    '    at TestContext.<anonymous> (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/tests/errorHandler.test.js:90:19)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at Suite.processPendingSubtests (node:internal/test_runner/test:788:18)\n' +
    '    at Test.postRun (node:internal/test_runner/test:1235:19)\n' +
    '    at Test.run (node:internal/test_runner/test:1163:12)\n' +
    '    at async Promise.all (index 0)\n' +
    '    at async Suite.run (node:internal/test_runner/test:1518:7)\n' +
    '    at async Test.processPendingSubtests (node:internal/test_runner/test:788:7)'
}
[ErrorHandler] Fallback {
  name: 'Error',
  message: 'Fallback',
  category: 'unknown',
  severity: 'medium',
  context: {},
  recoverable: true,
  timestamp: 1772193569907,
  stack: 'Error\n' +
    '    at TestContext.<anonymous> (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/tests/errorHandler.test.js:97:19)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at Suite.processPendingSubtests (node:internal/test_runner/test:788:18)\n' +
    '    at Test.postRun (node:internal/test_runner/test:1235:19)\n' +
    '    at Test.run (node:internal/test_runner/test:1163:12)\n' +
    '    at async Suite.processPendingSubtests (node:internal/test_runner/test:788:7)'
}
[ErrorHandler] Audio asset not found for "01 Kranker Schrank": looked up "01 Kranker Schrank.ogg" {
  name: 'AudioError',
  message: 'Audio asset not found for "01 Kranker Schrank": looked up "01 Kranker Schrank.ogg"',
  category: 'audio',
  severity: 'medium',
  context: {
    songName: '01 Kranker Schrank',
    oggFilename: '01 Kranker Schrank.ogg'
  },
  recoverable: true,
  timestamp: 1772193569916,
  stack: 'AudioError: Audio asset not found for "01 Kranker Schrank": looked up "01 Kranker Schrank.ogg"\n' +
    '    at TestContext.<anonymous> (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/tests/errorHandler.test.js:112:19)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at Suite.processPendingSubtests (node:internal/test_runner/test:788:18)\n' +
    '    at Test.postRun (node:internal/test_runner/test:1235:19)\n' +
    '    at Test.run (node:internal/test_runner/test:1163:12)\n' +
    '    at async Suite.processPendingSubtests (node:internal/test_runner/test:788:7)'
}
[ErrorHandler] Storage operation failed: test {
  name: 'StorageError',
  message: 'Storage operation failed: test',
  category: 'storage',
  severity: 'medium',
  context: { originalError: 'Storage error' },
  recoverable: true,
  timestamp: 1772193569919,
  stack: 'StorageError: Storage operation failed: test\n' +
    '    at safeStorageOperation (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/errorHandler.js:197:7)\n' +
    '    at TestContext.<anonymous> (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/tests/errorHandler.test.js:135:20)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at Suite.processPendingSubtests (node:internal/test_runner/test:788:18)\n' +
    '    at Test.postRun (node:internal/test_runner/test:1235:19)\n' +
    '    at Test.run (node:internal/test_runner/test:1163:12)\n' +
    '    at async Promise.all (index 0)\n' +
    '    at async Suite.run (node:internal/test_runner/test:1518:7)\n' +
    '    at async Test.processPendingSubtests (node:internal/test_runner/test:788:7)'
}
ÔûÂ Custom Error Classes
  ÔûÂ StateError
    Ô£ö should have correct name (1.1966ms)
  Ô£ö StateError (2.3176ms)
  ÔûÂ StorageError
    Ô£ö should have correct name (0.4422ms)
  Ô£ö StorageError (0.7187ms)
  ÔûÂ AudioError
    Ô£ö should have correct name and category (0.4971ms)
    Ô£ö should store context for missing OGG asset diagnostics (0.2265ms)
    Ô£ö should produce a complete log object via toLogObject (1.1033ms)
  Ô£ö AudioError (2.2166ms)
Ô£ö Custom Error Classes (6.204ms)
ÔûÂ handleError
  Ô£ö should call addToast when not silent (4.9928ms)
  Ô£ö should not call addToast when silent (2.383ms)
  Ô£ö should use fallback message for errors without message (8.3375ms)
  Ô£ö should handle AudioError with silent mode and preserve context (1.8443ms)
Ô£ö handleError (18.3912ms)
ÔûÂ safeStorageOperation
  Ô£ö should return result on success (0.7928ms)
  Ô£ö should return fallback on error (1.0457ms)
Ô£ö safeStorageOperation (2.1222ms)
(node:27352) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
Ô£ö eventEngine.filterEvents filters by trigger (2.1116ms)
Ô£ö eventEngine.filterEvents respects conditions (0.3996ms)
Ô£ö eventEngine.selectEvent respects cooldowns (1.0336ms)
Ô£ö eventEngine.selectEvent prioritizes pending events (0.2527ms)
Ô£ö eventEngine.resolveChoice handles simple effects (0.5117ms)
Ô£ö eventEngine.resolveChoice handles skill checks (success) (0.4368ms)
Ô£ö eventEngine.resolveChoice handles skill checks (failure) (0.3426ms)
Ô£ö eventEngine.resolveChoice handles luck checks (0.2732ms)
Ô£ö eventEngine.resolveChoice sets nextEventId (0.319ms)
Ô£ö eventEngine.processOptions returns event when no processing needed (0.4155ms)
Ô£ö eventEngine.processOptions handles van_breakdown with spare_tire (1.5974ms)
Ô£ö eventEngine.processOptions does not add spare tire option without inventory (0.3436ms)
Ô£ö eventEngine.applyResult handles resource effects (0.5587ms)
Ô£ö eventEngine.applyResult handles stat effects (0.1976ms)
Ô£ö eventEngine.applyResult handles harmony stat (0.2339ms)
Ô£ö eventEngine.applyResult handles mood changes (0.2732ms)
Ô£ö eventEngine.applyResult handles stamina changes (0.147ms)
Ô£ö eventEngine.applyResult handles combined mood and stamina in composite (0.1691ms)
Ô£ö eventEngine.applyResult handles van fuel (0.1406ms)
Ô£ö eventEngine.applyResult handles van condition stat (0.1505ms)
Ô£ö eventEngine.applyResult clamps van condition to 0-100 range (0.1614ms)
Ô£ö eventEngine.applyResult handles game over flag (0.1363ms)
Ô£ö eventEngine.applyResult handles story flags (0.1395ms)
Ô£ö eventEngine.applyResult handles chain events (0.1374ms)
Ô£ö eventEngine.applyResult handles composite effects (0.1677ms)
Ô£ö eventEngine.applyResult returns null for null result (0.093ms)
Ô£ö eventEngine.applyResult handles unlock effects (0.1142ms)
Ô£ö eventEngine.applyResult preserves nextEventId from result (0.1246ms)
Ô£ö eventEngine.applyResult handles time stat (0.1195ms)
Ô£ö eventEngine.applyResult handles viral stat (0.1192ms)
Ô£ö eventEngine.applyResult handles inventory numeric increment (0.1245ms)
Ô£ö eventEngine.applyResult handles inventory non-numeric value (0.1896ms)
Ô£ö eventEngine.applyResult accumulates inventory values across composite effects (0.1902ms)
Ô£ö eventEngine logic allows negative inventory in delta (0.137ms)
Ô£ö eventEngine.applyResult handles hype stat as fame (0.1203ms)
Ô£ö eventEngine.applyResult handles crowd_energy stat as fame (0.1566ms)
Ô£ö eventEngine.applyResult handles score stat increment (0.1597ms)
Ô£ö eventEngine.applyResult accumulates fame from mixed stats (fame, hype, crowd_energy) (0.143ms)
Ô£ö eventEngine.selectEvent handles condition errors gracefully (0.4793ms)
Ô£ö resolveEventChoice returns delta for direct effects (2.0638ms)
Ô£ö resolveEventChoice handles missing choices safely (0.3426ms)
Ô£ö resolveEventChoice appends SAVED_BY_BANDLEADER string on successful bandleader save (2.2501ms)
[Economy] Calculating Gig Financials { gig: undefined, score: 30, fame: 100 }
[Economy] Gig Report Generated { net: 1829, income: 2237, expenses: 408 }
[Economy] Calculating Gig Financials { gig: undefined, score: 95, fame: 100 }
[Economy] Gig Report Generated { net: 2914, income: 3812, expenses: 898 }
[Economy] Calculating Gig Financials { gig: undefined, score: 70, fame: 100 }
[Economy] Gig Report Generated { net: 2329, income: 2887, expenses: 558 }
[Economy] Calculating Gig Financials { gig: undefined, score: 70, fame: 100 }
[Economy] Gig Report Generated { net: 2449, income: 3137, expenses: 688 }
[GameState] Update Player { money: -100 }
[GameState] Update Band { harmony: -50 }
[GameState] Update Band { harmony: 200 }
[GameState] Day Advanced to 2 
Ô£ö calculateDailyUpdates: daily cost includes band size scaling (2.4175ms)
Ô£ö calculateDailyUpdates: money never goes negative (0.4884ms)
Ô£ö calculateDailyUpdates: van condition decays daily (0.3243ms)
Ô£ö calculateDailyUpdates: van breakdown chance increases when condition is low (0.25ms)
Ô£ö calculateDailyUpdates: van condition does not go below 0 (0.3298ms)
Ô£ö calculateDailyUpdates: harmony is clamped to [1, 100] (0.339ms)
Ô£ö calculateDailyUpdates: harmony clamped even with regen active (0.2517ms)
Ô£ö calculateGigFinancials: low performance penalizes merch (5.4697ms)
Ô£ö calculateGigFinancials: merch table modifier increases merch revenue (1.0904ms)
Ô£ö gameReducer: UPDATE_PLAYER clamps money to 0 (1.0843ms)
Ô£ö gameReducer: UPDATE_BAND clamps harmony to [1, 100] (0.8526ms)
Ô£ö gameReducer: ADVANCE_DAY clamps harmony (1.0154ms)
Ô£ö applyEventDelta: fuel clamped to [0, 100] (0.6948ms)
Ô£ö applyEventDelta: harmony clamped to [1, 100] (0.1987ms)
Ô£ö applyEventDelta: money clamped to 0 (0.1942ms)
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Update Player { money: 1000 }
[GameState] Update Player { fame: 50 }
[GameState] Update Player { money: 1000 }
[GameState] Update Band { harmony: 50 }
[GameState] Update Band { harmony: -20 }
[GameState] Update Band { harmony: 0 }
[GameState] Update Band { members: [ { name: 'Test', mood: 100, stamina: 100 } ] }
[GameState] Day Advanced to 2 
[GameState] State Reset (Debug) 
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Regional reputation gain in Stendal (+10) 
(node:38728) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ gameReducer
  ÔûÂ CHANGE_SCENE
    Ô£ö should change the current scene (4.8921ms)
    Ô£ö should preserve other state properties (0.8183ms)
  Ô£ö CHANGE_SCENE (6.8728ms)
  ÔûÂ UPDATE_PLAYER
    Ô£ö should update player money (1.1768ms)
    Ô£ö should update player fame (1.7818ms)
    Ô£ö should merge player updates with existing state (0.9388ms)
  Ô£ö UPDATE_PLAYER (4.2616ms)
  ÔûÂ UPDATE_BAND
    Ô£ö should update band harmony (0.9481ms)
    Ô£ö should clamp band harmony above zero (0.6493ms)
    Ô£ö should clamp band harmony of zero to one (13.0373ms)
    Ô£ö should update band members (1.6152ms)
  Ô£ö UPDATE_BAND (17.3737ms)
  ÔûÂ ADVANCE_DAY
    Ô£ö should clamp harmony after daily updates (3.7903ms)
  Ô£ö ADVANCE_DAY (4.0307ms)
  ÔûÂ UPDATE_SOCIAL
    Ô£ö should update social media followers (0.5551ms)
    Ô£ö should preserve other social stats (0.285ms)
  Ô£ö UPDATE_SOCIAL (1.0722ms)
  ÔûÂ SET_GIG_MODIFIERS
    Ô£ö should update gig modifiers with object payload (0.3329ms)
    Ô£ö should update gig modifiers with function payload (0.3155ms)
  Ô£ö SET_GIG_MODIFIERS (0.8072ms)
  ÔûÂ ADD_TOAST
    Ô£ö should add toast to array (0.295ms)
  Ô£ö ADD_TOAST (0.3939ms)
  ÔûÂ REMOVE_TOAST
    Ô£ö should remove toast by id (0.3252ms)
  Ô£ö REMOVE_TOAST (0.3982ms)
  ÔûÂ CONSUME_ITEM
    Ô£ö should decrement numeric inventory item (0.3322ms)
    Ô£ö should set boolean inventory item to false (0.2577ms)
    Ô£ö should not go below zero (0.2334ms)
  Ô£ö CONSUME_ITEM (1.0168ms)
  ÔûÂ RESET_STATE
    Ô£ö should reset to initial state (0.557ms)
  Ô£ö RESET_STATE (0.6868ms)
  ÔûÂ LOAD_GAME
    Ô£ö should load saved state (0.7181ms)
    Ô£ö should migrate energy to catering in gigModifiers (0.3807ms)
    Ô£ö should merge with default values for missing properties (0.4155ms)
  Ô£ö LOAD_GAME (1.6655ms)
  ÔûÂ unknown action
    Ô£ö should return current state for unknown action (0.7401ms)
  Ô£ö unknown action (0.8174ms)
  ÔûÂ UNLOCK_TRAIT
    Ô£ö UNLOCK_TRAIT unlocks a trait for a band member (Name fallback) (1.1532ms)
    Ô£ö UNLOCK_TRAIT adds toast (0.4332ms)
  Ô£ö UNLOCK_TRAIT (1.7151ms)
  ÔûÂ SET_LAST_GIG_STATS
    Ô£ö should not check trait unlocks in practice mode (0.5325ms)
    Ô£ö should check trait unlocks in normal mode (0.6398ms)
  Ô£ö SET_LAST_GIG_STATS (1.3118ms)
Ô£ö gameReducer (45.8151ms)
ÔûÂ ActionTypes
  Ô£ö should have all expected action types (0.1926ms)
Ô£ö ActionTypes (0.2777ms)
Ô£ö applyEventDelta clamps player and band values (1.8795ms)
Ô£ö applyEventDelta updates social channels safely (0.4723ms)
Ô£ö applyEventDelta applies basic relationship changes (1.566ms)
Ô£ö applyEventDelta amplifies negative change for grudge_holder (0.3405ms)
Ô£ö applyEventDelta does not amplify positive change for grudge_holder (0.2537ms)
Ô£ö applyEventDelta amplifies positive change for peacemaker (0.1975ms)
Ô£ö applyEventDelta dampens negative change for peacemaker (0.2296ms)
Ô£ö applyEventDelta clamps relationship scores to 0-100 (0.2103ms)
Ô£ö applyEventDelta handles multiple relationship changes (0.244ms)
Ô£ö applyEventDelta handles both traits simultaneously (edge case) and symmetric updates (0.245ms)
Ô£ö applyEventDelta applies player updates (2.1065ms)
Ô£ö applyEventDelta clamps values (0.7048ms)
Ô£ö applyEventDelta handles band inventory updates (0.4098ms)
Ô£ö applyEventDelta applies per-member deltas (0.3112ms)
Ô£ö applyEventDelta handles social updates (0.2904ms)
Ô£ö applyEventDelta handles flags (0.3193ms)
Ô£ö applyEventDelta ignores unsupported score mutations in flags (0.6394ms)
Ô£ö state safety helpers clamp canonical values (0.2134ms)
Ô£ö applyInventoryItemDelta handles numeric and boolean deltas (0.2205ms)
Ô£ö updateGigPerformanceStats tracks peak combo and hype (1.3311ms)
Ô£ö buildGigStatsSnapshot includes required economy fields (1.3617ms)
[GameState] Scene Change: INTRO -> MENU 
[GameState] State Reset (Debug) 
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Map Generated 
[GameState] Update Player {
  money: 470,
  currentNodeId: 'node_1_0',
  location: 'Test City',
  van: { fuel: 85, condition: 100, upgrades: [], breakdownChance: 0.05 }
}
[GameState] Day Advanced to 2 
[GameState] Starting Gig Sequence Test Punk Keller
[GameState] Scene Change: PREGIG -> GIG 
[GameState] Regional reputation gain in Test City (+10) 
[GameState] Scene Change: GIG -> POSTGIG 
[Economy] Calculating Gig Financials { gig: 'Test Punk Keller', score: 30, fame: 0 }
[Economy] Gig Report Generated { net: 1260, income: 1460, expenses: 200 }
[GameState] Update Player { money: 680, fame: 100 }
[GameState] Set Current Gig 
[GameState] Regional reputation loss in Test City due to poor gig performance (-10) 
[GameState] Scene Change: POSTGIG -> OVERWORLD 
[GameState] Update Player { money: 660, currentNodeId: 'node_1_0' }
[GameState] Day Advanced to 3 
[GameState] Starting Gig Sequence Test Punk Keller
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Update Player { money: 5 }
[GameState] Starting Gig Sequence Test Punk Keller
[GameState] Scene Change: PREGIG -> GIG 
[GameState] Regional reputation gain in Stendal (+10) 
[GameState] Scene Change: GIG -> POSTGIG 
[GameState] Update Player { money: -95 }
[GameState] Scene Change: POSTGIG -> GAMEOVER 
[GameState] State Reset (Debug) 
[GameState] Scene Change: INTRO -> MENU 
[GameState] Update Player { money: -999 }
[GameState] Applying Event Delta { player: { money: -99999 } }
[GameState] Update Band { harmony: -50 }
[GameState] Update Band { harmony: 200 }
[GameState] Applying Event Delta { band: { harmony: -200 } }
[GameState] Applying Event Delta { player: { van: { fuel: 500 } } }
[GameState] Applying Event Delta { player: { van: { fuel: -500 } } }
[GameState] Applying Event Delta { player: { van: { condition: -500 } } }
[GameState] Update Player { money: 50 }
[GameState] Day Advanced to 2 
[GameState] Day Advanced to 3 
[GameState] Day Advanced to 4 
[GameState] Day Advanced to 5 
[GameState] Day Advanced to 6 
[GameState] Day Advanced to 2 
[GameState] Update Band {
  inventory: {
    shirts: 0,
    hoodies: 20,
    patches: 100,
    cds: 30,
    vinyl: 10,
    strings: true,
    cables: true,
    drum_parts: true,
    golden_pick: false
  }
}
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Scene Change: INTRO -> INTRO 
[GameState] Scene Change: INTRO -> MENU 
[GameState] Scene Change: INTRO -> MENU 
[GameState] Scene Change: MENU -> OVERWORLD 
[GameState] Scene Change: INTRO -> MENU 
[GameState] Scene Change: MENU -> SETTINGS 
[GameState] Scene Change: INTRO -> MENU 
[GameState] Scene Change: MENU -> CREDITS 
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Scene Change: OVERWORLD -> PREGIG 
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Scene Change: OVERWORLD -> GAMEOVER 
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Scene Change: OVERWORLD -> MENU 
[GameState] Scene Change: INTRO -> PREGIG 
[GameState] Scene Change: PREGIG -> GIG 
[GameState] Scene Change: INTRO -> PREGIG 
[GameState] Scene Change: PREGIG -> OVERWORLD 
[GameState] Scene Change: INTRO -> GIG 
[GameState] Scene Change: GIG -> POSTGIG 
[GameState] Scene Change: INTRO -> GIG 
[GameState] Scene Change: GIG -> OVERWORLD 
[GameState] Scene Change: INTRO -> POSTGIG 
[GameState] Scene Change: POSTGIG -> OVERWORLD 
[GameState] Scene Change: INTRO -> POSTGIG 
[GameState] Scene Change: POSTGIG -> GAMEOVER 
[GameState] Scene Change: INTRO -> GAMEOVER 
[GameState] Scene Change: GAMEOVER -> MENU 
[GameState] Scene Change: INTRO -> SETTINGS 
[GameState] Scene Change: SETTINGS -> MENU 
[GameState] Scene Change: INTRO -> CREDITS 
[GameState] Scene Change: CREDITS -> MENU 
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Starting Gig Sequence Test Punk Keller
[GameState] Day Advanced to 2 
[GameState] Day Advanced to 2 
ÔûÂ Golden Path: Full Tour Cycle
  Ô£ö Phase 0: Initial state is INTRO (1.2695ms)
  Ô£ö Phase 1: INTRO ÔåÆ MENU (3.6894ms)
  Ô£ö Phase 2: MENU ÔåÆ OVERWORLD via RESET_STATE + CHANGE_SCENE (0.8651ms)
  Ô£ö Phase 3: Set up map in OVERWORLD (0.7658ms)
  Ô£ö Phase 4: Travel costs (simulate OVERWORLD travel) (1.0772ms)
  Ô£ö Phase 5: ADVANCE_DAY after travel (1.8933ms)
  Ô£ö Phase 6: OVERWORLD ÔåÆ PREGIG via START_GIG (1.0567ms)
  Ô£ö Phase 7: Configure setlist and modifiers in PREGIG (0.4198ms)
  Ô£ö Phase 8: PREGIG ÔåÆ GIG (0.4774ms)
  Ô£ö Phase 9: Gig performance produces stats (0.9951ms)
  Ô£ö Phase 10: GIG ÔåÆ POSTGIG (0.4361ms)
  Ô£ö Phase 11: Calculate financials in POSTGIG (1.3937ms)
  Ô£ö Phase 12: Apply earnings and return to OVERWORLD (24.9497ms)
  Ô£ö Phase 13: Second gig cycle preserves progression (2.2001ms)
Ô£ö Golden Path: Full Tour Cycle (46.0898ms)
ÔûÂ Golden Path: Bankruptcy triggers GAMEOVER
  Ô£ö Drain money to near zero (0.5621ms)
  Ô£ö Start a gig (0.4535ms)
  Ô£ö Negative net triggers GAMEOVER path (0.5317ms)
  Ô£ö GAMEOVER ÔåÆ MENU via RESET_STATE (0.8278ms)
Ô£ö Golden Path: Bankruptcy triggers GAMEOVER (3.8282ms)
ÔûÂ Golden Path: State safety invariants across transitions
  Ô£ö Money never goes negative from UPDATE_PLAYER (1.8766ms)
  Ô£ö Money never goes negative from APPLY_EVENT_DELTA (1.762ms)
  Ô£ö Harmony clamped [1, 100] from UPDATE_BAND (1.1138ms)
  Ô£ö Harmony clamped [1, 100] from APPLY_EVENT_DELTA (0.9027ms)
  Ô£ö Fuel clamped [0, 100] from APPLY_EVENT_DELTA (0.8869ms)
  Ô£ö Van condition clamped [0, 100] from APPLY_EVENT_DELTA (0.6208ms)
  Ô£ö ADVANCE_DAY preserves state safety after many days (1.0561ms)
  Ô£ö Van condition decays daily and breakdown chance adjusts (0.4745ms)
  Ô£ö CONSUME_ITEM decrements numeric inventory (0.416ms)
  Ô£ö CONSUME_ITEM sets boolean inventory to false (0.3036ms)
  Ô£ö CONSUME_ITEM never goes below 0 (1.5518ms)
Ô£ö Golden Path: State safety invariants across transitions (15.5834ms)
ÔûÂ Golden Path: SET_GIG_MODIFIERS functional updater
  Ô£ö Object payload merges with existing modifiers (0.4819ms)
  Ô£ö Function payload receives current modifiers (0.7797ms)
Ô£ö Golden Path: SET_GIG_MODIFIERS functional updater (3.7319ms)
ÔûÂ Golden Path: LOAD_GAME sanitizes corrupted save data
  Ô£ö Negative money in save is clamped to 0 (3.0943ms)
  Ô£ö Harmony out of range is clamped (0.9383ms)
  Ô£ö Fuel overflow is clamped to 100 (0.9184ms)
  Ô£ö Missing fields get defaults (0.694ms)
  Ô£ö Legacy energy modifier migrated to catering (1.1437ms)
  Ô£ö Day cannot be less than 1 (0.5416ms)
Ô£ö Golden Path: LOAD_GAME sanitizes corrupted save data (9.3271ms)
ÔûÂ Golden Path: Scene sequence matches state machine
  Ô£ö All valid transitions produce the target scene (3.9264ms)
  Ô£ö START_GIG transitions to PREGIG regardless of current scene (0.4775ms)
Ô£ö Golden Path: Scene sequence matches state machine (5.1598ms)
ÔûÂ Golden Path: Daily cost scaling with band size
  Ô£ö Daily cost includes per-member component (0.9367ms)
Ô£ö Golden Path: Daily cost scaling with band size (2.4154ms)
ÔûÂ Golden Path: Event cooldowns reset on ADVANCE_DAY
  Ô£ö Cooldowns cleared after day advance (1.7453ms)
Ô£ö Golden Path: Event cooldowns reset on ADVANCE_DAY (2.2114ms)
ÔûÂ Golden Path: Gig stats snapshot structure
  Ô£ö buildGigStatsSnapshot includes all fields (3.0254ms)
Ô£ö Golden Path: Gig stats snapshot structure (3.4995ms)
Ô£ö updateProjectiles - updates position and rotation (1.2619ms)
Ô£ö updateProjectiles - removes projectiles below limit (0.2365ms)
Ô£ö updateProjectiles - handles empty array (0.1553ms)
Ô£ö updateProjectiles - mutates array in-place (0.1322ms)
Ô£ö trySpawnProjectile - spawns based on chance (0.345ms)
Ô£ö trySpawnProjectile - does not spawn if random > chance (0.1845ms)
Ô£ö trySpawnProjectile - higher chance on low health (0.1951ms)
Ô£ö trySpawnProjectile - higher chance on high combo (0.1572ms)
Ô£ö checkCollisions - detects collision and calls onHit (0.2899ms)
Ô£ö checkCollisions - handles no collisions (0.2174ms)
Ô£ö checkCollisions - handles all collisions (0.1726ms)
Ô£ö checkCollisions - handles mixed collisions order (0.8869ms)
ÔûÂ HQ Items Data Integrity
  Ô£ö validates all gear items (1.5676ms)
  Ô£ö validates all instrument items (0.3652ms)
  Ô£ö validates all van items (0.365ms)
  Ô£ö validates all hq items (0.629ms)
Ô£ö HQ Items Data Integrity (4.6513ms)
ÔûÂ HQ Passive Effects
  Ô£ö hq_room_label purchase gives money bonus (254.6874ms)
  Ô£ö calculateDailyUpdates applies passive boosts for HQ items (21.8769ms)
  Ô£ö passive boosts are clamped to 100 (11.7473ms)
  Ô£ö passive boosts are clamped to 100 (properly) (17.1474ms)
Ô£ö HQ Passive Effects (307.2622ms)
Ô£û getGenImageUrl generates correct Pollinations.ai URL (9.7939ms)
Ô£ö IMG_PROMPTS contains expected keys and string values (2.9856ms)
Ô£ö createNamedLazyLoader maps a named export to default (1.4564ms)
Ô£ö createNamedLazyLoader throws a helpful error when export is missing (0.917ms)
ÔûÂ Logger
  Ô£ö constructor defaults to DEBUG level (3.0208ms)
  Ô£ö constructor loads level from localStorage (0.6845ms)
  Ô£ö setLevel updates level and saves to localStorage (0.8922ms)
  Ô£ö subscribe registers callback and unsubscribe removes it (2.8894ms)
  Ô£ö debug logs only if level <= DEBUG (0.7952ms)
  Ô£ö info logs only if level <= INFO (1.6665ms)
  Ô£ö warn logs only if level <= WARN (0.5128ms)
  Ô£ö error logs only if level <= ERROR (0.4236ms)
  Ô£ö logs are trimmed to maxLogs (0.7068ms)
  Ô£ö clear removes all logs and emits clear event (0.5585ms)
  Ô£ö dump returns JSON string of logs (0.3685ms)
  Ô£ö debug does not call console.debug in production (0.4009ms)
  Ô£ö info does not call console.info in production (0.3438ms)
  Ô£ö warn still calls console.warn in production (0.3599ms)
  Ô£ö log entries use valid UUIDs for ids (0.6451ms)
Ô£ö Logger (16.5658ms)

node:internal/modules/run_main:107
    triggerUncaughtException(
    ^
Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'react-i18next' imported from C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\src\scenes\MainMenu.jsx
    at Object.getPackageJSONURL (node:internal/modules/package_json_reader:316:9)
    at packageResolve (node:internal/modules/esm/resolve:768:81)
    at moduleResolve (node:internal/modules/esm/resolve:858:18)
    at defaultResolve (node:internal/modules/esm/resolve:990:11)
    at nextResolve (node:internal/modules/esm/hooks:785:28)
    at resolveBase (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/node_modules/tsx/dist/esm/index.mjs?1772193571082:2:3744)
    at resolveDirectory (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/node_modules/tsx/dist/esm/index.mjs?1772193571082:2:4243)
    at resolveTsPaths (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/node_modules/tsx/dist/esm/index.mjs?1772193571082:2:4984)
    at resolve (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/node_modules/tsx/dist/esm/index.mjs?1772193571082:2:5361)
    at nextResolve (node:internal/modules/esm/hooks:785:28) {
  code: 'ERR_MODULE_NOT_FOUND'
}

Node.js v24.13.0
Ô£û tests\mainMenuAudio.test.js (50233.9005ms)
Ô£ö MapGenerator generates a map with correct structure (5.6282ms)
Ô£ö MapGenerator guarantees start node (1.6047ms)
Ô£ö MapGenerator guarantees finale node (1.7219ms)
Ô£ö MapGenerator connections are valid (0.8866ms)
Ô£ö MapGenerator ensures nodes do not overlap (0.6746ms)
Ô£ö MapGenerator should not have duplicate venues (if possible) (7.2979ms)
(node:12192) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ mapUtils
  ÔûÂ isConnected
    Ô£ö returns true if nodes are directly connected (1.2013ms)
    Ô£ö returns false if nodes are not directly connected (0.488ms)
    Ô£ö returns false if map is missing (0.3114ms)
  Ô£ö isConnected (4.8978ms)
  ÔûÂ getNodeVisibility
    Ô£ö returns visible for current layer (0.5076ms)
    Ô£ö returns visible for next layer (0.2317ms)
    Ô£ö returns dimmed for layer + 2 (0.1853ms)
    Ô£ö returns hidden for layer + 3 or more (0.1997ms)
  Ô£ö getNodeVisibility (1.5799ms)
  ÔûÂ checkSoftlock
    Ô£ö returns false if map or player invalid (0.9703ms)
    Ô£ö returns false if player can reach a neighbor (0.7639ms)
    Ô£ö returns false if player cannot reach neighbor but can refuel (2.271ms)
    Ô£ö returns true if player cannot reach neighbor and cannot refuel (0.2534ms)
    Ô£ö returns false if current node is GIG even if stranded otherwise (0.2296ms)
  Ô£ö checkSoftlock (5.0919ms)
Ô£ö mapUtils (12.5273ms)
ÔûÂ isPercussionTrack
  Ô£ö detects percussion instrument metadata (1.1198ms)
  Ô£ö detects channel 9 percussion tracks (0.2578ms)
  Ô£ö returns false for non-percussion tracks (0.2037ms)
Ô£ö isPercussionTrack (3.5713ms)
ÔûÂ isValidMidiNote
  Ô£ö accepts finite MIDI pitches (0.34ms)
  Ô£ö rejects invalid MIDI pitches (0.2687ms)
Ô£ö isValidMidiNote (1.4006ms)
ÔûÂ normalizeMidiPitch
  Ô£ö normalizes valid MIDI pitches (0.2393ms)
  Ô£ö returns null for invalid MIDI pitches (0.2488ms)
Ô£ö normalizeMidiPitch (1.1916ms)
ÔûÂ buildMidiTrackEvents
  Ô£ö filters invalid notes and normalizes pitches (1.2702ms)
  Ô£ö returns empty array for invalid input (0.2105ms)
Ô£ö buildMidiTrackEvents (2.0562ms)
ÔûÂ getNoteName
  Ô£ö returns correct note names for valid MIDI pitches (0.2004ms)
  Ô£ö returns null for invalid MIDI pitches (0.1408ms)
  Ô£ö handles float inputs by flooring (0.1609ms)
Ô£ö getNoteName (1.0749ms)
[GameState] Starting Travel Minigame to node_1 
[GameState] Travel Minigame Complete { damageTaken: 20, itemsCollected: [ 'FUEL' ] }
[GameState] Starting Roadie Minigame for Gig gig_123 
[GameState] Roadie Minigame Complete { equipmentDamage: 5 }
ÔûÂ Minigame State Transitions
  Ô£ö START_TRAVEL_MINIGAME updates state correctly (4.7308ms)
  Ô£ö COMPLETE_TRAVEL_MINIGAME applies results and updates location (2.947ms)
  Ô£ö START_ROADIE_MINIGAME updates state correctly (0.6358ms)
  Ô£ö COMPLETE_ROADIE_MINIGAME resets minigame state and applies economy effects (0.856ms)
Ô£ö Minigame State Transitions (11.6535ms)
[Perf] 100k frames took: 105.91ms
(node:30456) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ EffectManager Performance
  Ô£ö removal performance (110.2809ms)
Ô£ö EffectManager Performance (423.6982ms)
Filter assignment count: 0
(node:38828) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ PixiStageController Filter Performance
  Ô£ö Optimization: Filters should only be assigned on state change (130.5556ms)
Ô£ö PixiStageController Filter Performance (131.9075ms)
ÔûÂ calculateGigPhysics - Character Traits
  Ô£ö should apply gear_nerd trait correctly (Matze) (1.3394ms)
  Ô£ö should apply party_animal trait correctly (Marius) (0.2807ms)
  Ô£ö should apply bandleader trait correctly (Lars) (0.2084ms)
  Ô£ö should apply social_manager trait correctly (Lars) (0.1892ms)
Ô£ö calculateGigPhysics - Character Traits (3.376ms)
Ô£ö calculateNoteY returns target position at hit time (0.9037ms)
Ô£ö buildRhythmLayout derives lane and hit line positions (0.2663ms)
Ô£ö getPixiColorFromToken falls back when CSS variables are unavailable (0.194ms)
Ô£ö getPixiColorFromToken resolves css variable color values (0.2702ms)
Ô£ö shouldTriggerBankruptcy returns true for negative money (1.4405ms)
Ô£ö shouldTriggerBankruptcy returns false for positive money (0.272ms)
Ô£ö shouldTriggerBankruptcy at zero money returns false if breaking even or profitable (0.1822ms)
Ô£ö shouldTriggerBankruptcy at zero money returns true if losing money (0.1811ms)
Ô£ö shouldTriggerBankruptcy handles missing netIncome safely (0.1966ms)
Ô£ö shouldTriggerBankruptcy throws for invalid money input (2.3803ms)
Ô£ö shouldTriggerBankruptcy handles numeric strings (0.3466ms)
ÔûÂ purchaseLogicUtils
  ÔûÂ getPrimaryEffect
    Ô£ö returns first effect from effects array (2.0448ms)
    Ô£ö returns effect object if present (0.3569ms)
    Ô£ö returns undefined if no effect (0.257ms)
  Ô£ö getPrimaryEffect (3.9153ms)
  ÔûÂ getAdjustedCost
    Ô£ö returns cost without modification if no gear_nerd (0.4993ms)
    Ô£ö returns discounted cost with gear_nerd for GEAR money items (0.3481ms)
    Ô£ö does not discount if currency is fame (0.2579ms)
  Ô£ö getAdjustedCost (2.4661ms)
  ÔûÂ buildVanWithUpgrade
    Ô£ö adds upgrade if not present (0.4044ms)
    Ô£ö does not duplicate upgrade (0.2343ms)
    Ô£ö handles undefined van (0.2676ms)
  Ô£ö buildVanWithUpgrade (1.2811ms)
  ÔûÂ isItemOwned
    Ô£ö returns true if item id is in van upgrades (0.4122ms)
    Ô£ö returns true if item id is in hq upgrades (0.2007ms)
    Ô£ö returns true if inventory item is true for inventory_set (0.14ms)
  Ô£ö isItemOwned (0.9826ms)
  ÔûÂ canAfford
    Ô£ö returns true if money >= adjustedCost (0.2175ms)
    Ô£ö returns false if money < adjustedCost (0.1045ms)
    Ô£ö returns true if fame >= adjustedCost (0.0975ms)
  Ô£ö canAfford (0.5683ms)
  ÔûÂ applyInventorySet
    Ô£ö sets inventory item to value (0.3016ms)
    Ô£ö handles undefined inventory (0.1683ms)
  Ô£ö applyInventorySet (0.5969ms)
  ÔûÂ applyInventoryAdd
    Ô£ö adds value to existing inventory item (0.2402ms)
    Ô£ö initializes inventory item if missing (0.1698ms)
  Ô£ö applyInventoryAdd (0.5274ms)
  ÔûÂ applyStatModifier
    Ô£ö applies to player stat (0.3286ms)
    Ô£ö applies to player money (clamped) (0.1602ms)
    Ô£ö applies to van stat (0.1388ms)
    Ô£ö applies to band stat (0.141ms)
    Ô£ö applies to band harmony (clamped 1-100) (0.1814ms)
    Ô£ö applies to performance stat by default (0.2427ms)
  Ô£ö applyStatModifier (1.5154ms)
  ÔûÂ applyUnlockUpgrade
    Ô£ö unlocks new upgrade (0.3091ms)
    Ô£ö does not duplicate existing upgrade (0.1673ms)
  Ô£ö applyUnlockUpgrade (0.6127ms)
  ÔûÂ applyUnlockHQ
    Ô£ö returns correct messages for special items (0.381ms)
    Ô£ö clamps harmony for soundproofing (0.3078ms)
  Ô£ö applyUnlockHQ (0.8395ms)
  ÔûÂ applyPassive
    Ô£ö applies harmony regen travel (0.2922ms)
    Ô£ö applies passive followers (0.1363ms)
  Ô£ö applyPassive (0.5442ms)
Ô£ö purchaseLogicUtils (15.5254ms)
ÔûÂ Relationship Mechanics
  Ô£ö Relationship update via applyEventDelta (1.5815ms)
  Ô£ö Grudge Holder Trait amplifies negative change (1.519ms)
  Ô£ö Peacemaker Trait amplifies positive change (0.8933ms)
  Ô£ö Peacemaker Trait dampens negative change (17.738ms)
  Ô£ö Event Engine Placeholder Resolution (3.8984ms)
  Ô£ö Unlock Checks (0.7028ms)
Ô£ö Relationship Mechanics (39.7063ms)
Ô£ö trySpawnProjectile respects spawn chance (1.8775ms)
Ô£ö trySpawnProjectile respects no spawn (0.3396ms)
Ô£ö trySpawnProjectile increases chance on low health (0.298ms)
Ô£ö trySpawnProjectile increases chance on high combo (0.2177ms)
Ô£ö updateProjectiles moves items correctly (0.4317ms)
Ô£ö updateProjectiles removes off-screen items (0.2249ms)
Ô£ö updateProjectiles handles empty input (1.0357ms)
Ô£ö updateProjectiles handles large delta (lag spike) (0.2138ms)
Ô£ö checkCollisions detects hits and removes items (0.3677ms)
Ô£ö checkCollisions handles multiple simultaneous hits (0.4487ms)
Ô£ö checkCollisions handles all items hitting (0.261ms)
Ô£ö checkCollisions handles no hits (0.1581ms)
Ô£ö checkCollisions handles empty input (0.1693ms)
Ô£ö checkCollisions handles missing onHit callback (0.1336ms)
Ô£ö checkHit finds matching note within window (1.4803ms)
Ô£ö checkHit ignores notes outside window (0.2977ms)
Ô£ö checkHit ignores wrong lane (0.1894ms)
Ô£ö checkHit ignores already hit or invisible notes (0.2056ms)
Ô£ö checkHit prioritizes closest note? (0.2115ms)
Ô£ö generateNotesForSong creates correct note structure (2.6481ms)
Ô£ö generateNotesForSong respects difficulty (0.4237ms)
(node:35932) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useRhythmGameLogic Multi-Song Support
  Ô£ö initializes audio and notes for multiple songs in sequence (789.5849ms)
  Ô£ö Quit logic does not trigger multi-song chaining (193.0165ms)
  Ô£ö does not force a default excerpt duration when metadata is missing (123.4424ms)
  Ô£ö Game loop waits for setlistCompleted signal (124.846ms)
  Ô£ö totalDuration snap: no change when getGigTimeMs returns NaN (182.95ms)
Ô£ö useRhythmGameLogic Multi-Song Support (1416.0859ms)
(node:26136) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useRhythmGameScoring Game Over
  Ô£ö marks game over and stops audio on collapse (198.754ms)
Ô£ö useRhythmGameScoring Game Over (200.5981ms)
ÔûÂ rhythm_songs.json integration
  Ô£ö all songs can be parsed without error (3.0273ms)
Ô£ö rhythm_songs.json integration (5.7001ms)
ÔûÂ rhythm_songs.json sourceOgg fields
  Ô£ö every song with sourceMid has a matching sourceOgg (0.584ms)
Ô£ö rhythm_songs.json sourceOgg fields (1.1325ms)
ÔûÂ calculateTimeFromTicks logic
  Ô£ö calculates correct time with constant tempo (0.2993ms)
  Ô£ö calculates correct time with tempo change (0.223ms)
  Ô£ö handles empty map gracefully (0.2578ms)
Ô£ö calculateTimeFromTicks logic (1.6579ms)
ÔûÂ rhythmUtils
  ÔûÂ checkHit
    Ô£ö should return note for exact hit (1.5334ms)
    Ô£ö should return note for hit just inside start boundary (inclusive/exclusive check) (0.3755ms)
    Ô£ö should return note for hit just inside end boundary (0.3858ms)
    Ô£ö should return null for hit exactly at start boundary (exclusive) (0.2273ms)
    Ô£ö should return null for hit exactly at end boundary (exclusive) (0.2554ms)
    Ô£ö should return null for hit outside start boundary (0.2257ms)
    Ô£ö should return null for hit outside end boundary (0.4069ms)
    Ô£ö should respect lane index (1.2578ms)
    Ô£ö should ignore invisible notes (0.4281ms)
    Ô£ö should ignore already hit notes (1.8645ms)
    Ô£ö should handle floating point precision robustly (0.2319ms)
    Ô£ö should return null if elapsed is not finite (0.1393ms)
  Ô£ö checkHit (9.1341ms)
  ÔûÂ calculateTimeFromTicks
    Ô£ö should handle empty tempo map (0.3394ms)
    Ô£ö should calculate time for initial segment (ms) (0.2513ms)
    Ô£ö should calculate time crossing segments (ms) (0.1383ms)
    Ô£ö should calculate time crossing segments (seconds) (0.1366ms)
    Ô£ö should handle ticks exactly on segment boundary (0.1553ms)
    Ô£ö should handle ticks beyond last segment (0.109ms)
  Ô£ö calculateTimeFromTicks (1.4148ms)
  ÔûÂ parseSongNotes excerpt alignment
    Ô£ö uses note tick times directly without subtracting excerptStartMs (0.5245ms)
    Ô£ö uses resolved playback window (excerptEndMs priority) to cap note duration (0.2053ms)
    Ô£ö does not impose a synthetic 30s excerpt cap when excerpt metadata is missing (0.1456ms)
  Ô£ö parseSongNotes excerpt alignment (1.0054ms)
  ÔûÂ calculateTimeFromTicks (Optimized)
    Ô£ö should have preprocessed data (0.1532ms)
    Ô£ö should calculate time for initial segment (ms) (0.1168ms)
    Ô£ö should calculate time crossing segments (ms) (0.1654ms)
    Ô£ö should calculate time crossing segments (seconds) (0.0987ms)
    Ô£ö should handle ticks exactly on segment boundary (0.0967ms)
    Ô£ö should handle ticks beyond last segment (0.0883ms)
  Ô£ö calculateTimeFromTicks (Optimized) (0.9262ms)
Ô£ö rhythmUtils (13.3544ms)
ÔûÂ saveValidator - Leaderboard Identity
  Ô£ö accepts valid playerId and playerName (1.7359ms)
  Ô£ö accepts null playerId (uninitialized) (0.3464ms)
  Ô£ö accepts missing playerId and playerName (legacy saves) (0.2354ms)
  Ô£ö throws if playerId is not a string or null (1.7224ms)
  Ô£ö throws if playerName is not a string (0.4412ms)
Ô£ö saveValidator - Leaderboard Identity (6.3059ms)
ÔûÂ saveValidator
  Ô£ö returns true for valid save data (1.7093ms)
  ÔûÂ root object validation
    Ô£ö throws if data is null (1.4943ms)
    Ô£ö throws if data is not an object (0.3783ms)
    Ô£ö throws if data is an array (0.3924ms)
    Ô£ö throws if required top-level keys are missing (0.464ms)
  Ô£ö root object validation (3.2385ms)
  ÔûÂ player validation
    Ô£ö throws if player is not an object (0.3825ms)
    Ô£ö throws if numeric fields are not numbers (3.341ms)
    Ô£ö throws if player.van is not an object (0.6084ms)
  Ô£ö player validation (4.9473ms)
  ÔûÂ band validation
    Ô£ö throws if band is not an object (0.5631ms)
    Ô£ö throws if band.members is not an array (0.4405ms)
    Ô£ö throws if band member is not an object (0.3678ms)
    Ô£ö throws if band member name is not a string (0.3275ms)
    Ô£ö throws if band.harmony is not a number (0.281ms)
  Ô£ö band validation (2.3929ms)
  ÔûÂ social validation
    Ô£ö throws if social is not an object (0.4557ms)
    Ô£ö throws if social values are not numbers (except lastGigDay) (0.2306ms)
    Ô£ö allows lastGigDay to be null (0.241ms)
    Ô£ö throws if lastGigDay is not a number or null (0.2239ms)
    Ô£ö validates activeDeals correctly (0.2282ms)
    Ô£ö throws if activeDeals is not an array (0.2384ms)
    Ô£ö throws if activeDeals items are invalid (0.3854ms)
  Ô£ö social validation (2.3638ms)
  ÔûÂ gameMap validation
    Ô£ö throws if gameMap is not an object (0.2917ms)
  Ô£ö gameMap validation (0.4181ms)
Ô£ö saveValidator (16.8664ms)
(node:8156) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
Ô£ö secureRandom returns values in [0, 1) (13.5294ms)
Ô£ö secureRandom utilizes crypto.getRandomValues (0.8381ms)
Ô£ö eventEngine uses secureRandom for event selection (56.2078ms)
[GameState] Game Loaded 
[GameState] Game Loaded 
Ô£ö validateSaveData rejects non-objects (1.9694ms)
Ô£ö validateSaveData rejects missing required keys (0.3512ms)
Ô£ö validateSaveData validates player field types (0.5146ms)
Ô£ö validateSaveData validates band field types (0.4006ms)
Ô£ö validateSaveData validates social values (0.4886ms)
Ô£ö gameReducer LOAD_GAME prevents prototype pollution and state pollution (4.9444ms)
Ô£ö gameReducer LOAD_GAME handles missing optional fields gracefully (0.6864ms)
Ô£ö validateSaveData validates gameMap field type (0.3498ms)
ÔûÂ Unlock Manager Security
  Ô£ö addUnlock sanitizes before adding (3.3028ms)
  Ô£ö addUnlock prevents duplicates (0.6267ms)
  Ô£ö addUnlock adds multiple unique items (0.4387ms)
  Ô£ö addUnlock rejects non-string inputs (0.4066ms)
Ô£ö Unlock Manager Security (68.8018ms)
Ô£ö getGigModifiers returns default modifiers for average band (2.0095ms)
Ô£ö getGigModifiers grants telepathy bonus for high harmony (0.4645ms)
Ô£ö getGigModifiers applies disconnect penalty for low harmony (0.25ms)
Ô£ö getGigModifiers has no special effects for mid harmony (2.2661ms)
Ô£ö getGigModifiers applies grumpy Matze penalty (0.5379ms)
Ô£ö getGigModifiers does not apply Matze penalty when mood is okay (0.1846ms)
Ô£ö getGigModifiers applies tired Marius speed increase (0.2258ms)
Ô£ö getGigModifiers does not apply Marius penalty when stamina is okay (0.1963ms)
Ô£ö getGigModifiers can apply multiple effects (0.224ms)
Ô£ö calculateGigPhysics returns physics object (0.7005ms)
Ô£ö calculateGigPhysics calculates hit windows based on skill (0.314ms)
Ô£ö calculateGigPhysics skill increases hit windows (0.2696ms)
Ô£ö calculateGigPhysics reduces speed for low stamina (0.2396ms)
Ô£ö calculateGigPhysics normal speed for adequate stamina (0.1497ms)
Ô£ö calculateGigPhysics returns default multipliers (0.1713ms)
Ô£ö calculateGigPhysics applies blast machine trait for fast songs (0.2093ms)
Ô£ö calculateGigPhysics does not apply blast machine for slow songs (0.1697ms)
Ô£ö calculateGigPhysics includes avgStamina in result (0.2568ms)
Ô£ö calculateGigPhysics handles missing member gracefully (0.153ms)
Ô£ö calculateGigPhysics handles missing skill property (0.1342ms)
Ô£ö calculateDailyUpdates applies newsletter decay (0.8744ms)
Ô£ö calculateDailyUpdates does not decay if active recently (0.2183ms)
Ô£ö calculateDailyUpdates handles missing lastGigDay safely (0.1745ms)
Ô£ö calculateGigPhysics applies virtuoso trait hit window bonus (0.2016ms)
ÔûÂ Game Loop Logic Simulation
  Ô£ö Phase 1: Travel (Overworld) (1.9232ms)
  Ô£ö Phase 2: Refuel (Overworld) (0.3414ms)
  Ô£ö Phase 3: Gig (PostGig) (0.2815ms)
  Ô£ö Phase 4: Next Travel Cycle (0.3313ms)
Ô£ö Game Loop Logic Simulation (5.1825ms)
Ô£ö Stress Test: generatePostOptions over 10,000 random states (1466.2976ms)
Ô£ö Stress Test: resolvePost over 10,000 random selections and RNG rolls (30.6254ms)
Ô£ö Stress Test: calculateDailyUpdates over 10,000 random states (29.5136ms)
Ô£ö calculateViralityScore returns base chance for average performance (3.5165ms)
Ô£ö calculateViralityScore increases with high performance (0.3499ms)
Ô£ö calculateViralityScore applies performance multipliers (0.2546ms)
Ô£ö calculateViralityScore boosts for Kaminstube venue (0.2126ms)
Ô£ö calculateViralityScore boosts for stage diver event (0.2089ms)
Ô£ö calculateViralityScore boosts for influencer event (0.2154ms)
Ô£ö calculateViralityScore is capped at 90% (0.2091ms)
Ô£ö calculateViralityScore combines multiple bonuses (0.5297ms)
Ô£ö generatePostOptions returns array of exactly 3 options (4.5973ms)
Ô£ö generatePostOptions forces sponsor post if active (1.8961ms)
Ô£ö generatePostOptions all have required properties (0.763ms)
Ô£ö resolvePost handles RNG success (0.7629ms)
Ô£ö resolvePost handles RNG failure (0.3014ms)
Ô£ö resolvePost returns consistent structure (0.3394ms)
Ô£ö calculateViralityScore handles low performance (0.1914ms)
Ô£ö applyReputationDecay returns original followers if days since last post < 3 (0.187ms)
Ô£ö applyReputationDecay applies 1% decay for 3 days (0.1837ms)
Ô£ö applyReputationDecay applies 8% decay for 10 days (0.1027ms)
Ô£ö applyReputationDecay caps decay at 50% (0.0864ms)
Ô£ö applyReputationDecay handles 0 followers (0.1492ms)
Ô£ö applyReputationDecay floors the result (0.1154ms)
Ô£ö calculateSocialGrowth calculates base growth based on performance (0.5738ms)
Ô£ö calculateSocialGrowth applies platform multipliers (0.1656ms)
Ô£ö calculateSocialGrowth applies viral bonus (0.1172ms)
Ô£ö checkViralEvent returns true for high accuracy (0.3834ms)
Ô£ö checkViralEvent returns true for high combo (0.18ms)
Ô£ö checkViralEvent handles random roll with modifiers (0.1262ms)
Ô£ö checkViralEvent uses calculateViralityScore when context is provided (0.3394ms)
Ô£ö generateBrandName returns different name for alignment (0.389ms)
Ô£ö generateBrandName returns base name for unknown alignment (0.1078ms)
Ô£ö generateBrandOffers filters by reputation and traits (1.1295ms)
Ô£ö negotiateDeal SAFE strategy succeeds with high roll (0.9268ms)
Ô£ö negotiateDeal SAFE strategy fails with low roll (0.2024ms)
Ô£ö negotiateDeal AGGRESSIVE strategy succeeds with very high luck (0.4959ms)
Ô£ö negotiateDeal AGGRESSIVE strategy revokes deal on failure (0.1805ms)
Ô£ö collab_influencer option exists (1.6393ms)
Ô£ö collab_influencer selects affordable influencer (Micro) (0.8588ms)
Ô£ö collab_influencer fails if no affordable influencer (0.5428ms)
Ô£ö collab_influencer applies relationship discount (0.3266ms)
Ô£ö collab_influencer caps discount at 50% (0.3221ms)
Ô£ö collab_influencer returns influencerUpdate (1.2896ms)
Ô£ö collab_influencer applies trait: tech_savvy (0.4195ms)
Ô£ö collab_influencer applies trait: drama_magnet (0.3188ms)
Ô£ö collab_influencer tier followers (0.4298ms)
ÔûÂ Extended Social & Trait Systems
  ÔûÂ Trend System
    Ô£ö generateDailyTrend returns a valid trend string (2.7526ms)
    Ô£ö generatePostOptions boosts trending categories (26.8102ms)
  Ô£ö Trend System (31.2228ms)
  ÔûÂ Brand Deals
    Ô£ö generateBrandOffers returns eligible deals (0.7242ms)
    Ô£ö generateBrandOffers filters ineligible deals (0.2065ms)
  Ô£ö Brand Deals (1.4935ms)
  ÔûÂ Cancel Culture
    Ô£ö calculateSocialGrowth applies negative growth on high controversy (0.4456ms)
  Ô£ö Cancel Culture (0.6229ms)
  ÔûÂ Showman Trait
    Ô£ö Showman trait boosts virality score (0.3667ms)
  Ô£ö Showman Trait (0.5882ms)
  ÔûÂ New Trait Unlocks
    Ô£ö Unlocks Melodic Genius for Lars on slow song combo (1.6387ms)
    Ô£ö Unlocks Tech Wizard for Matze on technical song accuracy (0.5589ms)
    Ô£ö Unlocks Showman for Marius on stage dives (0.4346ms)
  Ô£ö New Trait Unlocks (3.1267ms)
Ô£ö Extended Social & Trait Systems (38.3741ms)
Ô£ö resolveSongPlaybackWindow prefers excerpt end-start duration when available (3.0767ms)
Ô£ö resolveSongPlaybackWindow falls back to explicit duration when excerpt end is missing (0.43ms)
Ô£ö resolveSongPlaybackWindow falls back to durationMs then default (0.283ms)
Ô£ö resolveSongPlaybackWindow defaults to an unbounded duration when no metadata is provided (0.251ms)
ÔûÂ Trait Logic
  ÔûÂ hasTrait
    Ô£ö returns true if member has the trait (1.3697ms)
    Ô£ö returns false if member does not have the trait (0.3328ms)
    Ô£ö returns false if member has no traits (0.2595ms)
    Ô£ö returns false if member is undefined (0.2402ms)
  Ô£ö hasTrait (3.5094ms)
  ÔûÂ bandHasTrait
    Ô£ö returns true if any member has the trait (0.5312ms)
    Ô£ö returns false if no member has the trait (0.2475ms)
    Ô£ö returns false if band has no members (0.1887ms)
    Ô£ö returns false if band is undefined (0.2297ms)
  Ô£ö bandHasTrait (1.6341ms)
Ô£ö Trait Logic (6.119ms)
ÔûÂ Trait Utils
  Ô£ö applyTraitUnlocks finds member by ID (1.628ms)
  Ô£ö applyTraitUnlocks finds member by Name (case-insensitive) (0.4234ms)
  Ô£ö applyTraitUnlocks ignores if already unlocked (0.3439ms)
Ô£ö Trait Utils (4.1488ms)
ÔûÂ checkTraitUnlocks
  ÔûÂ GIG_COMPLETE
    Ô£ö unlocks Virtuoso for Matze with 0 misses (2.8093ms)
    Ô£ö unlocks Perfektionist for Matze with 100% accuracy (0.4419ms)
    Ô£ö unlocks Blast Machine for Marius with fast song (>160 BPM) and maxCombo > 50 (0.3895ms)
    Ô£ö does not unlock Blast Machine for Marius if combo is too low (0.2657ms)
    Ô£ö unlocks Melodic Genius for Lars with slow song (<120 BPM) and maxCombo > 30 (0.3118ms)
    Ô£ö unlocks Tech Wizard for Matze with technical song (>3 difficulty) and 100% accuracy (0.2685ms)
  Ô£ö GIG_COMPLETE (6.0558ms)
  ÔûÂ TRAVEL_COMPLETE
    Ô£ö unlocks Road Warrior for Lars with >= 5000 total distance (0.3664ms)
    Ô£ö does not unlock Road Warrior for Lars with < 5000 total distance (0.2637ms)
  Ô£ö TRAVEL_COMPLETE (0.9745ms)
  ÔûÂ PURCHASE
    Ô£ö unlocks Party Animal for Marius when buying cheap beer fridge (0.42ms)
    Ô£ö unlocks Party Animal for Marius when owning cheap beer fridge (via upgrades) (0.6531ms)
    Ô£ö unlocks Gear Nerd for Matze when gear count >= 5 (0.4065ms)
  Ô£ö PURCHASE (4.1978ms)
  ÔûÂ SOCIAL_UPDATE
    Ô£ö unlocks Social Manager for Lars when max followers >= 1000 (0.3534ms)
  Ô£ö SOCIAL_UPDATE (0.5322ms)
  ÔûÂ EVENT_RESOLVED
    Ô£ö unlocks Bandleader for Lars when conflicts resolved >= 3 (0.2934ms)
    Ô£ö unlocks Showman for Marius when stage dives >= 3 (0.2155ms)
    Ô£ö unlocks Grudge Holder for Matze when any relationship < 30 (0.1863ms)
    Ô£ö unlocks Peacemaker for Lars when band harmony >= 90 (0.1324ms)
  Ô£ö EVENT_RESOLVED (1.0628ms)
  ÔûÂ Edge Cases
    Ô£ö does not unlock trait if already owned (0.2093ms)
    Ô£ö returns empty array if member not found (0.1366ms)
    Ô£ö returns empty array for unknown context type (0.1247ms)
  Ô£ö Edge Cases (0.6232ms)
Ô£ö checkTraitUnlocks (14.6913ms)
[ErrorHandler] Storage operation failed: saveUnlocks {
  name: 'StorageError',
  message: 'Storage operation failed: saveUnlocks',
  category: 'storage',
  severity: 'medium',
  context: { originalError: 'Storage Full' },
  recoverable: true,
  timestamp: 1772193575531,
  stack: 'StorageError: Storage operation failed: saveUnlocks\n' +
    '    at safeStorageOperation (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/errorHandler.js:197:7)\n' +
    '    at addUnlock (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/unlockManager.js:48:10)\n' +
    '    at TestContext.<anonymous> (C:\\Users\\andre.oswald\\Code\\Neuro\\neurotoxic-game\\tests\\unlockManager.test.js:85:22)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at async TestContext.<anonymous> (C:\\Users\\andre.oswald\\Code\\Neuro\\neurotoxic-game\\tests\\unlockManager.test.js:78:3)\n' +
    '    at async Test.run (node:internal/test_runner/test:1113:7)\n' +
    '    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)'
}
ÔûÂ UnlockManager Unit Tests
  Ô£ö getUnlocks returns empty array when storage is empty (2.2236ms)
  Ô£ö getUnlocks returns empty array on invalid JSON (0.613ms)
  Ô£ö getUnlocks returns empty array if data is not an array (0.3992ms)
  Ô£ö getUnlocks sanitizes mixed-type arrays (0.6039ms)
  Ô£ö addUnlock successfully adds unique string unlock (0.676ms)
  Ô£ö addUnlock rejects non-string input (0.398ms)
  Ô£ö addUnlock prevents duplicates (0.3968ms)
  Ô£ö addUnlock returns false if storage fails (17.3795ms)
Ô£ö UnlockManager Unit Tests (47.9067ms)
Ô£ö getUnifiedUpgradeCatalog includes upgrades from all active sources (1.7046ms)
Ô£ö getUnifiedUpgradeCatalog entries contain required purchase fields (0.6756ms)
Ô£ö hasUpgrade - checks ownership correctly (1.6106ms)
Ô£ö calcBaseBreakdownChance - no upgrades (0.4063ms)
Ô£ö calcBaseBreakdownChance - undefined upgrades (0.2767ms)
Ô£ö calcBaseBreakdownChance - single upgrade (van_suspension) (0.3399ms)
Ô£ö calcBaseBreakdownChance - multiple upgrades (0.2535ms)
Ô£ö calcBaseBreakdownChance - duplicate upgrades (should not double count) (0.231ms)
Ô£ö calcBaseBreakdownChance - large reduction (hq_van_tyre_spare) (0.2102ms)
Ô£ö calcBaseBreakdownChance - clamping to zero (2.1733ms)
Ô£ö calcBaseBreakdownChance - prototype pollution attempt (0.4677ms)
Ô£ö calcBaseBreakdownChance - unknown upgrade (0.4013ms)
Ô£ö calcBaseBreakdownChance - mixed known and unknown upgrades (0.2563ms)
[ArrivalLogic] Starting Gig at destination { venue: 'Club' }
(node:26380) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useArrivalLogic
  Ô£ö executes standard arrival sequence (172.6492ms)
  Ô£ö applies harmony regen if upgrade active (20.7026ms)
  Ô£ö handles REST_STOP node (19.7316ms)
  Ô£ö handles GIG node with sufficient harmony (15.3742ms)
  Ô£ö prevents GIG if harmony too low (21.3082ms)
  Ô£ö idempotency guard prevents double execution (20.4588ms)
Ô£ö useArrivalLogic (273.5634ms)
(node:22396) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useAudioControl
  Ô£ö initializes with values from audioManager (263.2579ms)
  Ô£ö setMusic updates music volume and state (24.5899ms)
  Ô£ö setMusic does not update state if manager returns false (22.1087ms)
  Ô£ö setMusic handles exceptions (16.7289ms)
  Ô£ö setSfx updates sfx volume and state (21.5443ms)
  Ô£ö setSfx handles exceptions (22.8349ms)
  Ô£ö toggleMute toggles mute state (15.9306ms)
  Ô£ö resumeMusic delegates through hook action (31.3023ms)
  Ô£ö stopMusic delegates through hook action (48.6745ms)
  Ô£ö inline selector remains stable across rerenders (13.7337ms)
  Ô£ö selector receives focused state updates (20.9718ms)
  Ô£ö syncs external mute updates across multiple hook instances (15.8905ms)
  Ô£ö polling fallback updates state when subscribe is unavailable (18.6205ms)
  Ô£ö toggleMute handles exceptions (11.226ms)
Ô£ö useAudioControl (551.4067ms)
(node:15456) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useBandHQModal
  Ô£ö toggles modal state correctly (353.855ms)
Ô£ö useBandHQModal (358.1584ms)
ÔûÂ useGigEffects
  Ô£ö triggerBandAnimation uses refs instead of DOM query (225.3251ms)
  Ô£ö chaosStyle memoization check (25.7378ms)
Ô£ö useGigEffects (252.6378ms)
(node:31256) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useGigInput
  Ô£ö handleLaneInput calls registerInput and triggerBandAnimation (179.3892ms)
  Ô£ö Escape key toggles pause menu (38.1169ms)
  Ô£ö Lane key triggers input (34.7938ms)
Ô£ö useGigInput (254.0354ms)
ÔûÂ usePurchaseLogic
  Ô£ö handleBuy marks one-time stat_modifier upgrades as owned in van.upgrades (239.8634ms)
  Ô£ö handleBuy prevents duplicate purchase of one-time passive upgrades (19.4251ms)
  Ô£ö handleBuy allows negative values for performance stats (21.5323ms)
  Ô£ö handleBuy applies harmony_regen_travel passive effect using key (17.9334ms)
  Ô£ö handleBuy applies passive_followers passive effect using key (14.6052ms)
Ô£ö usePurchaseLogic (315.2509ms)
(node:24732) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useRhythmGameLogic
  Ô£ö initial state (147.778ms)
  Ô£ö initialization runs on mount (239.6406ms)
  Ô£ö handleHit updates score (229.0239ms)
  Ô£ö calls endGig when all notes are processed near song end (229.0669ms)
  Ô£ö calls endGig when audio playback reports ended (245.803ms)
Ô£ö useRhythmGameLogic (1093.5456ms)
(node:20456) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useRhythmGameScoring
  Ô£ö initialization returns handlers (174.7643ms)
  Ô£ö handleHit updates score and combo on valid hit (47.7773ms)
  Ô£ö handleHit triggers miss on invalid hit (32.7857ms)
  Ô£ö handleHit applies lane multipliers (17.9379ms)
  Ô£ö handleMiss resets combo and applies penalties (16.2153ms)
  Ô£ö handleMiss triggers game over when health depleted (17.1991ms)
  Ô£ö activateToxicMode sets flag and toast (21.2944ms)
  Ô£ö Toxic Mode applies 4x score multiplier (19.1673ms)
  Ô£ö Real miss deactivates Toxic Mode (17.4436ms)
  Ô£ö Empty hit does not deactivate Toxic Mode (20.6315ms)
  Ô£ö Guestlist modifier increases score (29.1901ms)
  Ô£ö Perfektionist trait applies bonus score at high accuracy (13.9834ms)
  Ô£ö Perfektionist trait does not apply bonus score at low accuracy (13.2295ms)
  Ô£ö Overload increases on hit and triggers Toxic Mode when full (17.3374ms)
Ô£ö useRhythmGameScoring (461.9895ms)
(node:20272) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useRoadieLogic
  Ô£ö initializes with correct default state (195.836ms)
  Ô£ö moves player within bounds (32.5291ms)
  Ô£ö delivers item at venue (25.7306ms)
  Ô£ö picks up item at start (17.8017ms)
  Ô£ö spawns traffic over time (20.4885ms)
  Ô£ö handles collision and damage (20.9619ms)
  Ô£ö triggers game over on completion (25.0032ms)
Ô£ö useRoadieLogic (340.7002ms)
(node:38044) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useTourbusLogic
  ÔûÂ Spawn Rate
    Ô£ö spawn rate maintains constant density (spawns faster at higher speeds) (208.8741ms)
  Ô£ö Spawn Rate (209.749ms)
  ÔûÂ Movement
    Ô£ö moveLeft decreases lane but clamps at 0 (15.5292ms)
    Ô£ö moveRight increases lane but clamps at LANE_COUNT - 1 (23.8094ms)
  Ô£ö Movement (39.8039ms)
  ÔûÂ Collision & Damage
    Ô£ö collision with OBSTACLE increases damage and plays SFX (16.9264ms)
    Ô£ö collision with FUEL collects item and plays SFX (18.7239ms)
    Ô£ö obstacles are removed when off-screen (16.1971ms)
  Ô£ö Collision & Damage (52.5514ms)
  ÔûÂ Upgrades
    Ô£ö van_armor reduces damage to 2 (17.9985ms)
    Ô£ö van_bullbar reduces damage to 5 (20.2352ms)
    Ô£ö van_armor takes precedence over van_bullbar (23.0827ms)
  Ô£ö Upgrades (62.0243ms)
  ÔûÂ Game Completion
    Ô£ö completes game when target distance reached (21.569ms)
  Ô£ö Game Completion (21.7866ms)
Ô£ö useTourbusLogic (387.046ms)
(node:27232) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useTravelLogic Optimization
  Ô£ö handleTravel remains referentially stable when pendingTravelNode changes (167.9316ms)
Ô£ö useTravelLogic Optimization (169.4938ms)
(node:15624) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useTravelLogic Performance
  Ô£ö handleTravel remains referentially stable when player money changes (185.4146ms)
Ô£ö useTravelLogic Performance (187.4385ms)
(node:30812) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useTravelLogic
  Ô£ö initial state (81.0619ms)
  Ô£ö handleTravel initiates travel when valid (12.2844ms)
  Ô£ö handleTravel prevents travel if insufficient funds (9.497ms)
  Ô£ö handleTravel prevents travel if insufficient fuel (7.6101ms)
  Ô£ö handleTravel to current node triggers interaction (7.1638ms)
  Ô£ö onTravelComplete updates state and finalizes travel (7.5778ms)
  Ô£ö handleRefuel fills tank and deducts money (6.1536ms)
  Ô£ö handleRepair fixes van and deducts money (7.7792ms)
  Ô£ö handleRefuel does nothing when traveling (7.9105ms)
  Ô£ö handleRepair does nothing when traveling (8.4852ms)
Ô£ö useTravelLogic (157.0241ms)
Ô£ö Van Breakdown: Base breakdown chance with no upgrades and perfect condition (0.8967ms)
Ô£ö Van Breakdown: Condition below 60 increases breakdown chance (0.1508ms)
Ô£ö Van Breakdown: Condition below 30 significantly increases breakdown chance (0.1125ms)
Ô£ö Van Breakdown: Upgrades reduce base breakdown chance (0.0897ms)
Ô£ö Van Breakdown: NO COMPOUNDING - Breakdown chance is stable over multiple days with similar condition (0.4403ms)
Ôä╣ tests 931
Ôä╣ suites 127
Ôä╣ pass 925
Ôä╣ fail 6
Ôä╣ cancelled 0
Ôä╣ skipped 0
Ôä╣ todo 0
Ôä╣ duration_ms 59250.767

Ô£û failing tests:

test at tests\audioProcedural.test.js:1:1
Ô£û tests\audioProcedural.test.js (730.9626ms)
  'test failed'

test at tests\audioProceduralMetal.test.js:1:1
Ô£û tests\audioProceduralMetal.test.js (797.3168ms)
  'test failed'

test at tests\audioProceduralPlayNote.test.js:1:1
Ô£û tests\audioProceduralPlayNote.test.js (864.0624ms)
  'test failed'

test at tests\audioProceduralPlaySong.test.js:1:1
Ô£û tests\audioProceduralPlaySong.test.js (797.0323ms)
  'test failed'

test at tests\imageGen.test.js:4:1
Ô£û getGenImageUrl generates correct Pollinations.ai URL (9.7939ms)
  AssertionError [ERR_ASSERTION]: Should not include empty query parameter names
      at TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\imageGen.test.js:27:12)
      at async Test.run (node:internal/test_runner/test:1113:7)
      at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3) {
    generatedMessage: false,
    code: 'ERR_ASSERTION',
    actual: '',
    expected: '',
    operator: '!=',
    diff: 'simple'
  }

test at tests\mainMenuAudio.test.js:1:1
Ô£û tests\mainMenuAudio.test.js (50233.9005ms)
  'test failed'
