
> neurotoxic-game@0.0.0 test:all
> npm run test && npm run test:ui


> neurotoxic-game@0.0.0 test
> node --test --import tsx --experimental-test-module-mocks --import ./tests/setup.mjs

[GameState] Regional reputation loss in Berlin due to poor gig performance (-10) 
ÔûÂ Crisis Management Integration
  ÔûÂ Gap A: Regional Reputation Penalty on Poor Performance
    Ô£ö should deduct 10 regional reputation if gig score is < 30 (5.431ms)
    Ô£ö should NOT deduct regional reputation if gig score is >= 30 (0.4985ms)
  Ô£ö Gap A: Regional Reputation Penalty on Poor Performance (7.1783ms)
  ÔûÂ Gap I & G: Controversy Passive Effects
    Ô£ö should drain more harmony/mood when controversy is >= 50 (0.9828ms)
    Ô£ö should drop sponsor with 20% chance if controversy is >= 80 (0.417ms)
  Ô£ö Gap I & G: Controversy Passive Effects (1.7641ms)
Ô£ö Crisis Management Integration (9.71ms)
(node:5384) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ CrowdManager
  Ô£ö loadAssets loads textures correctly (124.2787ms)
  Ô£ö init creates Sprites when texture is available (62.375ms)
  Ô£ö init creates Graphics when texture is missing (46.3372ms)
  Ô£ö update switches texture to MOSH when combo > 20 (56.8941ms)
  Ô£ö update switches texture to MOSH when toxic mode is on (42.8682ms)
  Ô£ö update handles missing mosh texture gracefully (56.2208ms)
Ô£ö CrowdManager (390.7015ms)
(node:39664) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ EffectManager
  Ô£ö loadAssets loads textures correctly (251.7714ms)
  Ô£ö spawnHitEffect uses blood texture for red colors (51.881ms)
  Ô£ö spawnHitEffect uses toxic texture for non-red colors (43.3362ms)
  Ô£ö spawnHitEffect falls back to generic Sprite if textures missing (80.8248ms)
  Ô£ö update handles lifecycle and cleanup (39.8896ms)
  Ô£ö dispose clears resources and destroys container (17.7406ms)
  Ô£ö spawnHitEffect enforces max active effects limit (50) and recycles (62.6023ms)
  Ô£ö spawnHitEffect reuses sprites from pool (15.4426ms)
  Ô£ö spawnHitEffect removes the oldest effect (lowest life) even if array is unordered (10.9449ms)
Ô£ö EffectManager (576.8839ms)
(node:21524) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ LaneManager
  Ô£ö draws inactive hit bars with translucent lane color fill (55.6679ms)
  Ô£ö draws static lane guide strip for readability (17.5542ms)
  Ô£ö activates hit bars with stronger fill and white border (10.4283ms)
  Ô£ö does not redraw static lanes on first update frame (17.5252ms)
Ô£ö LaneManager (104.2137ms)
(node:39292) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ NoteManager
  Ô£ö acquireSpriteFromPool returns a new sprite if pool is empty (244.1225ms)
  Ô£ö acquireSpriteFromPool reuses a sprite from the pool (23.5554ms)
  Ô£ö createNoteSprite creates a fallback Sprite with WHITE texture if texture is missing (6.4981ms)
  Ô£ö initializeNoteSprite sets properties correctly for fallback sprite (6.9454ms)
  Ô£ö initializeNoteSprite sets correct texture for lightning lane (5.9768ms)
  Ô£ö initializeNoteSprite sets correct texture for skull lane (6.29ms)
  Ô£ö acquireSpriteFromPool reuses a Sprite for fallback (14.3133ms)
  Ô£ö initializeNoteSprite sets jitterOffset property (6.1608ms)
  Ô£ö update spawns notes when time is reached (6.7874ms)
  Ô£ö update positions visible notes (8.4659ms)
  Ô£ö update handles hit notes and calls onHit (11.0942ms)
  Ô£ö dispose clears resources (9.3815ms)
  Ô£ö notesVersion: initial call resets lastNotesVersion from null to 0 (13.5511ms)
  Ô£ö notesVersion: same version on subsequent calls does not reset render index (12.4219ms)
  Ô£ö notesVersion: version change resets render index and destroys existing sprites (10.6302ms)
  Ô£ö notesVersion: dispose resets lastNotesVersion to null (17.601ms)
  Ô£ö releaseSpriteToPool respects MAX_POOL_SIZE (9.6717ms)
Ô£ö NoteManager (416.6125ms)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
(node:7608) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ Pixi Resolution Capping
  Ô£ö getOptimalResolution caps resolution at 2 (5565.6397ms)
  Ô£ö PixiStageController uses capped resolution (21.4898ms)
  Ô£ö TourbusStageController uses capped resolution (27.5901ms)
  Ô£ö RoadieStageController uses capped resolution (16.74ms)
Ô£ö Pixi Resolution Capping (5633.1394ms)
(node:26136) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ PixiStageController
  Ô£ö init initializes managers (201.7925ms)
  Ô£ö handleTicker updates managers (4.637ms)
  Ô£ö dispose disposes managers (4.0981ms)
Ô£ö PixiStageController (212.2158ms)
(node:38876) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ TourbusStageController
  Ô£ö should initialize correctly (93.7121ms)
  Ô£ö should handle asset loading (3.4478ms)
  Ô£ö should run update loop via ticker (3.212ms)
  Ô£ö should render obstacles in ticker (3.3521ms)
  Ô£ö should remove obstacles that disappear from state (2.7186ms)
  Ô£ö should dispose correctly (2.234ms)
Ô£ö TourbusStageController (110.5031ms)
ÔûÂ Action Creators
  ÔûÂ createChangeSceneAction
    Ô£ö should create correct action (1.157ms)
  Ô£ö createChangeSceneAction (2.2259ms)
  ÔûÂ createUpdatePlayerAction
    Ô£ö should create correct action (0.7906ms)
  Ô£ö createUpdatePlayerAction (1.0247ms)
  ÔûÂ createUpdateBandAction
    Ô£ö should create correct action (0.3637ms)
  Ô£ö createUpdateBandAction (0.5761ms)
  ÔûÂ createUpdateSocialAction
    Ô£ö should create correct action (0.3197ms)
  Ô£ö createUpdateSocialAction (0.5244ms)
  ÔûÂ createUpdateSettingsAction
    Ô£ö should create correct action (0.4094ms)
  Ô£ö createUpdateSettingsAction (0.6864ms)
  ÔûÂ createSetMapAction
    Ô£ö should create correct action (0.2582ms)
  Ô£ö createSetMapAction (0.3979ms)
  ÔûÂ createSetGigAction
    Ô£ö should create correct action (0.2278ms)
  Ô£ö createSetGigAction (0.3506ms)
  ÔûÂ createStartGigAction
    Ô£ö should create correct action (0.2584ms)
  Ô£ö createStartGigAction (0.3585ms)
  ÔûÂ createSetSetlistAction
    Ô£ö should create correct action (0.2751ms)
  Ô£ö createSetSetlistAction (0.3775ms)
  ÔûÂ createSetLastGigStatsAction
    Ô£ö should create correct action (3.2096ms)
  Ô£ö createSetLastGigStatsAction (3.4149ms)
  ÔûÂ createSetActiveEventAction
    Ô£ö should create correct action with event (0.6334ms)
    Ô£ö should create correct action with null (0.2373ms)
  Ô£ö createSetActiveEventAction (1.1572ms)
  ÔûÂ createAddToastAction
    Ô£ö should create correct action with default type (0.4275ms)
    Ô£ö should create correct action with custom type (0.1484ms)
  Ô£ö createAddToastAction (0.7114ms)
  ÔûÂ createRemoveToastAction
    Ô£ö should create correct action (0.3717ms)
  Ô£ö createRemoveToastAction (0.4678ms)
  ÔûÂ createSetGigModifiersAction
    Ô£ö should create correct action with object (0.2306ms)
    Ô£ö should create correct action with function (0.1473ms)
  Ô£ö createSetGigModifiersAction (0.5674ms)
  ÔûÂ createLoadGameAction
    Ô£ö should create correct action (0.2658ms)
  Ô£ö createLoadGameAction (0.3531ms)
  ÔûÂ createResetStateAction
    Ô£ö should create correct action (0.2395ms)
  Ô£ö createResetStateAction (0.5667ms)
  ÔûÂ createApplyEventDeltaAction
    Ô£ö should create correct action (0.2296ms)
  Ô£ö createApplyEventDeltaAction (0.3628ms)
  ÔûÂ createPopPendingEventAction
    Ô£ö should create correct action (2.9395ms)
  Ô£ö createPopPendingEventAction (3.1211ms)
  ÔûÂ createConsumeItemAction
    Ô£ö should create correct action (0.338ms)
  Ô£ö createConsumeItemAction (0.4848ms)
  ÔûÂ createAdvanceDayAction
    Ô£ö should create correct action (0.2039ms)
  Ô£ö createAdvanceDayAction (0.31ms)
  ÔûÂ createUnlockTraitAction
    Ô£ö creates correct action (0.7926ms)
  Ô£ö createUnlockTraitAction (0.9273ms)
Ô£ö Action Creators (21.4755ms)
[ArrivalLogic] Starting Gig at destination { venue: 'The Club' }
[ArrivalLogic] Starting Gig at destination { venue: 'The Club' }
[ArrivalLogic] Starting Gig at destination { venue: 'The Club' }
[ArrivalLogic] Starting Gig at destination { venue: 'The Club' }
ÔûÂ handleNodeArrival
  Ô£ö REST_STOP - updates band stamina and mood (2.1654ms)
  Ô£ö START - calls onShowHQ and adds toast (0.4758ms)
[ErrorHandler] Failed to load song {
  name: 'Error',
  message: 'Failed to load song',
  category: 'unknown',
  severity: 'medium',
  context: {},
  recoverable: true,
  timestamp: 1772196873632,
  stack: 'Error: Failed to load song\n' +
    '    at TestContext.<anonymous> (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/tests/arrivalUtils.test.js:147:19)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at Suite.processPendingSubtests (node:internal/test_runner/test:788:18)\n' +
    '    at Test.postRun (node:internal/test_runner/test:1235:19)\n' +
    '    at Test.run (node:internal/test_runner/test:1163:12)\n' +
    '    at async Suite.processPendingSubtests (node:internal/test_runner/test:788:7)'
}
  Ô£ö SPECIAL - triggers event when none active (0.3575ms)
  Ô£ö SPECIAL - does not trigger event when already active (0.2614ms)
  Ô£ö SPECIAL - adds toast if no event triggered (0.2722ms)
  Ô£ö GIG - starts gig if harmony > 0 (5.6279ms)
  Ô£ö GIG - fails to start gig if harmony <= 0 (0.4625ms)
  Ô£ö FESTIVAL - starts gig if harmony > 0 (0.8493ms)
  Ô£ö FESTIVAL - fails to start gig if harmony <= 0 (0.2868ms)
  Ô£ö FINALE - starts gig if harmony > 0 (0.5767ms)
  Ô£ö FINALE - fails to start gig if harmony <= 0 (0.1979ms)
  Ô£ö GIG - handles startGig error (3.8695ms)
Ô£ö handleNodeArrival (17.6543ms)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
[AudioEngine] Audio asset "test-asset.ogg" not found in bundle, falling back to public path: /assets/test-asset.ogg 
[AudioEngine] Audio asset "cached-asset.ogg" not found in bundle, falling back to public path: /assets/cached-asset.ogg 
[AudioEngine] Audio asset "missing.ogg" not found in bundle, falling back to public path: /assets/missing.ogg 
[AudioEngine] Failed to load audio "missing.ogg": HTTP 404 from /assets/missing.ogg 
[AudioEngine] Audio asset "network-error.ogg" not found in bundle, falling back to public path: /assets/network-error.ogg 
[AudioEngine] Failed to decode audio buffer for "network-error.ogg". This browser may not support OGG Vorbis (e.g. Safari/iOS). Consider providing .m4a or .mp3 fallbacks. Error: Network Error
    at <anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:188:13)
    at Object.apply (node:internal/test_runner/mock/mock:757:20)
    at loadAudioBufferInternal (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:171:30)
    at loadAudioBuffer (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:124:19)
    at TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:191:26)
    at Test.runInAsyncScope (node:async_hooks:214:14)
    at Test.run (node:internal/test_runner/test:1106:25)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:186:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Audio asset "bad-audio.ogg" not found in bundle, falling back to public path: /assets/bad-audio.ogg 
[AudioEngine] Failed to decode audio buffer for "bad-audio.ogg". This browser may not support OGG Vorbis (e.g. Safari/iOS). Consider providing .m4a or .mp3 fallbacks. Error: Decode Error
    at Object.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:198:13)
    at Object.apply (node:internal/test_runner/mock/mock:757:20)
    at loadAudioBufferInternal (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:194:20)
    at async loadAudioBuffer (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:128:12)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:201:20)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:195:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Audio asset "timeout.ogg" not found in bundle, falling back to public path: /assets/timeout.ogg 
[AudioEngine] Audio fetch timed out for "timeout.ogg" (/assets/timeout.ogg) 
[AudioEngine] Audio asset "decode-timeout.ogg" not found in bundle, falling back to public path: /assets/decode-timeout.ogg 
[AudioEngine] Decoded audio buffer: "test-asset.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 1 items, 0.00MB 
[AudioEngine] Decoded audio buffer: "cached-asset.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 1 items, 0.00MB 
[AudioEngine] canPlayAudioType check failed, returning false. ReferenceError: Audio is not defined
    at canPlayAudioType (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:66:15)
    at loadAudioBufferInternal (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:241:19)
    at async loadAudioBuffer (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:128:12)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:191:20)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:186:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] canPlayAudioType check failed, returning false. ReferenceError: Audio is not defined
    at canPlayAudioType (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:66:15)
    at loadAudioBufferInternal (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:241:19)
    at async loadAudioBuffer (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/assets.js:128:12)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:201:20)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioAssets.test.js:195:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
(node:25308) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
[AudioEngine] Audio decode timed out for "decode-timeout.ogg" (/assets/decode-timeout.ogg) 
ÔûÂ Audio Assets Loading Logic
  Ô£ö Input Validation: returns null for invalid filenames (21.4625ms)
  Ô£ö Successful Load: fetches, decodes, and returns buffer (4.2455ms)
  Ô£ö Caching: subsequent calls return cached buffer without fetch (3.6317ms)
  Ô£ö Fetch Failure: returns null on 404 (1.0728ms)
  Ô£ö Network Error: returns null on fetch exception (6.1625ms)
  Ô£ö Decode Error: returns null if decoding fails (2.128ms)
  Ô£ö Fetch Timeout: returns null if fetch takes too long (2.2538ms)
  Ô£ö Decode Timeout: returns null if decoding takes too long (39.3955ms)
Ô£ö Audio Assets Loading Logic (86.6745ms)
(node:2136) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ loadAudioBuffer Deduplication Tests
  Ô£ö Deduplicates simultaneous requests for the same file (38.7863ms)
  Ô£ö Processes distinct files independently (45.0688ms)
  Ô£ö Clears pending request after success (91.888ms)
  Ô£ö Clears pending request after failure (0.5834ms)
Ô£ö loadAudioBuffer Deduplication Tests (179.1191ms)
[AudioEngine] Bundled 1 OGG asset(s): path/to/nested.ogg 
(node:5484) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ hasAudioAsset
  Ô£ö returns true for existing asset with full path (1.4206ms)
  Ô£ö returns true for existing asset with basename (0.475ms)
  Ô£ö returns true for existing nested asset with full path (3.0327ms)
  Ô£ö returns true for existing nested asset by basename (if in map) (0.338ms)
  Ô£ö returns true when input has ./ prefix (0.5177ms)
  Ô£ö returns true when input has / prefix (0.4122ms)
  Ô£ö returns true for loose matching by basename even if path is wrong (0.3392ms)
  Ô£ö returns false for non-existent asset (0.2559ms)
  Ô£ö returns false for non-string input (0.2978ms)
  Ô£ö returns false for partial match that is not in map (0.4274ms)
Ô£ö hasAudioAsset (13.2874ms)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
[AudioEngine] Audio asset "small0.ogg" not found in bundle, falling back to public path: /assets/small0.ogg 
[AudioEngine] Audio asset "small1.ogg" not found in bundle, falling back to public path: /assets/small1.ogg 
[AudioEngine] Audio asset "small2.ogg" not found in bundle, falling back to public path: /assets/small2.ogg 
[AudioEngine] Audio asset "small3.ogg" not found in bundle, falling back to public path: /assets/small3.ogg 
[AudioEngine] Audio asset "small4.ogg" not found in bundle, falling back to public path: /assets/small4.ogg 
[AudioEngine] Audio asset "small5.ogg" not found in bundle, falling back to public path: /assets/small5.ogg 
[AudioEngine] Audio asset "small6.ogg" not found in bundle, falling back to public path: /assets/small6.ogg 
[AudioEngine] Audio asset "small7.ogg" not found in bundle, falling back to public path: /assets/small7.ogg 
[AudioEngine] Audio asset "small8.ogg" not found in bundle, falling back to public path: /assets/small8.ogg 
[AudioEngine] Audio asset "small9.ogg" not found in bundle, falling back to public path: /assets/small9.ogg 
[AudioEngine] Audio asset "small10.ogg" not found in bundle, falling back to public path: /assets/small10.ogg 
[AudioEngine] Audio asset "small11.ogg" not found in bundle, falling back to public path: /assets/small11.ogg 
[AudioEngine] Audio asset "small12.ogg" not found in bundle, falling back to public path: /assets/small12.ogg 
[AudioEngine] Audio asset "small13.ogg" not found in bundle, falling back to public path: /assets/small13.ogg 
[AudioEngine] Audio asset "small14.ogg" not found in bundle, falling back to public path: /assets/small14.ogg 
[AudioEngine] Audio asset "small0.ogg" not found in bundle, falling back to public path: /assets/small0.ogg 
[AudioEngine] Audio asset "small1.ogg" not found in bundle, falling back to public path: /assets/small1.ogg 
[AudioEngine] Audio asset "small2.ogg" not found in bundle, falling back to public path: /assets/small2.ogg 
[AudioEngine] Audio asset "small3.ogg" not found in bundle, falling back to public path: /assets/small3.ogg 
[AudioEngine] Audio asset "small4.ogg" not found in bundle, falling back to public path: /assets/small4.ogg 
[AudioEngine] Audio asset "large1.ogg" not found in bundle, falling back to public path: /assets/large1.ogg 
[AudioEngine] Audio asset "large2.ogg" not found in bundle, falling back to public path: /assets/large2.ogg 
[AudioEngine] Audio asset "large3.ogg" not found in bundle, falling back to public path: /assets/large3.ogg 
[AudioEngine] Audio asset "large1.ogg" not found in bundle, falling back to public path: /assets/large1.ogg 
[AudioEngine] Audio asset "huge.ogg" not found in bundle, falling back to public path: /assets/huge.ogg 
[AudioEngine] Audio asset "small.ogg" not found in bundle, falling back to public path: /assets/small.ogg 
[AudioEngine] Audio asset "huge.ogg" not found in bundle, falling back to public path: /assets/huge.ogg 
[AudioEngine] Audio asset "file0.ogg" not found in bundle, falling back to public path: /assets/file0.ogg 
[AudioEngine] Audio asset "file1.ogg" not found in bundle, falling back to public path: /assets/file1.ogg 
[AudioEngine] Audio asset "file2.ogg" not found in bundle, falling back to public path: /assets/file2.ogg 
[AudioEngine] Audio asset "file3.ogg" not found in bundle, falling back to public path: /assets/file3.ogg 
[AudioEngine] Audio asset "file4.ogg" not found in bundle, falling back to public path: /assets/file4.ogg 
[AudioEngine] Audio asset "file5.ogg" not found in bundle, falling back to public path: /assets/file5.ogg 
[AudioEngine] Audio asset "file6.ogg" not found in bundle, falling back to public path: /assets/file6.ogg 
[AudioEngine] Audio asset "file7.ogg" not found in bundle, falling back to public path: /assets/file7.ogg 
[AudioEngine] Audio asset "file8.ogg" not found in bundle, falling back to public path: /assets/file8.ogg 
[AudioEngine] Audio asset "file9.ogg" not found in bundle, falling back to public path: /assets/file9.ogg 
[AudioEngine] Audio asset "file10.ogg" not found in bundle, falling back to public path: /assets/file10.ogg 
[AudioEngine] Audio asset "file1.ogg" not found in bundle, falling back to public path: /assets/file1.ogg 
(node:13660) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
[AudioEngine] Decoded audio buffer: "small0.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 1 items, 0.00MB 
[AudioEngine] Decoded audio buffer: "small1.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 2 items, 0.00MB 
[AudioEngine] Decoded audio buffer: "small2.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 3 items, 0.01MB 
[AudioEngine] Decoded audio buffer: "small3.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 4 items, 0.01MB 
[AudioEngine] Decoded audio buffer: "small4.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 5 items, 0.01MB 
[AudioEngine] Decoded audio buffer: "small5.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 6 items, 0.01MB 
[AudioEngine] Decoded audio buffer: "small6.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 7 items, 0.01MB 
[AudioEngine] Decoded audio buffer: "small7.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 8 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "small8.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 9 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "small9.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "small10.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "small11.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "small12.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "small13.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "small14.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "small0.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "small1.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "small2.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "small3.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "small4.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "large1.ogg" (29.7s, 44100Hz, 20.00MB). Cache: 1 items, 20.00MB 
[AudioEngine] Decoded audio buffer: "large2.ogg" (29.7s, 44100Hz, 20.00MB). Cache: 2 items, 40.00MB 
[AudioEngine] Decoded audio buffer: "large3.ogg" (29.7s, 44100Hz, 20.00MB). Cache: 2 items, 40.00MB 
[AudioEngine] Decoded audio buffer: "large1.ogg" (29.7s, 44100Hz, 20.00MB). Cache: 2 items, 40.00MB 
[AudioEngine] Decoded audio buffer: "huge.ogg" (89.2s, 44100Hz, 60.00MB). Cache: 1 items, 60.00MB 
[AudioEngine] Decoded audio buffer: "small.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 1 items, 0.00MB 
[AudioEngine] Decoded audio buffer: "huge.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 2 items, 0.00MB 
[AudioEngine] Decoded audio buffer: "file0.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 1 items, 0.00MB 
[AudioEngine] Decoded audio buffer: "file1.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 2 items, 0.00MB 
[AudioEngine] Decoded audio buffer: "file2.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 3 items, 0.01MB 
[AudioEngine] Decoded audio buffer: "file3.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 4 items, 0.01MB 
[AudioEngine] Decoded audio buffer: "file4.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 5 items, 0.01MB 
[AudioEngine] Decoded audio buffer: "file5.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 6 items, 0.01MB 
[AudioEngine] Decoded audio buffer: "file6.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 7 items, 0.01MB 
[AudioEngine] Decoded audio buffer: "file7.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 8 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "file8.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 9 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "file9.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "file10.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
[AudioEngine] Decoded audio buffer: "file1.ogg" (0.0s, 44100Hz, 0.00MB). Cache: 10 items, 0.02MB 
ÔûÂ audioBufferCache optimization
  Ô£ö respects MAX_AUDIO_BUFFER_CACHE_SIZE (10 items) (12.8561ms)
  Ô£ö respects MAX_AUDIO_BUFFER_BYTE_SIZE (50MB) (2.1131ms)
  Ô£ö always keeps at least one item even if it exceeds byte limit (1.1802ms)
  Ô£ö LRU behavior preserved with item limit (5.8983ms)
Ô£ö audioBufferCache optimization (28.8483ms)
(node:7184) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ clearTransportEvent
  Ô£ö returns early if id is null (1.9083ms)
  Ô£ö returns early if id is undefined (0.5925ms)
  Ô£ö calls transport clear if id is provided (0.4653ms)
  Ô£ö handles errors and logs warning (6.5727ms)
Ô£ö clearTransportEvent (12.4739ms)
ÔûÂ stopAndDisconnectSource
  Ô£ö returns early if source is null (0.5435ms)
  Ô£ö returns early if source is undefined (0.3321ms)
  Ô£ö calls stop and disconnect on source (0.3974ms)
  Ô£ö handles stop error and logs debug (0.4941ms)
  Ô£ö handles disconnect error and logs debug (0.5348ms)
  Ô£ö handles both stop and disconnect errors (0.4649ms)
  Ô£ö handles invalid source object (no methods) (0.4149ms)
Ô£ö stopAndDisconnectSource (7.0461ms)
ÔûÂ stopTransportAndClear
  Ô£ö stops transport and resets position (0.8857ms)
  Ô£ö cleans up loop and part (0.772ms)
  Ô£ö cleans up midiParts (0.4009ms)
  Ô£ö handles already null loop and part (0.3022ms)
Ô£ö stopTransportAndClear (3.5384ms)
ÔûÂ cleanupGigPlayback
  Ô£ö cleans up gigSource if present (0.3578ms)
  Ô£ö calls resetGigState even if gigSource is null (0.2916ms)
Ô£ö cleanupGigPlayback (1.12ms)
ÔûÂ cleanupAmbientPlayback
  Ô£ö cleans up ambientSource if present (1.1195ms)
  Ô£ö does nothing if ambientSource is null (0.3276ms)
Ô£ö cleanupAmbientPlayback (2.2062ms)
ÔûÂ cleanupTransportEvents
  Ô£ö clears transport events and resets IDs (0.6826ms)
  Ô£ö handles null IDs gracefully (1.1462ms)
Ô£ö cleanupTransportEvents (2.5562ms)
Ô£ö getPreferredAudioContextState prefers raw context state (1.1487ms)
Ô£ö getPreferredAudioContextState falls back to tone context state (0.2168ms)
Ô£ö getPreferredAudioContextState returns unknown when no state exists (0.1785ms)
Ô£ö canResumeAudioContextState only allows resumable states (0.2009ms)
Ô£ö isClosedAudioContextState only matches closed state (0.2139ms)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
[AudioEngine] Node disposal failed (likely benign) Error: Dispose failed
    at MockPolySynth.MockPolySynth.dispose (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:12:11)
    at safeDispose (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:25:12)
    at disposeAudio (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:115:23)
    at TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:41:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Node disposal failed (likely benign) Error: Dispose failed
    at MockPolySynth.MockPolySynth.dispose (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:12:11)
    at safeDispose (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:25:12)
    at disposeAudio (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:116:21)
    at TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:41:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Node disposal failed (likely benign) Error: Dispose failed
    at MockPolySynth.MockPolySynth.dispose (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:12:11)
    at safeDispose (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:25:12)
    at disposeAudio (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:126:25)
    at TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:41:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Node disposal failed (likely benign) Error: Dispose failed
    at MockPolySynth.MockPolySynth.dispose (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:12:11)
    at safeDispose (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:25:12)
    at disposeAudio (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:129:25)
    at TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:41:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
[AudioEngine] Node disposal failed (likely benign) Error: Dispose failed
    at MockPolySynth.MockPolySynth.dispose (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:12:11)
    at safeDispose (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:25:12)
    at disposeAudio (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/setup.js:130:25)
    at TestContext.<anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioEngineDispose.test.js:41:3)
    at async Test.run (node:internal/test_runner/test:1113:7)
    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)
Ô£ö disposeAudio logs error when dispose fails (30.3586ms)
(node:21252) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
ÔûÂ calculateGigTimeMs
  Ô£ö calculates gig time with valid context times (1.0626ms)
  Ô£ö returns offset when start time is invalid (0.208ms)
  Ô£ö defaults to zero for invalid offset (0.1919ms)
Ô£ö calculateGigTimeMs (3.0791ms)
ÔûÂ hasAudioAsset
  Ô£ö returns false for non-string input (0.2316ms)
  Ô£ö returns false for unknown filename (0.2261ms)
Ô£ö hasAudioAsset (0.9537ms)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
ÔûÂ calculateGigPlaybackWindow
  Ô£ö Happy Path: valid inputs within buffer range (2.5194ms)
  Ô£ö Clamps duration to remaining buffer (0.4962ms)
  Ô£ö Resets offsets when they exceed buffer duration (0.2884ms)
  Ô£ö Resets offsets when exactly at buffer duration (0.266ms)
  Ô£ö Handles null duration (play to end) (0.2129ms)
  Ô£ö Handles zero duration request (0.2165ms)
  Ô£ö Handles zero buffer duration (0.1855ms)
  Ô£ö Handles negative inputs (clamps to 0) (0.2165ms)
  Ô£ö Handles NaN inputs (treats as 0) (0.6769ms)
  Ô£ö Handles Infinity inputs (treats as 0) (0.469ms)
  Ô£ö Handles null/undefined inputs explicitly (0.3382ms)
  Ô£ö Complex scenario: Seek + Base offset near end (0.2538ms)
Ô£ö calculateGigPlaybackWindow (11.0077ms)
[AudioEngine] No OGG assets bundled. Gig audio will fall back to MIDI playback. 
(node:4604) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ setupAudio
  Ô£ö completes successfully (3.3613ms)
  Ô£ö handles concurrent calls (1.1448ms)
  Ô£ö propagates errors to concurrent calls (1.8668ms)
Ô£ö setupAudio (8.7614ms)
[AudioSystem] stopMusic called (was playing: nothing). 
[AudioSystem] Ambient started via OGG buffer playback. 
(node:7260) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ AudioManager Tests
  Ô£ö initializes with default values (0.9337ms)
  Ô£ö setMusicVolume updates volume and calls engine (0.617ms)
  Ô£ö toggleMute updates mute state (0.3939ms)
  Ô£ö resumeMusic resumes paused transport via engine facade (0.4878ms)
  Ô£ö startAmbient calls playRandomAmbientOgg (7.6084ms)
Ô£ö AudioManager Tests (58.4957ms)
[audioEngine] Asset basename conflict for "song.ogg". Keeping "/assets/audio/song.ogg" and ignoring "/assets/sfx/song.ogg".
ÔûÂ normalizeMidiPlaybackOptions
  Ô£ö uses defaults when options are undefined (2.2452ms)
  Ô£ö respects explicit clean playback flag (0.311ms)
  Ô£ö accepts a valid onEnded callback (0.2256ms)
  Ô£ö normalizes stopAfterSeconds (0.2942ms)
  Ô£ö accepts a startTimeSec override (0.293ms)
Ô£ö normalizeMidiPlaybackOptions (5.5663ms)
ÔûÂ encodePublicAssetPath
  Ô£ö encodes spaces and preserves slashes (0.4569ms)
  Ô£ö handles leading slashes (1.607ms)
  Ô£ö returns empty string for invalid input (0.5597ms)
  Ô£ö encodes special characters safely (0.3002ms)
Ô£ö encodePublicAssetPath (3.9638ms)
ÔûÂ resolveAssetUrl
  ÔûÂ MIDI assets
    Ô£ö prefers bundled URLs (0.4085ms)
    Ô£ö resolves bundled URLs via basename (0.2587ms)
    Ô£ö falls back to public path when missing (0.2601ms)
    Ô£ö normalizes relative filenames and encodes spaces (1.238ms)
    Ô£ö supports custom public base path (0.199ms)
    Ô£ö supports relative base path defaults (0.1776ms)
    Ô£ö returns nulls for empty filename (0.1323ms)
  Ô£ö MIDI assets (3.797ms)
  ÔûÂ non-MIDI assets
    Ô£ö resolves bundled URLs for non-MIDI assets (0.2203ms)
    Ô£ö resolves via basename for nested paths (0.1315ms)
    Ô£ö falls back to public path for missing assets (0.1741ms)
  Ô£ö non-MIDI assets (0.9259ms)
Ô£ö resolveAssetUrl (5.1843ms)
ÔûÂ buildAssetUrlMap
  Ô£ö stores relative paths and basenames (0.3286ms)
  Ô£ö warns on basename conflicts and keeps first entry (0.4873ms)
Ô£ö buildAssetUrlMap (1.233ms)
ÔûÂ buildAssetUrlMap OGG key filtering
  Ô£ö full paths and basenames are both stored for OGG assets (0.2533ms)
  Ô£ö full paths with subdirectories are distinguishable from basenames (1.3149ms)
  Ô£ö path-containing keys can be filtered from basename-only keys (0.4589ms)
  Ô£ö root-level assets have no slash in key (0.2472ms)
Ô£ö buildAssetUrlMap OGG key filtering (3.3606ms)
ÔûÂ buildAssetUrlMap supports MIDI labeling
  Ô£ö stores relative paths and basenames (0.2571ms)
  Ô£ö warns on basename conflicts and keeps first entry (0.3948ms)
Ô£ö buildAssetUrlMap supports MIDI labeling (1.0457ms)
(node:32452) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ playMidiFile Tests
  Ô£ö Happy Path: Successfully plays a valid MIDI file (3.6239ms)
  Ô£ö Fetch Failure: Returns false if MIDI file not found (0.9547ms)
  Ô£ö AudioContext Locked: Returns false if context not ensured (0.5427ms)
  Ô£ö Race Condition: Aborts if playRequestId changes during fetch (0.8774ms)
  Ô£ö Looping: Sets Transport loop parameters (0.9341ms)
  Ô£ö Offset: Passes offset to Transport.start (0.7598ms)
  Ô£ö Invalid MIDI Duration: Returns false if duration is 0 (0.5906ms)
  Ô£ö Options: stopAfterSeconds schedules stop (0.956ms)
Ô£ö playMidiFile Tests (13.1464ms)
file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/proceduralMetal.js:3
import { prepareTransportPlayback } from './playbackUtils.js'
         ^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: The requested module './playbackUtils.js' does not provide an export named 'prepareTransportPlayback'
    at #asyncInstantiate (node:internal/modules/esm/module_job:302:21)
    at async ModuleJob.run (node:internal/modules/esm/module_job:405:5)
    at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:660:26)
    at async <anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioProceduralMetal.test.js:180:3)

Node.js v24.13.0
Ô£û tests\audioProceduralMetal.test.js (882.644ms)
(node:22196) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ playNoteAtTime Tests
  Ô£ö Guitar: Uses getNoteName instead of Tone.Frequency (1.7751ms)
  Ô£ö Bass: Uses getNoteName instead of Tone.Frequency (0.4996ms)
  Ô£ö Drums: Kick (MIDI 36) (0.5656ms)
  Ô£ö Drums: Snare (MIDI 38) (0.4297ms)
  Ô£ö Drums: HiHat (MIDI 42) (0.4645ms)
Ô£ö playNoteAtTime Tests (6.6328ms)
file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/audio/playback.js:6
  getRawAudioContext,
  ^^^^^^^^^^^^^^^^^^
SyntaxError: The requested module './setup.js' does not provide an export named 'getRawAudioContext'
    at #asyncInstantiate (node:internal/modules/esm/module_job:302:21)
    at async ModuleJob.run (node:internal/modules/esm/module_job:405:5)
    at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:660:26)
    at async <anonymous> (C:\Users\andre.oswald\Code\Neuro\neurotoxic-game\tests\audioProceduralPlaySong.test.js:142:30)

Node.js v24.13.0
Ô£û tests\audioProceduralPlaySong.test.js (1372.8232ms)
ÔûÂ selectRandomItem
  Ô£ö returns null for invalid or empty inputs (0.9784ms)
  Ô£ö returns a stable item with deterministic rng (0.3272ms)
  Ô£ö clamps rng values to valid indices (0.2839ms)
Ô£ö selectRandomItem (3.4604ms)
ÔûÂ getScheduledHitTimeMs
  Ô£ö schedules within lead window (0.9978ms)
  Ô£ö fires immediately when outside lead window (0.3439ms)
  Ô£ö handles clock offsets between gig and audio time (0.232ms)
Ô£ö getScheduledHitTimeMs (3.4063ms)
Ô£ö getRandomChatter supports default chatter in all top-level scenes (6.3704ms)
Ô£ö disallowed scenes are not in ALLOWED_DEFAULT_SCENES (0.3435ms)
Ô£ö harmony chatter fires when band.harmony is low (0.4421ms)
Ô£ö harmony chatter fires when band.harmony is high (1.5395ms)
Ô£ö van chatter fires when fuel is low (0.6452ms)
Ô£ö van chatter fires when condition is critical (0.4514ms)
Ô£ö tour progression chatter fires for late tour (0.543ms)
Ô£ö tour progression chatter fires for early tour (0.6509ms)
Ô£ö fame chatter fires when fameLevel >= 2 (0.4608ms)
Ô£ö fame chatter fires when fame is low (0.4735ms)
Ô£ö inventory chatter fires when strings are missing (0.3578ms)
Ô£ö inventory chatter fires for golden pick (0.2766ms)
Ô£ö gig modifier chatter fires when catering is booked (0.288ms)
Ô£ö gig modifier chatter fires when nothing is booked (0.3207ms)
Ô£ö luck chatter fires when luck is high (0.2778ms)
Ô£ö luck chatter fires when luck is negative (0.2704ms)
(node:30708) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
Ô£ö getRandomChatter returns null when pool is empty (2.4708ms)
Ô£ö getRandomChatter returns venue-specific chatter (1.6884ms)
Ô£ö getRandomChatter falls back to ANY venue chatter (0.5742ms)
Ô£ö getRandomChatter supports legacy lines format (0.3976ms)
Ô£ö getRandomChatter includes standard chatter when conditions met (0.3456ms)
Ô£ö getRandomChatter implements weighted random selection (0.398ms)
ÔûÂ secureRandom
  Ô£ö should use crypto.getRandomValues when available (1.9482ms)
  Ô£ö should return 0 when random value is 0 (0.7045ms)
  Ô£ö should return correct value for max uint32 (0.6794ms)
  Ô£ö should fallback to Math.random when crypto is undefined (0.5759ms)
  Ô£ö should fallback to Math.random when getRandomValues is missing (0.508ms)
Ô£ö secureRandom (6.3151ms)
Ô£ö CHARACTERS data integrity (2.6497ms)
Ô£ö SONGS_DB data integrity (0.4983ms)
Ô£ö SONGS_DB sourceOgg field (0.5609ms)
Ô£ö ALL_VENUES data integrity (0.2612ms)
Ô£ö EVENTS_DB integrity (1.6344ms)
[EventValidation] Event missing ID in transport { category: 'transport', description: 'Missing ID' }
[EventValidation] Duplicate Event ID in transport: valid_event 
(node:25852) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
Ô£ö Event validation filters out invalid events (1.2655ms)
Ô£ö tests\drumMappings.test.js (1353.5608ms)
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2359, income: 2937, expenses: 578 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 10 }
[Economy] Gig Report Generated { net: 1097, income: 1247, expenses: 150 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 1000 }
[Economy] Gig Report Generated { net: 2040, income: 2550, expenses: 510 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 50 }
[Economy] Gig Report Generated { net: 1788, income: 2167, expenses: 379 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 50 }
[Economy] Gig Report Generated { net: 2275, income: 2864, expenses: 589 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 50 }
[Economy] Gig Report Generated { net: 1359, income: 1569, expenses: 210 }
[Economy] Calculating Gig Financials { gig: undefined, score: 40, fame: 100 }
[Economy] Gig Report Generated { net: 2359, income: 2987, expenses: 628 }
[Economy] Calculating Gig Financials { gig: undefined, score: 95, fame: 100 }
[Economy] Gig Report Generated { net: 2764, income: 3662, expenses: 898 }
[Economy] Calculating Gig Financials { gig: undefined, score: 95, fame: 100 }
[Economy] Gig Report Generated { net: 2764, income: 3662, expenses: 898 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2479, income: 3187, expenses: 708 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 1979, income: 2487, expenses: 508 }
[Economy] Calculating Gig Financials { gig: undefined, score: 90, fame: 200 }
[Economy] Gig Report Generated { net: 2748, income: 3267, expenses: 519 }
[Economy] Calculating Gig Financials { gig: undefined, score: 100, fame: 200 }
[Economy] Gig Report Generated { net: 2956, income: 3938, expenses: 982 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2359, income: 2937, expenses: 578 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2359, income: 2937, expenses: 578 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2339, income: 2937, expenses: 598 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2479, income: 3187, expenses: 708 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 700, income: 700, expenses: 0 }
[Economy] Calculating Gig Financials { gig: undefined, score: 0, fame: 100 }
[Economy] Gig Report Generated { net: 2029, income: 2387, expenses: 358 }
[Economy] Calculating Gig Financials { gig: undefined, score: 100, fame: 100 }
[Economy] Gig Report Generated { net: 2674, income: 3462, expenses: 788 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2359, income: 2937, expenses: 578 }
[Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
[Economy] Gig Report Generated { net: 2479, income: 3187, expenses: 708 }
[Economy] Calculating Gig Financials { gig: undefined, score: 75, fame: 150 }
[Economy] Gig Report Generated { net: 2425, income: 3025, expenses: 600 }
[Economy] Calculating Gig Financials { gig: undefined, score: 85, fame: 5000 }
[Economy] Gig Report Generated { net: 19475, income: 25075, expenses: 5600 }
[Economy] Calculating Gig Financials { gig: undefined, score: 100, fame: 100 }
[Economy] Gig Report Generated { net: 2244, income: 2898, expenses: 654 }
[Economy] Calculating Gig Financials { gig: undefined, score: 100, fame: 100 }
[Economy] Gig Report Generated { net: 2601, income: 3515, expenses: 914 }
Ô£ö calculateGigFinancials handles base case with ticket sales and guarantee (6.1129ms)
Ô£ö calculateGigFinancials applies fame scaling to fill rate (1.2417ms)
Ô£ö calculateGigFinancials applies promo boost to fill rate (1.1959ms)
Ô£ö calculateGigFinancials applies price sensitivity penalty (0.5785ms)
Ô£ö calculateGigFinancials scales merch sales with performance (2.4653ms)
Ô£ö calculateGigFinancials applies S-rank merch bonus (0.6647ms)
Ô£ö calculateGigFinancials penalizes merch sales for misses (0.8773ms)
Ô£ö calculateGigFinancials handles sold out merch gracefully (0.3619ms)
Ô£ö calculateGigFinancials uses all inventory types for sales limit (0.5009ms)
Ô£ö calculateGigFinancials no longer includes transport/food in gig report (handled via Travel phase) (0.4276ms)
Ô£ö calculateGigFinancials includes catering when enabled (7.7771ms)
Ô£ö calculateGigFinancials supports new merch key (0.499ms)
Ô£ö calculateGigFinancials handles zero capacity venue (0.5803ms)
Ô£ö calculateGigFinancials handles extreme performance scores (0.6849ms)
Ô£ö calculateGigFinancials merch table modifier increases sales (0.621ms)
Ô£ö EXPENSE_CONSTANTS are properly defined (0.1946ms)
Ô£ö calculateGigFinancials net profit matches income minus expenses (0.4496ms)
Ô£ö calculateGigFinancials handles high fame with high price (0.651ms)
Ô£ö calculateTravelExpenses returns correct cost structure (0.6373ms)
Ô£ö calculateTravelExpenses computes distance consistently across node coordinates (0.2073ms)
Ô£ö calculateFuelCost applies van tuning upgrade (0.162ms)
Ô£ö calculateRefuelCost calculates correctly (0.1538ms)
Ô£ö calculateRepairCost calculates correctly (0.1288ms)
Ô£ö calculateFuelCost applies road_warrior trait discount (0.2349ms)
ÔûÂ calculateEffectiveTicketPrice handles discounts correctly
  Ô£ö returns 0 if no gig data (0.2299ms)
  Ô£ö returns original price if not discounted (0.2247ms)
  Ô£ö returns original price if price <= 10 (0.1412ms)
  Ô£ö applies 50% discount if price > 10 and discountedTickets is true (0.1318ms)
Ô£ö calculateEffectiveTicketPrice handles discounts correctly (1.8705ms)
Ô£ö calculateGigFinancials uses effective price (0.7397ms)
ÔûÂ Minigame Economy Calculations
  Ô£ö Travel Minigame Results (0.9915ms)
  Ô£ö Travel Minigame Edge Cases (0.3191ms)
  Ô£ö Roadie Minigame Results (0.3596ms)
  Ô£ö Roadie Minigame Edge Cases (0.2621ms)
Ô£ö Minigame Economy Calculations (3.9666ms)
[ErrorHandler] Test error {
  name: 'StateError',
  message: 'Test error',
  category: 'state',
  severity: 'high',
  context: {},
  recoverable: true,
  timestamp: 1772196875695,
  stack: 'StateError: Test error\n' +
    '    at TestContext.<anonymous> (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/tests/errorHandler.test.js:76:19)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at Test.start (node:internal/test_runner/test:1003:17)\n' +
    '    at node:internal/test_runner/test:1516:71\n' +
    '    at node:internal/per_context/primordials:466:82\n' +
    '    at new Promise (<anonymous>)\n' +
    '    at new SafePromise (node:internal/per_context/primordials:435:3)\n' +
    '    at node:internal/per_context/primordials:466:9\n' +
    '    at Array.map (<anonymous>)'
}
[ErrorHandler] Test error {
  name: 'StateError',
  message: 'Test error',
  category: 'state',
  severity: 'high',
  context: {},
  recoverable: true,
  timestamp: 1772196875703,
  stack: 'StateError: Test error\n' +
    '    at TestContext.<anonymous> (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/tests/errorHandler.test.js:90:19)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at Suite.processPendingSubtests (node:internal/test_runner/test:788:18)\n' +
    '    at Test.postRun (node:internal/test_runner/test:1235:19)\n' +
    '    at Test.run (node:internal/test_runner/test:1163:12)\n' +
    '    at async Promise.all (index 0)\n' +
    '    at async Suite.run (node:internal/test_runner/test:1518:7)\n' +
    '    at async Test.processPendingSubtests (node:internal/test_runner/test:788:7)'
}
[ErrorHandler] Fallback {
  name: 'Error',
  message: 'Fallback',
  category: 'unknown',
  severity: 'medium',
  context: {},
  recoverable: true,
  timestamp: 1772196875705,
  stack: 'Error\n' +
    '    at TestContext.<anonymous> (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/tests/errorHandler.test.js:97:19)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at Suite.processPendingSubtests (node:internal/test_runner/test:788:18)\n' +
    '    at Test.postRun (node:internal/test_runner/test:1235:19)\n' +
    '    at Test.run (node:internal/test_runner/test:1163:12)\n' +
    '    at async Suite.processPendingSubtests (node:internal/test_runner/test:788:7)'
}
[ErrorHandler] Audio asset not found for "01 Kranker Schrank": looked up "01 Kranker Schrank.ogg" {
  name: 'AudioError',
  message: 'Audio asset not found for "01 Kranker Schrank": looked up "01 Kranker Schrank.ogg"',
  category: 'audio',
  severity: 'medium',
  context: {
    songName: '01 Kranker Schrank',
    oggFilename: '01 Kranker Schrank.ogg'
  },
  recoverable: true,
  timestamp: 1772196875706,
  stack: 'AudioError: Audio asset not found for "01 Kranker Schrank": looked up "01 Kranker Schrank.ogg"\n' +
    '    at TestContext.<anonymous> (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/tests/errorHandler.test.js:112:19)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at Suite.processPendingSubtests (node:internal/test_runner/test:788:18)\n' +
    '    at Test.postRun (node:internal/test_runner/test:1235:19)\n' +
    '    at Test.run (node:internal/test_runner/test:1163:12)\n' +
    '    at async Suite.processPendingSubtests (node:internal/test_runner/test:788:7)'
}
[ErrorHandler] Storage operation failed: test {
  name: 'StorageError',
  message: 'Storage operation failed: test',
  category: 'storage',
  severity: 'medium',
  context: { originalError: 'Storage error' },
  recoverable: true,
  timestamp: 1772196875707,
  stack: 'StorageError: Storage operation failed: test\n' +
    '    at safeStorageOperation (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/errorHandler.js:197:7)\n' +
    '    at TestContext.<anonymous> (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/tests/errorHandler.test.js:135:20)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at Suite.processPendingSubtests (node:internal/test_runner/test:788:18)\n' +
    '    at Test.postRun (node:internal/test_runner/test:1235:19)\n' +
    '    at Test.run (node:internal/test_runner/test:1163:12)\n' +
    '    at async Promise.all (index 0)\n' +
    '    at async Suite.run (node:internal/test_runner/test:1518:7)\n' +
    '    at async Test.processPendingSubtests (node:internal/test_runner/test:788:7)'
}
ÔûÂ Custom Error Classes
  ÔûÂ StateError
    Ô£ö should have correct name (1.4786ms)
  Ô£ö StateError (2.5409ms)
  ÔûÂ StorageError
    Ô£ö should have correct name (0.4279ms)
  Ô£ö StorageError (0.7061ms)
  ÔûÂ AudioError
    Ô£ö should have correct name and category (0.6497ms)
    Ô£ö should store context for missing OGG asset diagnostics (0.2774ms)
    Ô£ö should produce a complete log object via toLogObject (1.8175ms)
  Ô£ö AudioError (3.5539ms)
Ô£ö Custom Error Classes (8.1037ms)
ÔûÂ handleError
  Ô£ö should call addToast when not silent (7.1944ms)
  Ô£ö should not call addToast when silent (2.2371ms)
  Ô£ö should use fallback message for errors without message (0.6167ms)
  Ô£ö should handle AudioError with silent mode and preserve context (0.6297ms)
Ô£ö handleError (12.3661ms)
ÔûÂ safeStorageOperation
  Ô£ö should return result on success (0.3374ms)
  Ô£ö should return fallback on error (0.6494ms)
Ô£ö safeStorageOperation (1.115ms)
(node:6036) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
Ô£ö eventEngine.filterEvents filters by trigger (2.3071ms)
Ô£ö eventEngine.filterEvents respects conditions (0.4711ms)
Ô£ö eventEngine.selectEvent respects cooldowns (1.0319ms)
Ô£ö eventEngine.selectEvent prioritizes pending events (0.3341ms)
Ô£ö eventEngine.resolveChoice handles simple effects (0.5992ms)
Ô£ö eventEngine.resolveChoice handles skill checks (success) (0.4045ms)
Ô£ö eventEngine.resolveChoice handles skill checks (failure) (0.345ms)
Ô£ö eventEngine.resolveChoice handles luck checks (0.2578ms)
Ô£ö eventEngine.resolveChoice sets nextEventId (1.6144ms)
Ô£ö eventEngine.processOptions returns event when no processing needed (0.5263ms)
Ô£ö eventEngine.processOptions handles van_breakdown with spare_tire (0.3445ms)
Ô£ö eventEngine.processOptions does not add spare tire option without inventory (0.2405ms)
Ô£ö eventEngine.applyResult handles resource effects (0.5171ms)
Ô£ö eventEngine.applyResult handles stat effects (0.219ms)
Ô£ö eventEngine.applyResult handles harmony stat (0.1331ms)
Ô£ö eventEngine.applyResult handles mood changes (0.1313ms)
Ô£ö eventEngine.applyResult handles stamina changes (0.112ms)
Ô£ö eventEngine.applyResult handles combined mood and stamina in composite (0.1462ms)
Ô£ö eventEngine.applyResult handles van fuel (0.1319ms)
Ô£ö eventEngine.applyResult handles van condition stat (0.2199ms)
Ô£ö eventEngine.applyResult clamps van condition to 0-100 range (0.3001ms)
Ô£ö eventEngine.applyResult handles game over flag (0.1816ms)
Ô£ö eventEngine.applyResult handles story flags (0.1524ms)
Ô£ö eventEngine.applyResult handles chain events (0.1278ms)
Ô£ö eventEngine.applyResult handles composite effects (0.1566ms)
Ô£ö eventEngine.applyResult returns null for null result (0.1069ms)
Ô£ö eventEngine.applyResult handles unlock effects (0.1261ms)
Ô£ö eventEngine.applyResult preserves nextEventId from result (0.146ms)
Ô£ö eventEngine.applyResult handles time stat (0.1323ms)
Ô£ö eventEngine.applyResult handles viral stat (0.2051ms)
Ô£ö eventEngine.applyResult handles inventory numeric increment (0.1476ms)
Ô£ö eventEngine.applyResult handles inventory non-numeric value (0.1921ms)
Ô£ö eventEngine.applyResult accumulates inventory values across composite effects (0.1771ms)
Ô£ö eventEngine logic allows negative inventory in delta (0.1198ms)
Ô£ö eventEngine.applyResult handles hype stat as fame (0.1045ms)
Ô£ö eventEngine.applyResult handles crowd_energy stat as fame (0.1564ms)
Ô£ö eventEngine.applyResult handles score stat increment (0.1803ms)
Ô£ö eventEngine.applyResult accumulates fame from mixed stats (fame, hype, crowd_energy) (0.1571ms)
Ô£ö eventEngine.selectEvent handles condition errors gracefully (0.5071ms)
Ô£ö resolveEventChoice returns delta for direct effects (2.0371ms)
Ô£ö resolveEventChoice handles missing choices safely (0.2811ms)
Ô£ö resolveEventChoice appends SAVED_BY_BANDLEADER string on successful bandleader save (2.2525ms)
[Economy] Calculating Gig Financials { gig: undefined, score: 30, fame: 100 }
[Economy] Gig Report Generated { net: 1829, income: 2237, expenses: 408 }
[Economy] Calculating Gig Financials { gig: undefined, score: 95, fame: 100 }
[Economy] Gig Report Generated { net: 2914, income: 3812, expenses: 898 }
[Economy] Calculating Gig Financials { gig: undefined, score: 70, fame: 100 }
[Economy] Gig Report Generated { net: 2329, income: 2887, expenses: 558 }
[Economy] Calculating Gig Financials { gig: undefined, score: 70, fame: 100 }
[Economy] Gig Report Generated { net: 2449, income: 3137, expenses: 688 }
[GameState] Update Player { money: -100 }
[GameState] Update Band { harmony: -50 }
[GameState] Update Band { harmony: 200 }
[GameState] Day Advanced to 2 
Ô£ö calculateDailyUpdates: daily cost includes band size scaling (9.5333ms)
Ô£ö calculateDailyUpdates: money never goes negative (0.6548ms)
Ô£ö calculateDailyUpdates: van condition decays daily (0.4244ms)
Ô£ö calculateDailyUpdates: van breakdown chance increases when condition is low (0.396ms)
Ô£ö calculateDailyUpdates: van condition does not go below 0 (0.9448ms)
Ô£ö calculateDailyUpdates: harmony is clamped to [1, 100] (0.3355ms)
Ô£ö calculateDailyUpdates: harmony clamped even with regen active (0.2897ms)
Ô£ö calculateGigFinancials: low performance penalizes merch (5.7456ms)
Ô£ö calculateGigFinancials: merch table modifier increases merch revenue (1.1907ms)
Ô£ö gameReducer: UPDATE_PLAYER clamps money to 0 (1.0564ms)
Ô£ö gameReducer: UPDATE_BAND clamps harmony to [1, 100] (0.9304ms)
Ô£ö gameReducer: ADVANCE_DAY clamps harmony (1.2875ms)
Ô£ö applyEventDelta: fuel clamped to [0, 100] (0.6865ms)
Ô£ö applyEventDelta: harmony clamped to [1, 100] (0.2059ms)
Ô£ö applyEventDelta: money clamped to 0 (0.1955ms)
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Update Player { money: 1000 }
[GameState] Update Player { fame: 50 }
[GameState] Update Player { money: 1000 }
[GameState] Update Band { harmony: 50 }
[GameState] Update Band { harmony: -20 }
[GameState] Update Band { harmony: 0 }
[GameState] Update Band { members: [ { name: 'Test', mood: 100, stamina: 100 } ] }
[GameState] Day Advanced to 2 
[GameState] State Reset (Debug) 
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Regional reputation gain in Stendal (+10) 
(node:12444) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ gameReducer
  ÔûÂ CHANGE_SCENE
    Ô£ö should change the current scene (5.777ms)
    Ô£ö should preserve other state properties (1.0926ms)
  Ô£ö CHANGE_SCENE (8.2127ms)
  ÔûÂ UPDATE_PLAYER
    Ô£ö should update player money (1.2274ms)
    Ô£ö should update player fame (0.8304ms)
    Ô£ö should merge player updates with existing state (0.7542ms)
  Ô£ö UPDATE_PLAYER (3.191ms)
  ÔûÂ UPDATE_BAND
    Ô£ö should update band harmony (0.7894ms)
    Ô£ö should clamp band harmony above zero (0.6436ms)
    Ô£ö should clamp band harmony of zero to one (0.5854ms)
    Ô£ö should update band members (0.7432ms)
  Ô£ö UPDATE_BAND (3.2225ms)
  ÔûÂ ADVANCE_DAY
    Ô£ö should clamp harmony after daily updates (4.4194ms)
  Ô£ö ADVANCE_DAY (4.6166ms)
  ÔûÂ UPDATE_SOCIAL
    Ô£ö should update social media followers (0.6462ms)
    Ô£ö should preserve other social stats (0.3081ms)
  Ô£ö UPDATE_SOCIAL (1.1614ms)
  ÔûÂ SET_GIG_MODIFIERS
    Ô£ö should update gig modifiers with object payload (0.3495ms)
    Ô£ö should update gig modifiers with function payload (0.3629ms)
  Ô£ö SET_GIG_MODIFIERS (0.8733ms)
  ÔûÂ ADD_TOAST
    Ô£ö should add toast to array (0.3731ms)
  Ô£ö ADD_TOAST (0.4897ms)
  ÔûÂ REMOVE_TOAST
    Ô£ö should remove toast by id (0.3794ms)
  Ô£ö REMOVE_TOAST (0.4797ms)
  ÔûÂ CONSUME_ITEM
    Ô£ö should decrement numeric inventory item (0.4557ms)
    Ô£ö should set boolean inventory item to false (0.319ms)
    Ô£ö should not go below zero (0.2458ms)
  Ô£ö CONSUME_ITEM (1.2663ms)
  ÔûÂ RESET_STATE
    Ô£ö should reset to initial state (0.6582ms)
  Ô£ö RESET_STATE (0.8076ms)
  ÔûÂ LOAD_GAME
    Ô£ö should load saved state (0.9882ms)
    Ô£ö should migrate energy to catering in gigModifiers (0.4959ms)
    Ô£ö should merge with default values for missing properties (0.5548ms)
  Ô£ö LOAD_GAME (2.2473ms)
  ÔûÂ unknown action
    Ô£ö should return current state for unknown action (0.9291ms)
  Ô£ö unknown action (1.0654ms)
  ÔûÂ UNLOCK_TRAIT
    Ô£ö UNLOCK_TRAIT unlocks a trait for a band member (Name fallback) (1.3332ms)
    Ô£ö UNLOCK_TRAIT adds toast (0.6131ms)
  Ô£ö UNLOCK_TRAIT (2.1445ms)
  ÔûÂ SET_LAST_GIG_STATS
    Ô£ö should not check trait unlocks in practice mode (1.389ms)
    Ô£ö should check trait unlocks in normal mode (0.9591ms)
  Ô£ö SET_LAST_GIG_STATS (2.5392ms)
Ô£ö gameReducer (34.4561ms)
ÔûÂ ActionTypes
  Ô£ö should have all expected action types (0.2947ms)
Ô£ö ActionTypes (0.6579ms)
Ô£ö applyEventDelta clamps player and band values (1.7832ms)
Ô£ö applyEventDelta updates social channels safely (0.4389ms)
Ô£ö applyEventDelta applies basic relationship changes (2.0859ms)
Ô£ö applyEventDelta amplifies negative change for grudge_holder (0.557ms)
Ô£ö applyEventDelta does not amplify positive change for grudge_holder (0.4141ms)
Ô£ö applyEventDelta amplifies positive change for peacemaker (0.2483ms)
Ô£ö applyEventDelta dampens negative change for peacemaker (0.2737ms)
Ô£ö applyEventDelta clamps relationship scores to 0-100 (0.3664ms)
Ô£ö applyEventDelta handles multiple relationship changes (0.4295ms)
Ô£ö applyEventDelta handles both traits simultaneously (edge case) and symmetric updates (0.3111ms)
Ô£ö applyEventDelta applies player updates (3.2464ms)
Ô£ö applyEventDelta clamps values (0.572ms)
Ô£ö applyEventDelta handles band inventory updates (0.536ms)
Ô£ö applyEventDelta applies per-member deltas (0.4428ms)
Ô£ö applyEventDelta handles social updates (0.4117ms)
Ô£ö applyEventDelta handles flags (0.3355ms)
Ô£ö applyEventDelta ignores unsupported score mutations in flags (0.8293ms)
Ô£ö state safety helpers clamp canonical values (0.2617ms)
Ô£ö applyInventoryItemDelta handles numeric and boolean deltas (0.2089ms)
Ô£ö updateGigPerformanceStats tracks peak combo and hype (1.4196ms)
Ô£ö buildGigStatsSnapshot includes required economy fields (1.5166ms)
[GameState] Scene Change: INTRO -> MENU 
[GameState] State Reset (Debug) 
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Map Generated 
[GameState] Update Player {
  money: 470,
  currentNodeId: 'node_1_0',
  location: 'Test City',
  van: { fuel: 85, condition: 100, upgrades: [], breakdownChance: 0.05 }
}
[GameState] Day Advanced to 2 
[GameState] Starting Gig Sequence Test Punk Keller
[GameState] Scene Change: PREGIG -> GIG 
[GameState] Regional reputation gain in Test City (+10) 
[GameState] Scene Change: GIG -> POSTGIG 
[Economy] Calculating Gig Financials { gig: 'Test Punk Keller', score: 30, fame: 0 }
[Economy] Gig Report Generated { net: 1260, income: 1460, expenses: 200 }
[GameState] Update Player { money: 680, fame: 100 }
[GameState] Set Current Gig 
[GameState] Regional reputation loss in Test City due to poor gig performance (-10) 
[GameState] Scene Change: POSTGIG -> OVERWORLD 
[GameState] Update Player { money: 660, currentNodeId: 'node_1_0' }
[GameState] Day Advanced to 3 
[GameState] Starting Gig Sequence Test Punk Keller
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Update Player { money: 5 }
[GameState] Starting Gig Sequence Test Punk Keller
[GameState] Scene Change: PREGIG -> GIG 
[GameState] Regional reputation gain in Stendal (+10) 
[GameState] Scene Change: GIG -> POSTGIG 
[GameState] Update Player { money: -95 }
[GameState] Scene Change: POSTGIG -> GAMEOVER 
[GameState] State Reset (Debug) 
[GameState] Scene Change: INTRO -> MENU 
[GameState] Update Player { money: -999 }
[GameState] Applying Event Delta { player: { money: -99999 } }
[GameState] Update Band { harmony: -50 }
[GameState] Update Band { harmony: 200 }
[GameState] Applying Event Delta { band: { harmony: -200 } }
[GameState] Applying Event Delta { player: { van: { fuel: 500 } } }
[GameState] Applying Event Delta { player: { van: { fuel: -500 } } }
[GameState] Applying Event Delta { player: { van: { condition: -500 } } }
[GameState] Update Player { money: 50 }
[GameState] Day Advanced to 2 
[GameState] Day Advanced to 3 
[GameState] Day Advanced to 4 
[GameState] Day Advanced to 5 
[GameState] Day Advanced to 6 
[GameState] Day Advanced to 2 
[GameState] Update Band {
  inventory: {
    shirts: 0,
    hoodies: 20,
    patches: 100,
    cds: 30,
    vinyl: 10,
    strings: true,
    cables: true,
    drum_parts: true,
    golden_pick: false
  }
}
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Game Loaded 
[GameState] Scene Change: INTRO -> INTRO 
[GameState] Scene Change: INTRO -> MENU 
[GameState] Scene Change: INTRO -> MENU 
[GameState] Scene Change: MENU -> OVERWORLD 
[GameState] Scene Change: INTRO -> MENU 
[GameState] Scene Change: MENU -> SETTINGS 
[GameState] Scene Change: INTRO -> MENU 
[GameState] Scene Change: MENU -> CREDITS 
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Scene Change: OVERWORLD -> PREGIG 
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Scene Change: OVERWORLD -> GAMEOVER 
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Scene Change: OVERWORLD -> MENU 
[GameState] Scene Change: INTRO -> PREGIG 
[GameState] Scene Change: PREGIG -> GIG 
[GameState] Scene Change: INTRO -> PREGIG 
[GameState] Scene Change: PREGIG -> OVERWORLD 
[GameState] Scene Change: INTRO -> GIG 
[GameState] Scene Change: GIG -> POSTGIG 
[GameState] Scene Change: INTRO -> GIG 
[GameState] Scene Change: GIG -> OVERWORLD 
[GameState] Scene Change: INTRO -> POSTGIG 
[GameState] Scene Change: POSTGIG -> OVERWORLD 
[GameState] Scene Change: INTRO -> POSTGIG 
[GameState] Scene Change: POSTGIG -> GAMEOVER 
[GameState] Scene Change: INTRO -> GAMEOVER 
[GameState] Scene Change: GAMEOVER -> MENU 
[GameState] Scene Change: INTRO -> SETTINGS 
[GameState] Scene Change: SETTINGS -> MENU 
[GameState] Scene Change: INTRO -> CREDITS 
[GameState] Scene Change: CREDITS -> MENU 
[GameState] Scene Change: INTRO -> OVERWORLD 
[GameState] Starting Gig Sequence Test Punk Keller
[GameState] Day Advanced to 2 
[GameState] Day Advanced to 2 
ÔûÂ Golden Path: Full Tour Cycle
  Ô£ö Phase 0: Initial state is INTRO (1.387ms)
  Ô£ö Phase 1: INTRO ÔåÆ MENU (16.1884ms)
  Ô£ö Phase 2: MENU ÔåÆ OVERWORLD via RESET_STATE + CHANGE_SCENE (0.9016ms)
  Ô£ö Phase 3: Set up map in OVERWORLD (0.7072ms)
  Ô£ö Phase 4: Travel costs (simulate OVERWORLD travel) (1.1401ms)
  Ô£ö Phase 5: ADVANCE_DAY after travel (2.8998ms)
  Ô£ö Phase 6: OVERWORLD ÔåÆ PREGIG via START_GIG (1.6028ms)
  Ô£ö Phase 7: Configure setlist and modifiers in PREGIG (0.4939ms)
  Ô£ö Phase 8: PREGIG ÔåÆ GIG (0.5542ms)
  Ô£ö Phase 9: Gig performance produces stats (0.9621ms)
  Ô£ö Phase 10: GIG ÔåÆ POSTGIG (0.5137ms)
  Ô£ö Phase 11: Calculate financials in POSTGIG (1.7764ms)
  Ô£ö Phase 12: Apply earnings and return to OVERWORLD (1.2374ms)
  Ô£ö Phase 13: Second gig cycle preserves progression (0.7083ms)
Ô£ö Golden Path: Full Tour Cycle (36.4813ms)
ÔûÂ Golden Path: Bankruptcy triggers GAMEOVER
  Ô£ö Drain money to near zero (0.4572ms)
  Ô£ö Start a gig (0.5864ms)
  Ô£ö Negative net triggers GAMEOVER path (3.1654ms)
  Ô£ö GAMEOVER ÔåÆ MENU via RESET_STATE (0.7214ms)
Ô£ö Golden Path: Bankruptcy triggers GAMEOVER (6.3991ms)
ÔûÂ Golden Path: State safety invariants across transitions
  Ô£ö Money never goes negative from UPDATE_PLAYER (0.8295ms)
  Ô£ö Money never goes negative from APPLY_EVENT_DELTA (1.1502ms)
  Ô£ö Harmony clamped [1, 100] from UPDATE_BAND (0.6405ms)
  Ô£ö Harmony clamped [1, 100] from APPLY_EVENT_DELTA (0.4035ms)
  Ô£ö Fuel clamped [0, 100] from APPLY_EVENT_DELTA (0.5725ms)
  Ô£ö Van condition clamped [0, 100] from APPLY_EVENT_DELTA (0.4214ms)
  Ô£ö ADVANCE_DAY preserves state safety after many days (0.8073ms)
  Ô£ö Van condition decays daily and breakdown chance adjusts (0.3302ms)
  Ô£ö CONSUME_ITEM decrements numeric inventory (0.2839ms)
  Ô£ö CONSUME_ITEM sets boolean inventory to false (0.1843ms)
  Ô£ö CONSUME_ITEM never goes below 0 (0.403ms)
Ô£ö Golden Path: State safety invariants across transitions (9.2773ms)
ÔûÂ Golden Path: SET_GIG_MODIFIERS functional updater
  Ô£ö Object payload merges with existing modifiers (0.2933ms)
  Ô£ö Function payload receives current modifiers (2.4124ms)
Ô£ö Golden Path: SET_GIG_MODIFIERS functional updater (3.2766ms)
ÔûÂ Golden Path: LOAD_GAME sanitizes corrupted save data
  Ô£ö Negative money in save is clamped to 0 (1.2411ms)
  Ô£ö Harmony out of range is clamped (0.8568ms)
  Ô£ö Fuel overflow is clamped to 100 (0.6485ms)
  Ô£ö Missing fields get defaults (1.1979ms)
  Ô£ö Legacy energy modifier migrated to catering (0.5767ms)
  Ô£ö Day cannot be less than 1 (0.4049ms)
Ô£ö Golden Path: LOAD_GAME sanitizes corrupted save data (6.8105ms)
ÔûÂ Golden Path: Scene sequence matches state machine
  Ô£ö All valid transitions produce the target scene (1.7625ms)
  Ô£ö START_GIG transitions to PREGIG regardless of current scene (0.3749ms)
Ô£ö Golden Path: Scene sequence matches state machine (2.6814ms)
ÔûÂ Golden Path: Daily cost scaling with band size
  Ô£ö Daily cost includes per-member component (0.4062ms)
Ô£ö Golden Path: Daily cost scaling with band size (0.7297ms)
ÔûÂ Golden Path: Event cooldowns reset on ADVANCE_DAY
  Ô£ö Cooldowns cleared after day advance (0.9809ms)
Ô£ö Golden Path: Event cooldowns reset on ADVANCE_DAY (1.2555ms)
ÔûÂ Golden Path: Gig stats snapshot structure
  Ô£ö buildGigStatsSnapshot includes all fields (0.1727ms)
Ô£ö Golden Path: Gig stats snapshot structure (0.4349ms)
Ô£ö updateProjectiles - updates position and rotation (1.7216ms)
Ô£ö updateProjectiles - removes projectiles below limit (0.3585ms)
Ô£ö updateProjectiles - handles empty array (0.2529ms)
Ô£ö updateProjectiles - mutates array in-place (0.1775ms)
Ô£ö trySpawnProjectile - spawns based on chance (0.4387ms)
Ô£ö trySpawnProjectile - does not spawn if random > chance (0.2415ms)
Ô£ö trySpawnProjectile - higher chance on low health (0.2725ms)
Ô£ö trySpawnProjectile - higher chance on high combo (0.192ms)
Ô£ö checkCollisions - detects collision and calls onHit (0.3282ms)
Ô£ö checkCollisions - handles no collisions (0.41ms)
Ô£ö checkCollisions - handles all collisions (0.2235ms)
Ô£ö checkCollisions - handles mixed collisions order (1.1134ms)
ÔûÂ HQ Items Data Integrity
  Ô£ö validates all gear items (1.113ms)
  Ô£ö validates all instrument items (0.2325ms)
  Ô£ö validates all van items (0.216ms)
  Ô£ö validates all hq items (0.2129ms)
Ô£ö HQ Items Data Integrity (3.0764ms)
ÔûÂ HQ Passive Effects
  Ô£ö hq_room_label purchase gives money bonus (140.5319ms)
  Ô£ö calculateDailyUpdates applies passive boosts for HQ items (20.1043ms)
  Ô£ö passive boosts are clamped to 100 (14.1597ms)
  Ô£ö passive boosts are clamped to 100 (properly) (12.881ms)
Ô£ö HQ Passive Effects (189.6376ms)
Ô£ö getGenImageUrl generates correct Pollinations.ai URL (6.0226ms)
Ô£ö IMG_PROMPTS contains expected keys and string values (2.7976ms)
Ô£ö createNamedLazyLoader maps a named export to default (1.5101ms)
Ô£ö createNamedLazyLoader throws a helpful error when export is missing (0.9841ms)
ÔûÂ Logger
  Ô£ö constructor defaults to DEBUG level (3.192ms)
  Ô£ö constructor loads level from localStorage (1.4804ms)
  Ô£ö setLevel updates level and saves to localStorage (1.8041ms)
  Ô£ö subscribe registers callback and unsubscribe removes it (4.7948ms)
  Ô£ö debug logs only if level <= DEBUG (1.1107ms)
  Ô£ö info logs only if level <= INFO (3.3936ms)
  Ô£ö warn logs only if level <= WARN (0.3427ms)
  Ô£ö error logs only if level <= ERROR (0.34ms)
  Ô£ö logs are trimmed to maxLogs (0.4294ms)
  Ô£ö clear removes all logs and emits clear event (0.3543ms)
  Ô£ö dump returns JSON string of logs (0.2872ms)
  Ô£ö debug does not call console.debug in production (0.3046ms)
  Ô£ö info does not call console.info in production (0.216ms)
  Ô£ö warn still calls console.warn in production (0.2204ms)
  Ô£ö log entries use valid UUIDs for ids (0.5031ms)
Ô£ö Logger (22.2567ms)
(node:27200) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
Ô£ö MainMenu starts ambient audio when starting a tour (834.2584ms)
Ô£ö MainMenu starts ambient audio when loading a save (618.4434ms)
Ô£ö MapGenerator generates a map with correct structure (19.3993ms)
Ô£ö MapGenerator guarantees start node (2.4683ms)
Ô£ö MapGenerator guarantees finale node (3.8695ms)
Ô£ö MapGenerator connections are valid (2.1108ms)
Ô£ö MapGenerator ensures nodes do not overlap (1.001ms)
Ô£ö MapGenerator should not have duplicate venues (if possible) (7.939ms)
(node:4100) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ mapUtils
  ÔûÂ isConnected
    Ô£ö returns true if nodes are directly connected (1.12ms)
    Ô£ö returns false if nodes are not directly connected (0.2834ms)
    Ô£ö returns false if map is missing (0.2615ms)
  Ô£ö isConnected (2.8028ms)
  ÔûÂ getNodeVisibility
    Ô£ö returns visible for current layer (0.3819ms)
    Ô£ö returns visible for next layer (0.2016ms)
    Ô£ö returns dimmed for layer + 2 (0.194ms)
    Ô£ö returns hidden for layer + 3 or more (0.2102ms)
  Ô£ö getNodeVisibility (1.3598ms)
  ÔûÂ checkSoftlock
    Ô£ö returns false if map or player invalid (3.1941ms)
    Ô£ö returns false if player can reach a neighbor (0.9431ms)
    Ô£ö returns false if player cannot reach neighbor but can refuel (5.6434ms)
    Ô£ö returns true if player cannot reach neighbor and cannot refuel (2.1282ms)
    Ô£ö returns false if current node is GIG even if stranded otherwise (0.42ms)
  Ô£ö checkSoftlock (13.2968ms)
Ô£ö mapUtils (18.4156ms)
ÔûÂ isPercussionTrack
  Ô£ö detects percussion instrument metadata (1.2424ms)
  Ô£ö detects channel 9 percussion tracks (0.3238ms)
  Ô£ö returns false for non-percussion tracks (0.2699ms)
Ô£ö isPercussionTrack (3.8317ms)
ÔûÂ isValidMidiNote
  Ô£ö accepts finite MIDI pitches (0.3016ms)
  Ô£ö rejects invalid MIDI pitches (0.226ms)
Ô£ö isValidMidiNote (1.2788ms)
ÔûÂ normalizeMidiPitch
  Ô£ö normalizes valid MIDI pitches (0.2139ms)
  Ô£ö returns null for invalid MIDI pitches (0.2502ms)
Ô£ö normalizeMidiPitch (1.1366ms)
ÔûÂ buildMidiTrackEvents
  Ô£ö filters invalid notes and normalizes pitches (1.3834ms)
  Ô£ö returns empty array for invalid input (0.2393ms)
Ô£ö buildMidiTrackEvents (2.272ms)
ÔûÂ getNoteName
  Ô£ö returns correct note names for valid MIDI pitches (0.2348ms)
  Ô£ö returns null for invalid MIDI pitches (0.2458ms)
  Ô£ö handles float inputs by flooring (0.2043ms)
Ô£ö getNoteName (2.4999ms)
[GameState] Starting Travel Minigame to node_1 
[GameState] Travel Minigame Complete { damageTaken: 20, itemsCollected: [ 'FUEL' ] }
[GameState] Starting Roadie Minigame for Gig gig_123 
[GameState] Roadie Minigame Complete { equipmentDamage: 5 }
ÔûÂ Minigame State Transitions
  Ô£ö START_TRAVEL_MINIGAME updates state correctly (4.22ms)
  Ô£ö COMPLETE_TRAVEL_MINIGAME applies results and updates location (6.2117ms)
  Ô£ö START_ROADIE_MINIGAME updates state correctly (0.715ms)
  Ô£ö COMPLETE_ROADIE_MINIGAME resets minigame state and applies economy effects (1.0088ms)
Ô£ö Minigame State Transitions (15.9793ms)
[Perf] 100k frames took: 51.75ms
(node:26140) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ EffectManager Performance
  Ô£ö removal performance (54.5317ms)
Ô£ö EffectManager Performance (200.5611ms)
Filter assignment count: 0
ÔûÂ PixiStageController Filter Performance
  Ô£ö Optimization: Filters should only be assigned on state change (120.4381ms)
Ô£ö PixiStageController Filter Performance (121.6427ms)
(node:23884) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ calculateGigPhysics - Character Traits
  Ô£ö should apply gear_nerd trait correctly (Matze) (1.5939ms)
  Ô£ö should apply party_animal trait correctly (Marius) (0.8802ms)
  Ô£ö should apply bandleader trait correctly (Lars) (0.4566ms)
  Ô£ö should apply social_manager trait correctly (Lars) (0.3225ms)
Ô£ö calculateGigPhysics - Character Traits (11.4803ms)
Ô£ö calculateNoteY returns target position at hit time (1.3022ms)
Ô£ö buildRhythmLayout derives lane and hit line positions (0.5657ms)
Ô£ö getPixiColorFromToken falls back when CSS variables are unavailable (0.4538ms)
Ô£ö getPixiColorFromToken resolves css variable color values (0.9311ms)
Ô£ö shouldTriggerBankruptcy returns true for negative money (1.4536ms)
Ô£ö shouldTriggerBankruptcy returns false for positive money (0.3241ms)
Ô£ö shouldTriggerBankruptcy at zero money returns false if breaking even or profitable (0.2108ms)
Ô£ö shouldTriggerBankruptcy at zero money returns true if losing money (0.1917ms)
Ô£ö shouldTriggerBankruptcy handles missing netIncome safely (0.2258ms)
Ô£ö shouldTriggerBankruptcy throws for invalid money input (0.6682ms)
Ô£ö shouldTriggerBankruptcy handles numeric strings (0.2614ms)
ÔûÂ purchaseLogicUtils
  ÔûÂ getPrimaryEffect
    Ô£ö returns first effect from effects array (7.7765ms)
    Ô£ö returns effect object if present (0.4796ms)
    Ô£ö returns undefined if no effect (0.3497ms)
  Ô£ö getPrimaryEffect (24.4562ms)
  ÔûÂ getAdjustedCost
    Ô£ö returns cost without modification if no gear_nerd (23.5056ms)
    Ô£ö returns discounted cost with gear_nerd for GEAR money items (0.4031ms)
    Ô£ö does not discount if currency is fame (1.0093ms)
  Ô£ö getAdjustedCost (26.9074ms)
  ÔûÂ buildVanWithUpgrade
    Ô£ö adds upgrade if not present (0.405ms)
    Ô£ö does not duplicate upgrade (0.3251ms)
    Ô£ö handles undefined van (0.2044ms)
  Ô£ö buildVanWithUpgrade (1.3444ms)
  ÔûÂ isItemOwned
    Ô£ö returns true if item id is in van upgrades (0.3595ms)
    Ô£ö returns true if item id is in hq upgrades (0.2255ms)
    Ô£ö returns true if inventory item is true for inventory_set (1.1003ms)
  Ô£ö isItemOwned (1.9056ms)
  ÔûÂ canAfford
    Ô£ö returns true if money >= adjustedCost (4.8681ms)
    Ô£ö returns false if money < adjustedCost (0.235ms)
    Ô£ö returns true if fame >= adjustedCost (0.1251ms)
  Ô£ö canAfford (5.4351ms)
  ÔûÂ applyInventorySet
    Ô£ö sets inventory item to value (0.2882ms)
    Ô£ö handles undefined inventory (0.1351ms)
  Ô£ö applyInventorySet (0.5315ms)
  ÔûÂ applyInventoryAdd
    Ô£ö adds value to existing inventory item (0.2285ms)
    Ô£ö initializes inventory item if missing (0.1171ms)
  Ô£ö applyInventoryAdd (0.4357ms)
  ÔûÂ applyStatModifier
    Ô£ö applies to player stat (0.3132ms)
    Ô£ö applies to player money (clamped) (0.1578ms)
    Ô£ö applies to van stat (0.1208ms)
    Ô£ö applies to band stat (0.108ms)
    Ô£ö applies to band harmony (clamped 1-100) (0.147ms)
    Ô£ö applies to performance stat by default (0.2417ms)
  Ô£ö applyStatModifier (1.3771ms)
  ÔûÂ applyUnlockUpgrade
    Ô£ö unlocks new upgrade (0.2572ms)
    Ô£ö does not duplicate existing upgrade (0.161ms)
  Ô£ö applyUnlockUpgrade (0.5307ms)
  ÔûÂ applyUnlockHQ
    Ô£ö returns correct messages for special items (0.3256ms)
    Ô£ö clamps harmony for soundproofing (0.2963ms)
  Ô£ö applyUnlockHQ (0.7527ms)
  ÔûÂ applyPassive
    Ô£ö applies harmony regen travel (1.4798ms)
    Ô£ö applies passive followers (0.2052ms)
  Ô£ö applyPassive (1.9816ms)
Ô£ö purchaseLogicUtils (110.2109ms)
ÔûÂ Relationship Mechanics
  Ô£ö Relationship update via applyEventDelta (2.9632ms)
  Ô£ö Grudge Holder Trait amplifies negative change (0.6085ms)
  Ô£ö Peacemaker Trait amplifies positive change (0.4546ms)
  Ô£ö Peacemaker Trait dampens negative change (1.7593ms)
  Ô£ö Event Engine Placeholder Resolution (2.2449ms)
  Ô£ö Unlock Checks (0.8873ms)
Ô£ö Relationship Mechanics (13.4778ms)
Ô£ö trySpawnProjectile respects spawn chance (2.1482ms)
Ô£ö trySpawnProjectile respects no spawn (0.4146ms)
Ô£ö trySpawnProjectile increases chance on low health (0.8387ms)
Ô£ö trySpawnProjectile increases chance on high combo (0.3459ms)
Ô£ö updateProjectiles moves items correctly (0.3882ms)
Ô£ö updateProjectiles removes off-screen items (0.2493ms)
Ô£ö updateProjectiles handles empty input (1.0186ms)
Ô£ö updateProjectiles handles large delta (lag spike) (0.2369ms)
Ô£ö checkCollisions detects hits and removes items (0.363ms)
Ô£ö checkCollisions handles multiple simultaneous hits (0.3576ms)
Ô£ö checkCollisions handles all items hitting (0.2496ms)
Ô£ö checkCollisions handles no hits (0.1596ms)
Ô£ö checkCollisions handles empty input (0.2003ms)
Ô£ö checkCollisions handles missing onHit callback (0.147ms)
Ô£ö checkHit finds matching note within window (1.6222ms)
Ô£ö checkHit ignores notes outside window (0.3941ms)
Ô£ö checkHit ignores wrong lane (0.26ms)
Ô£ö checkHit ignores already hit or invisible notes (0.216ms)
Ô£ö checkHit prioritizes closest note? (0.2222ms)
Ô£ö generateNotesForSong creates correct note structure (2.2834ms)
Ô£ö generateNotesForSong respects difficulty (0.3161ms)
(node:20020) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useRhythmGameLogic Multi-Song Support
  Ô£ö initializes audio and notes for multiple songs in sequence (471.6588ms)
  Ô£ö Quit logic does not trigger multi-song chaining (196.6066ms)
  Ô£ö does not force a default excerpt duration when metadata is missing (133.3901ms)
  Ô£ö Game loop waits for setlistCompleted signal (133.0645ms)
  Ô£ö totalDuration snap: no change when getGigTimeMs returns NaN (188.7072ms)
Ô£ö useRhythmGameLogic Multi-Song Support (1125.6425ms)
(node:9296) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useRhythmGameScoring Game Over
  Ô£ö marks game over and stops audio on collapse (145.5096ms)
Ô£ö useRhythmGameScoring Game Over (147.0623ms)
ÔûÂ rhythm_songs.json integration
  Ô£ö all songs can be parsed without error (3.0738ms)
Ô£ö rhythm_songs.json integration (4.8345ms)
ÔûÂ rhythm_songs.json sourceOgg fields
  Ô£ö every song with sourceMid has a matching sourceOgg (0.6747ms)
Ô£ö rhythm_songs.json sourceOgg fields (1.5755ms)
ÔûÂ calculateTimeFromTicks logic
  Ô£ö calculates correct time with constant tempo (0.2883ms)
  Ô£ö calculates correct time with tempo change (0.216ms)
  Ô£ö handles empty map gracefully (0.251ms)
Ô£ö calculateTimeFromTicks logic (1.6849ms)
ÔûÂ rhythmUtils
  ÔûÂ checkHit
    Ô£ö should return note for exact hit (4.0042ms)
    Ô£ö should return note for hit just inside start boundary (inclusive/exclusive check) (0.6448ms)
    Ô£ö should return note for hit just inside end boundary (0.3308ms)
    Ô£ö should return null for hit exactly at start boundary (exclusive) (0.2387ms)
    Ô£ö should return null for hit exactly at end boundary (exclusive) (0.2378ms)
    Ô£ö should return null for hit outside start boundary (0.2499ms)
    Ô£ö should return null for hit outside end boundary (0.1995ms)
    Ô£ö should respect lane index (0.2486ms)
    Ô£ö should ignore invisible notes (0.2317ms)
    Ô£ö should ignore already hit notes (0.2612ms)
    Ô£ö should handle floating point precision robustly (1.4273ms)
    Ô£ö should return null if elapsed is not finite (0.328ms)
  Ô£ö checkHit (11.0773ms)
  ÔûÂ calculateTimeFromTicks
    Ô£ö should handle empty tempo map (0.4196ms)
    Ô£ö should calculate time for initial segment (ms) (0.2474ms)
    Ô£ö should calculate time crossing segments (ms) (0.1532ms)
    Ô£ö should calculate time crossing segments (seconds) (0.1517ms)
    Ô£ö should handle ticks exactly on segment boundary (0.1717ms)
    Ô£ö should handle ticks beyond last segment (0.1296ms)
  Ô£ö calculateTimeFromTicks (1.6883ms)
  ÔûÂ parseSongNotes excerpt alignment
    Ô£ö uses note tick times directly without subtracting excerptStartMs (1.0254ms)
    Ô£ö uses resolved playback window (excerptEndMs priority) to cap note duration (0.3179ms)
    Ô£ö does not impose a synthetic 30s excerpt cap when excerpt metadata is missing (0.2331ms)
  Ô£ö parseSongNotes excerpt alignment (1.8072ms)
  ÔûÂ calculateTimeFromTicks (Optimized)
    Ô£ö should have preprocessed data (0.2122ms)
    Ô£ö should calculate time for initial segment (ms) (0.1483ms)
    Ô£ö should calculate time crossing segments (ms) (0.1715ms)
    Ô£ö should calculate time crossing segments (seconds) (0.1769ms)
    Ô£ö should handle ticks exactly on segment boundary (0.1232ms)
    Ô£ö should handle ticks beyond last segment (0.1179ms)
  Ô£ö calculateTimeFromTicks (Optimized) (1.254ms)
Ô£ö rhythmUtils (16.7824ms)
ÔûÂ saveValidator - Leaderboard Identity
  Ô£ö accepts valid playerId and playerName (1.8347ms)
  Ô£ö accepts null playerId (uninitialized) (0.406ms)
  Ô£ö accepts missing playerId and playerName (legacy saves) (0.2906ms)
  Ô£ö throws if playerId is not a string or null (1.1869ms)
  Ô£ö throws if playerName is not a string (0.2993ms)
Ô£ö saveValidator - Leaderboard Identity (5.9008ms)
ÔûÂ saveValidator
  Ô£ö returns true for valid save data (1.6826ms)
  ÔûÂ root object validation
    Ô£ö throws if data is null (1.4821ms)
    Ô£ö throws if data is not an object (0.3528ms)
    Ô£ö throws if data is an array (0.3372ms)
    Ô£ö throws if required top-level keys are missing (0.4149ms)
  Ô£ö root object validation (3.0765ms)
  ÔûÂ player validation
    Ô£ö throws if player is not an object (0.378ms)
    Ô£ö throws if numeric fields are not numbers (5.4645ms)
    Ô£ö throws if player.van is not an object (0.5777ms)
  Ô£ö player validation (6.999ms)
  ÔûÂ band validation
    Ô£ö throws if band is not an object (0.581ms)
    Ô£ö throws if band.members is not an array (0.5203ms)
    Ô£ö throws if band member is not an object (0.3137ms)
    Ô£ö throws if band member name is not a string (0.2242ms)
    Ô£ö throws if band.harmony is not a number (0.2601ms)
  Ô£ö band validation (2.2352ms)
  ÔûÂ social validation
    Ô£ö throws if social is not an object (0.2584ms)
    Ô£ö throws if social values are not numbers (except lastGigDay) (0.1844ms)
    Ô£ö allows lastGigDay to be null (0.1319ms)
    Ô£ö throws if lastGigDay is not a number or null (0.1719ms)
    Ô£ö validates activeDeals correctly (0.1583ms)
    Ô£ö throws if activeDeals is not an array (1.5652ms)
    Ô£ö throws if activeDeals items are invalid (0.507ms)
  Ô£ö social validation (3.266ms)
  ÔûÂ gameMap validation
    Ô£ö throws if gameMap is not an object (0.3048ms)
  Ô£ö gameMap validation (0.4129ms)
Ô£ö saveValidator (19.4434ms)
(node:14008) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
Ô£ö secureRandom returns values in [0, 1) (13.2141ms)
Ô£ö secureRandom utilizes crypto.getRandomValues (0.8353ms)
Ô£ö eventEngine uses secureRandom for event selection (47.1345ms)
[GameState] Game Loaded 
[GameState] Game Loaded 
Ô£ö validateSaveData rejects non-objects (16.2066ms)
Ô£ö validateSaveData rejects missing required keys (0.5428ms)
Ô£ö validateSaveData validates player field types (0.5189ms)
Ô£ö validateSaveData validates band field types (0.3438ms)
Ô£ö validateSaveData validates social values (0.9118ms)
Ô£ö gameReducer LOAD_GAME prevents prototype pollution and state pollution (7.3528ms)
Ô£ö gameReducer LOAD_GAME handles missing optional fields gracefully (0.7524ms)
Ô£ö validateSaveData validates gameMap field type (0.5881ms)
ÔûÂ Unlock Manager Security
  Ô£ö addUnlock sanitizes before adding (2.728ms)
  Ô£ö addUnlock prevents duplicates (0.6008ms)
  Ô£ö addUnlock adds multiple unique items (0.4749ms)
  Ô£ö addUnlock rejects non-string inputs (0.4573ms)
Ô£ö Unlock Manager Security (55.6686ms)
Ô£ö getGigModifiers returns default modifiers for average band (4.6657ms)
Ô£ö getGigModifiers grants telepathy bonus for high harmony (0.4896ms)
Ô£ö getGigModifiers applies disconnect penalty for low harmony (0.2824ms)
Ô£ö getGigModifiers has no special effects for mid harmony (0.171ms)
Ô£ö getGigModifiers applies grumpy Matze penalty (0.4136ms)
Ô£ö getGigModifiers does not apply Matze penalty when mood is okay (0.3053ms)
Ô£ö getGigModifiers applies tired Marius speed increase (0.2837ms)
Ô£ö getGigModifiers does not apply Marius penalty when stamina is okay (0.172ms)
Ô£ö getGigModifiers can apply multiple effects (0.2195ms)
Ô£ö calculateGigPhysics returns physics object (0.6855ms)
Ô£ö calculateGigPhysics calculates hit windows based on skill (0.2256ms)
Ô£ö calculateGigPhysics skill increases hit windows (0.2726ms)
Ô£ö calculateGigPhysics reduces speed for low stamina (0.2513ms)
Ô£ö calculateGigPhysics normal speed for adequate stamina (0.1729ms)
Ô£ö calculateGigPhysics returns default multipliers (0.1803ms)
Ô£ö calculateGigPhysics applies blast machine trait for fast songs (0.23ms)
Ô£ö calculateGigPhysics does not apply blast machine for slow songs (0.2295ms)
Ô£ö calculateGigPhysics includes avgStamina in result (0.2487ms)
Ô£ö calculateGigPhysics handles missing member gracefully (0.2599ms)
Ô£ö calculateGigPhysics handles missing skill property (0.3211ms)
Ô£ö calculateDailyUpdates applies newsletter decay (0.7938ms)
Ô£ö calculateDailyUpdates does not decay if active recently (0.1769ms)
Ô£ö calculateDailyUpdates handles missing lastGigDay safely (0.2089ms)
Ô£ö calculateGigPhysics applies virtuoso trait hit window bonus (0.2317ms)
ÔûÂ Game Loop Logic Simulation
  Ô£ö Phase 1: Travel (Overworld) (2.4032ms)
  Ô£ö Phase 2: Refuel (Overworld) (0.4279ms)
  Ô£ö Phase 3: Gig (PostGig) (0.2552ms)
  Ô£ö Phase 4: Next Travel Cycle (0.3101ms)
Ô£ö Game Loop Logic Simulation (8.9053ms)
Ô£ö Stress Test: generatePostOptions over 10,000 random states (1135.4016ms)
Ô£ö Stress Test: resolvePost over 10,000 random selections and RNG rolls (28.7437ms)
Ô£ö Stress Test: calculateDailyUpdates over 10,000 random states (30.2244ms)
Ô£ö calculateViralityScore returns base chance for average performance (14.1784ms)
Ô£ö calculateViralityScore increases with high performance (0.7156ms)
Ô£ö calculateViralityScore applies performance multipliers (0.8753ms)
Ô£ö calculateViralityScore boosts for Kaminstube venue (0.3939ms)
Ô£ö calculateViralityScore boosts for stage diver event (0.3233ms)
Ô£ö calculateViralityScore boosts for influencer event (0.2261ms)
Ô£ö calculateViralityScore is capped at 90% (0.2161ms)
Ô£ö calculateViralityScore combines multiple bonuses (0.7351ms)
Ô£ö generatePostOptions returns array of exactly 3 options (8.3555ms)
Ô£ö generatePostOptions forces sponsor post if active (1.527ms)
Ô£ö generatePostOptions all have required properties (0.8125ms)
Ô£ö resolvePost handles RNG success (0.5228ms)
Ô£ö resolvePost handles RNG failure (0.3813ms)
Ô£ö resolvePost returns consistent structure (0.2807ms)
Ô£ö calculateViralityScore handles low performance (0.7584ms)
Ô£ö applyReputationDecay returns original followers if days since last post < 3 (0.6749ms)
Ô£ö applyReputationDecay applies 1% decay for 3 days (0.1952ms)
Ô£ö applyReputationDecay applies 8% decay for 10 days (0.1753ms)
Ô£ö applyReputationDecay caps decay at 50% (0.1069ms)
Ô£ö applyReputationDecay handles 0 followers (0.089ms)
Ô£ö applyReputationDecay floors the result (0.0929ms)
Ô£ö calculateSocialGrowth calculates base growth based on performance (0.2761ms)
Ô£ö calculateSocialGrowth applies platform multipliers (0.1354ms)
Ô£ö calculateSocialGrowth applies viral bonus (0.0982ms)
Ô£ö checkViralEvent returns true for high accuracy (0.3124ms)
Ô£ö checkViralEvent returns true for high combo (0.1753ms)
Ô£ö checkViralEvent handles random roll with modifiers (0.113ms)
Ô£ö checkViralEvent uses calculateViralityScore when context is provided (0.3179ms)
Ô£ö generateBrandName returns different name for alignment (0.4066ms)
Ô£ö generateBrandName returns base name for unknown alignment (0.1148ms)
Ô£ö generateBrandOffers filters by reputation and traits (0.4534ms)
Ô£ö negotiateDeal SAFE strategy succeeds with high roll (0.3808ms)
Ô£ö negotiateDeal SAFE strategy fails with low roll (0.2445ms)
Ô£ö negotiateDeal AGGRESSIVE strategy succeeds with very high luck (0.2431ms)
Ô£ö negotiateDeal AGGRESSIVE strategy revokes deal on failure (0.165ms)
Ô£ö collab_influencer option exists (1.2279ms)
Ô£ö collab_influencer selects affordable influencer (Micro) (0.649ms)
Ô£ö collab_influencer fails if no affordable influencer (0.3239ms)
Ô£ö collab_influencer applies relationship discount (0.1702ms)
Ô£ö collab_influencer caps discount at 50% (0.1846ms)
Ô£ö collab_influencer returns influencerUpdate (1.0513ms)
Ô£ö collab_influencer applies trait: tech_savvy (0.2459ms)
Ô£ö collab_influencer applies trait: drama_magnet (0.2051ms)
Ô£ö collab_influencer tier followers (0.2565ms)
ÔûÂ Extended Social & Trait Systems
  ÔûÂ Trend System
    Ô£ö generateDailyTrend returns a valid trend string (2.7446ms)
    Ô£ö generatePostOptions boosts trending categories (1.5826ms)
  Ô£ö Trend System (8.4961ms)
  ÔûÂ Brand Deals
    Ô£ö generateBrandOffers returns eligible deals (0.9907ms)
    Ô£ö generateBrandOffers filters ineligible deals (0.2728ms)
  Ô£ö Brand Deals (1.6387ms)
  ÔûÂ Cancel Culture
    Ô£ö calculateSocialGrowth applies negative growth on high controversy (0.4048ms)
  Ô£ö Cancel Culture (0.5841ms)
  ÔûÂ Showman Trait
    Ô£ö Showman trait boosts virality score (0.3752ms)
  Ô£ö Showman Trait (0.6468ms)
  ÔûÂ New Trait Unlocks
    Ô£ö Unlocks Melodic Genius for Lars on slow song combo (1.5619ms)
    Ô£ö Unlocks Tech Wizard for Matze on technical song accuracy (0.3377ms)
    Ô£ö Unlocks Showman for Marius on stage dives (0.3086ms)
  Ô£ö New Trait Unlocks (2.5796ms)
Ô£ö Extended Social & Trait Systems (15.1506ms)
Ô£ö resolveSongPlaybackWindow prefers excerpt end-start duration when available (2.3034ms)
Ô£ö resolveSongPlaybackWindow falls back to explicit duration when excerpt end is missing (0.3525ms)
Ô£ö resolveSongPlaybackWindow falls back to durationMs then default (0.2527ms)
Ô£ö resolveSongPlaybackWindow defaults to an unbounded duration when no metadata is provided (0.2242ms)
ÔûÂ Trait Logic
  ÔûÂ hasTrait
    Ô£ö returns true if member has the trait (1.2719ms)
    Ô£ö returns false if member does not have the trait (0.4162ms)
    Ô£ö returns false if member has no traits (0.2408ms)
    Ô£ö returns false if member is undefined (0.2086ms)
  Ô£ö hasTrait (3.4808ms)
  ÔûÂ bandHasTrait
    Ô£ö returns true if any member has the trait (0.4895ms)
    Ô£ö returns false if no member has the trait (0.235ms)
    Ô£ö returns false if band has no members (0.1898ms)
    Ô£ö returns false if band is undefined (0.2406ms)
  Ô£ö bandHasTrait (1.5493ms)
Ô£ö Trait Logic (6.0624ms)
ÔûÂ Trait Utils
  Ô£ö applyTraitUnlocks finds member by ID (1.399ms)
  Ô£ö applyTraitUnlocks finds member by Name (case-insensitive) (0.2696ms)
  Ô£ö applyTraitUnlocks ignores if already unlocked (0.2332ms)
Ô£ö Trait Utils (3.2936ms)
ÔûÂ checkTraitUnlocks
  ÔûÂ GIG_COMPLETE
    Ô£ö unlocks Virtuoso for Matze with 0 misses (2.5635ms)
    Ô£ö unlocks Perfektionist for Matze with 100% accuracy (0.4471ms)
    Ô£ö unlocks Blast Machine for Marius with fast song (>160 BPM) and maxCombo > 50 (0.3604ms)
    Ô£ö does not unlock Blast Machine for Marius if combo is too low (0.2652ms)
    Ô£ö unlocks Melodic Genius for Lars with slow song (<120 BPM) and maxCombo > 30 (0.2571ms)
    Ô£ö unlocks Tech Wizard for Matze with technical song (>3 difficulty) and 100% accuracy (0.2681ms)
  Ô£ö GIG_COMPLETE (5.6681ms)
  ÔûÂ TRAVEL_COMPLETE
    Ô£ö unlocks Road Warrior for Lars with >= 5000 total distance (0.3536ms)
    Ô£ö does not unlock Road Warrior for Lars with < 5000 total distance (0.2542ms)
  Ô£ö TRAVEL_COMPLETE (0.9272ms)
  ÔûÂ PURCHASE
    Ô£ö unlocks Party Animal for Marius when buying cheap beer fridge (2.4266ms)
    Ô£ö unlocks Party Animal for Marius when owning cheap beer fridge (via upgrades) (0.6125ms)
    Ô£ö unlocks Gear Nerd for Matze when gear count >= 5 (0.3612ms)
  Ô£ö PURCHASE (3.7266ms)
  ÔûÂ SOCIAL_UPDATE
    Ô£ö unlocks Social Manager for Lars when max followers >= 1000 (0.3552ms)
  Ô£ö SOCIAL_UPDATE (0.5341ms)
  ÔûÂ EVENT_RESOLVED
    Ô£ö unlocks Bandleader for Lars when conflicts resolved >= 3 (0.2302ms)
    Ô£ö unlocks Showman for Marius when stage dives >= 3 (0.1732ms)
    Ô£ö unlocks Grudge Holder for Matze when any relationship < 30 (4.7667ms)
    Ô£ö unlocks Peacemaker for Lars when band harmony >= 90 (0.3821ms)
  Ô£ö EVENT_RESOLVED (5.8492ms)
  ÔûÂ Edge Cases
    Ô£ö does not unlock trait if already owned (0.3086ms)
    Ô£ö returns empty array if member not found (0.2256ms)
    Ô£ö returns empty array for unknown context type (0.1975ms)
  Ô£ö Edge Cases (0.9294ms)
Ô£ö checkTraitUnlocks (18.8988ms)
[ErrorHandler] Storage operation failed: saveUnlocks {
  name: 'StorageError',
  message: 'Storage operation failed: saveUnlocks',
  category: 'storage',
  severity: 'medium',
  context: { originalError: 'Storage Full' },
  recoverable: true,
  timestamp: 1772196880519,
  stack: 'StorageError: Storage operation failed: saveUnlocks\n' +
    '    at safeStorageOperation (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/errorHandler.js:197:7)\n' +
    '    at addUnlock (file:///C:/Users/andre.oswald/Code/Neuro/neurotoxic-game/src/utils/unlockManager.js:48:10)\n' +
    '    at TestContext.<anonymous> (C:\\Users\\andre.oswald\\Code\\Neuro\\neurotoxic-game\\tests\\unlockManager.test.js:85:22)\n' +
    '    at Test.runInAsyncScope (node:async_hooks:214:14)\n' +
    '    at Test.run (node:internal/test_runner/test:1106:25)\n' +
    '    at async TestContext.<anonymous> (C:\\Users\\andre.oswald\\Code\\Neuro\\neurotoxic-game\\tests\\unlockManager.test.js:78:3)\n' +
    '    at async Test.run (node:internal/test_runner/test:1113:7)\n' +
    '    at async startSubtestAfterBootstrap (node:internal/test_runner/harness:358:3)'
}
ÔûÂ UnlockManager Unit Tests
  Ô£ö getUnlocks returns empty array when storage is empty (1.994ms)
  Ô£ö getUnlocks returns empty array on invalid JSON (0.4247ms)
  Ô£ö getUnlocks returns empty array if data is not an array (0.3122ms)
  Ô£ö getUnlocks sanitizes mixed-type arrays (0.5447ms)
  Ô£ö addUnlock successfully adds unique string unlock (0.4478ms)
  Ô£ö addUnlock rejects non-string input (0.268ms)
  Ô£ö addUnlock prevents duplicates (0.2799ms)
  Ô£ö addUnlock returns false if storage fails (17.7497ms)
Ô£ö UnlockManager Unit Tests (37.0143ms)
Ô£ö getUnifiedUpgradeCatalog includes upgrades from all active sources (1.7509ms)
Ô£ö getUnifiedUpgradeCatalog entries contain required purchase fields (0.7334ms)
Ô£ö hasUpgrade - checks ownership correctly (1.5789ms)
Ô£ö calcBaseBreakdownChance - no upgrades (0.3398ms)
Ô£ö calcBaseBreakdownChance - undefined upgrades (0.1903ms)
Ô£ö calcBaseBreakdownChance - single upgrade (van_suspension) (0.2491ms)
Ô£ö calcBaseBreakdownChance - multiple upgrades (0.2018ms)
Ô£ö calcBaseBreakdownChance - duplicate upgrades (should not double count) (0.2308ms)
Ô£ö calcBaseBreakdownChance - large reduction (hq_van_tyre_spare) (0.2155ms)
Ô£ö calcBaseBreakdownChance - clamping to zero (0.1954ms)
Ô£ö calcBaseBreakdownChance - prototype pollution attempt (0.2199ms)
Ô£ö calcBaseBreakdownChance - unknown upgrade (0.3318ms)
Ô£ö calcBaseBreakdownChance - mixed known and unknown upgrades (0.2428ms)
[ArrivalLogic] Starting Gig at destination { venue: 'Club' }
(node:5816) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useArrivalLogic
  Ô£ö executes standard arrival sequence (130.0729ms)
  Ô£ö applies harmony regen if upgrade active (20.7252ms)
  Ô£ö handles REST_STOP node (15.3442ms)
  Ô£ö handles GIG node with sufficient harmony (17.6036ms)
  Ô£ö prevents GIG if harmony too low (20.6336ms)
  Ô£ö idempotency guard prevents double execution (19.3476ms)
Ô£ö useArrivalLogic (225.7032ms)
(node:25348) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useAudioControl
  Ô£ö initializes with values from audioManager (119.7105ms)
  Ô£ö setMusic updates music volume and state (20.055ms)
  Ô£ö setMusic does not update state if manager returns false (18.1412ms)
  Ô£ö setMusic handles exceptions (12.53ms)
  Ô£ö setSfx updates sfx volume and state (18.7055ms)
  Ô£ö setSfx handles exceptions (14.8829ms)
  Ô£ö toggleMute toggles mute state (15.0638ms)
  Ô£ö resumeMusic delegates through hook action (34.9528ms)
  Ô£ö stopMusic delegates through hook action (19.6568ms)
  Ô£ö inline selector remains stable across rerenders (39.2463ms)
  Ô£ö selector receives focused state updates (13.0313ms)
  Ô£ö syncs external mute updates across multiple hook instances (20.5964ms)
  Ô£ö polling fallback updates state when subscribe is unavailable (14.8192ms)
  Ô£ö toggleMute handles exceptions (13.8031ms)
Ô£ö useAudioControl (378.0722ms)
(node:12740) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useBandHQModal
  Ô£ö toggles modal state correctly (143.7204ms)
Ô£ö useBandHQModal (144.8334ms)
ÔûÂ useGigEffects
  Ô£ö triggerBandAnimation uses refs instead of DOM query (198.5421ms)
  Ô£ö chaosStyle memoization check (33.8632ms)
Ô£ö useGigEffects (234.4526ms)
(node:10072) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useGigInput
  Ô£ö handleLaneInput calls registerInput and triggerBandAnimation (121.0933ms)
  Ô£ö Escape key toggles pause menu (20.0612ms)
  Ô£ö Lane key triggers input (15.6746ms)
Ô£ö useGigInput (158.6018ms)
ÔûÂ usePurchaseLogic
  Ô£ö handleBuy marks one-time stat_modifier upgrades as owned in van.upgrades (154.1029ms)
  Ô£ö handleBuy prevents duplicate purchase of one-time passive upgrades (22.2921ms)
  Ô£ö handleBuy allows negative values for performance stats (19.1939ms)
  Ô£ö handleBuy applies harmony_regen_travel passive effect using key (15.7888ms)
  Ô£ö handleBuy applies passive_followers passive effect using key (17.115ms)
Ô£ö usePurchaseLogic (230.7643ms)
(node:15904) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useRhythmGameLogic
  Ô£ö initial state (116.023ms)
  Ô£ö initialization runs on mount (218.499ms)
  Ô£ö handleHit updates score (218.4081ms)
  Ô£ö calls endGig when all notes are processed near song end (224.2097ms)
  Ô£ö calls endGig when audio playback reports ended (230.7424ms)
Ô£ö useRhythmGameLogic (1009.6814ms)
(node:17044) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useRhythmGameScoring
  Ô£ö initialization returns handlers (125.21ms)
  Ô£ö handleHit updates score and combo on valid hit (20.587ms)
  Ô£ö handleHit triggers miss on invalid hit (20.1057ms)
  Ô£ö handleHit applies lane multipliers (17.062ms)
  Ô£ö handleMiss resets combo and applies penalties (17.881ms)
  Ô£ö handleMiss triggers game over when health depleted (15.7278ms)
  Ô£ö activateToxicMode sets flag and toast (13.3416ms)
  Ô£ö Toxic Mode applies 4x score multiplier (13.8017ms)
  Ô£ö Real miss deactivates Toxic Mode (14.7885ms)
  Ô£ö Empty hit does not deactivate Toxic Mode (14.0186ms)
  Ô£ö Guestlist modifier increases score (12.002ms)
  Ô£ö Perfektionist trait applies bonus score at high accuracy (11.1604ms)
  Ô£ö Perfektionist trait does not apply bonus score at low accuracy (11.7195ms)
  Ô£ö Overload increases on hit and triggers Toxic Mode when full (12.8467ms)
Ô£ö useRhythmGameScoring (322.8896ms)
(node:35052) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useRoadieLogic
  Ô£ö initializes with correct default state (108.9503ms)
  Ô£ö moves player within bounds (22.4301ms)
  Ô£ö delivers item at venue (13.1142ms)
  Ô£ö picks up item at start (15.3527ms)
  Ô£ö spawns traffic over time (15.6565ms)
  Ô£ö handles collision and damage (17.0886ms)
  Ô£ö triggers game over on completion (11.5512ms)
Ô£ö useRoadieLogic (205.9207ms)
(node:24244) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useTourbusLogic
  ÔûÂ Spawn Rate
    Ô£ö spawn rate maintains constant density (spawns faster at higher speeds) (132.8079ms)
  Ô£ö Spawn Rate (133.8464ms)
  ÔûÂ Movement
    Ô£ö moveLeft decreases lane but clamps at 0 (19.0777ms)
    Ô£ö moveRight increases lane but clamps at LANE_COUNT - 1 (13.8808ms)
  Ô£ö Movement (33.3025ms)
  ÔûÂ Collision & Damage
    Ô£ö collision with OBSTACLE increases damage and plays SFX (12.9755ms)
    Ô£ö collision with FUEL collects item and plays SFX (15.9765ms)
    Ô£ö obstacles are removed when off-screen (15.6335ms)
  Ô£ö Collision & Damage (45.0357ms)
  ÔûÂ Upgrades
    Ô£ö van_armor reduces damage to 2 (16.1176ms)
    Ô£ö van_bullbar reduces damage to 5 (15.3388ms)
    Ô£ö van_armor takes precedence over van_bullbar (18.9084ms)
  Ô£ö Upgrades (50.7545ms)
  ÔûÂ Game Completion
    Ô£ö completes game when target distance reached (16.6109ms)
  Ô£ö Game Completion (16.7801ms)
Ô£ö useTourbusLogic (280.7972ms)
(node:11772) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useTravelLogic Optimization
  Ô£ö handleTravel remains referentially stable when pendingTravelNode changes (112.394ms)
Ô£ö useTravelLogic Optimization (114.0394ms)
(node:39200) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useTravelLogic Performance
  Ô£ö handleTravel remains referentially stable when player money changes (65.6037ms)
Ô£ö useTravelLogic Performance (66.3015ms)
(node:20648) ExperimentalWarning: Module mocking is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
ÔûÂ useTravelLogic
  Ô£ö initial state (59.9601ms)
  Ô£ö handleTravel initiates travel when valid (13.0432ms)
  Ô£ö handleTravel prevents travel if insufficient funds (7.6737ms)
  Ô£ö handleTravel prevents travel if insufficient fuel (7.4622ms)
  Ô£ö handleTravel to current node triggers interaction (7.5253ms)
  Ô£ö onTravelComplete updates state and finalizes travel (8.0034ms)
  Ô£ö handleRefuel fills tank and deducts money (7.0224ms)
  Ô£ö handleRepair fixes van and deducts money (5.793ms)
  Ô£ö handleRefuel does nothing when traveling (7.2511ms)
  Ô£ö handleRepair does nothing when traveling (6.6387ms)
Ô£ö useTravelLogic (131.5885ms)
Ô£ö Van Breakdown: Base breakdown chance with no upgrades and perfect condition (2.1214ms)
Ô£ö Van Breakdown: Condition below 60 increases breakdown chance (0.3264ms)
Ô£ö Van Breakdown: Condition below 30 significantly increases breakdown chance (0.2339ms)
Ô£ö Van Breakdown: Upgrades reduce base breakdown chance (0.1953ms)
Ô£ö Van Breakdown: NO COMPOUNDING - Breakdown chance is stable over multiple days with similar condition (0.304ms)
Ôä╣ tests 945
Ôä╣ suites 127
Ôä╣ pass 943
Ôä╣ fail 2
Ôä╣ cancelled 0
Ôä╣ skipped 0
Ôä╣ todo 0
Ôä╣ duration_ms 23577.9644

Ô£û failing tests:

test at tests\audioProceduralMetal.test.js:1:1
Ô£û tests\audioProceduralMetal.test.js (882.644ms)
  'test failed'

test at tests\audioProceduralPlaySong.test.js:1:1
Ô£û tests\audioProceduralPlaySong.test.js (1372.8232ms)
  'test failed'
