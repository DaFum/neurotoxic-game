
> neurotoxic-game@0.0.0 test
> node --test

TAP version 13
# Subtest: Action Creators
    # Subtest: createChangeSceneAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.890324
          type: 'test'
          ...
        1..1
    ok 1 - createChangeSceneAction
      ---
      duration_ms: 1.760005
      type: 'suite'
      ...
    # Subtest: createUpdatePlayerAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.680663
          type: 'test'
          ...
        1..1
    ok 2 - createUpdatePlayerAction
      ---
      duration_ms: 0.990402
      type: 'suite'
      ...
    # Subtest: createUpdateBandAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.287407
          type: 'test'
          ...
        1..1
    ok 3 - createUpdateBandAction
      ---
      duration_ms: 1.754399
      type: 'suite'
      ...
    # Subtest: createUpdateSocialAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.402202
          type: 'test'
          ...
        1..1
    ok 4 - createUpdateSocialAction
      ---
      duration_ms: 0.603647
      type: 'suite'
      ...
    # Subtest: createUpdateSettingsAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.442239
          type: 'test'
          ...
        1..1
    ok 5 - createUpdateSettingsAction
      ---
      duration_ms: 0.674431
      type: 'suite'
      ...
    # Subtest: createSetMapAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.294039
          type: 'test'
          ...
        1..1
    ok 6 - createSetMapAction
      ---
      duration_ms: 0.415541
      type: 'suite'
      ...
    # Subtest: createSetGigAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.246862
          type: 'test'
          ...
        1..1
    ok 7 - createSetGigAction
      ---
      duration_ms: 0.338111
      type: 'suite'
      ...
    # Subtest: createStartGigAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.166029
          type: 'test'
          ...
        1..1
    ok 8 - createStartGigAction
      ---
      duration_ms: 0.255477
      type: 'suite'
      ...
    # Subtest: createSetSetlistAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.37317
          type: 'test'
          ...
        1..1
    ok 9 - createSetSetlistAction
      ---
      duration_ms: 0.586535
      type: 'suite'
      ...
    # Subtest: createSetLastGigStatsAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.295376
          type: 'test'
          ...
        1..1
    ok 10 - createSetLastGigStatsAction
      ---
      duration_ms: 0.413149
      type: 'suite'
      ...
    # Subtest: createSetActiveEventAction
        # Subtest: should create correct action with event
        ok 1 - should create correct action with event
          ---
          duration_ms: 0.255811
          type: 'test'
          ...
        # Subtest: should create correct action with null
        ok 2 - should create correct action with null
          ---
          duration_ms: 0.136946
          type: 'test'
          ...
        1..2
    ok 11 - createSetActiveEventAction
      ---
      duration_ms: 0.507406
      type: 'suite'
      ...
    # Subtest: createAddToastAction
        # Subtest: should create correct action with default type
        not ok 1 - should create correct action with default type
          ---
          duration_ms: 7.886725
          type: 'test'
          location: '/app/tests/actionCreators.test.js:149:5'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:

              assert.ok(action.payload.id > 0)

          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (file:///app/tests/actionCreators.test.js:155:14)
            Test.runInAsyncScope (node:async_hooks:214:14)
            Test.run (node:internal/test_runner/test:1047:25)
            Test.start (node:internal/test_runner/test:944:17)
            node:internal/test_runner/test:1440:71
            node:internal/per_context/primordials:464:82
            new Promise (<anonymous>)
            new SafePromise (node:internal/per_context/primordials:433:3)
            node:internal/per_context/primordials:464:9
            Array.map (<anonymous>)
          ...
        # Subtest: should create correct action with custom type
        ok 2 - should create correct action with custom type
          ---
          duration_ms: 0.15428
          type: 'test'
          ...
        1..2
    not ok 12 - createAddToastAction
      ---
      duration_ms: 8.221892
      type: 'suite'
      location: '/app/tests/actionCreators.test.js:148:3'
      failureType: 'subtestsFailed'
      error: '1 subtest failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: createRemoveToastAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.177606
          type: 'test'
          ...
        1..1
    ok 13 - createRemoveToastAction
      ---
      duration_ms: 0.252466
      type: 'suite'
      ...
    # Subtest: createSetGigModifiersAction
        # Subtest: should create correct action with object
        ok 1 - should create correct action with object
          ---
          duration_ms: 0.251196
          type: 'test'
          ...
        # Subtest: should create correct action with function
        ok 2 - should create correct action with function
          ---
          duration_ms: 0.128264
          type: 'test'
          ...
        1..2
    ok 14 - createSetGigModifiersAction
      ---
      duration_ms: 0.854004
      type: 'suite'
      ...
    # Subtest: createLoadGameAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.247584
          type: 'test'
          ...
        1..1
    ok 15 - createLoadGameAction
      ---
      duration_ms: 0.338953
      type: 'suite'
      ...
    # Subtest: createResetStateAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.143935
          type: 'test'
          ...
        1..1
    ok 16 - createResetStateAction
      ---
      duration_ms: 0.214464
      type: 'suite'
      ...
    # Subtest: createApplyEventDeltaAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.150675
          type: 'test'
          ...
        1..1
    ok 17 - createApplyEventDeltaAction
      ---
      duration_ms: 0.240228
      type: 'suite'
      ...
    # Subtest: createPopPendingEventAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.140872
          type: 'test'
          ...
        1..1
    ok 18 - createPopPendingEventAction
      ---
      duration_ms: 0.221838
      type: 'suite'
      ...
    # Subtest: createConsumeItemAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.246359
          type: 'test'
          ...
        1..1
    ok 19 - createConsumeItemAction
      ---
      duration_ms: 0.321995
      type: 'suite'
      ...
    # Subtest: createAdvanceDayAction
        # Subtest: should create correct action
        ok 1 - should create correct action
          ---
          duration_ms: 0.141879
          type: 'test'
          ...
        1..1
    ok 20 - createAdvanceDayAction
      ---
      duration_ms: 0.215766
      type: 'suite'
      ...
    1..20
not ok 1 - Action Creators
  ---
  duration_ms: 21.463702
  type: 'suite'
  location: '/app/tests/actionCreators.test.js:31:1'
  failureType: 'subtestsFailed'
  error: '1 subtest failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: AudioManager setup
ok 2 - AudioManager setup # SKIP Skipping Audio Manager tests due to dependency browser requirements: Cannot find package 'howler' imported from /app/src/utils/AudioManager.js
  ---
  duration_ms: 4.192231
  type: 'test'
  ...
# Subtest: CHARACTERS data integrity
ok 3 - CHARACTERS data integrity
  ---
  duration_ms: 1.246233
  type: 'test'
  ...
# Subtest: SONGS_DB data integrity
ok 4 - SONGS_DB data integrity
  ---
  duration_ms: 0.299385
  type: 'test'
  ...
# Subtest: UPGRADES_DB data integrity
ok 5 - UPGRADES_DB data integrity
  ---
  duration_ms: 1.910415
  type: 'test'
  ...
# Subtest: ALL_VENUES data integrity
ok 6 - ALL_VENUES data integrity
  ---
  duration_ms: 0.268694
  type: 'test'
  ...
# Subtest: EVENTS_DB integrity
ok 7 - EVENTS_DB integrity
  ---
  duration_ms: 1.321526
  type: 'test'
  ...
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2527, income: 2812, expenses: 285 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 10 }
# [Economy] Gig Report Generated { net: 1082, income: 1197, expenses: 115 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 1000 }
# [Economy] Gig Report Generated { net: 2120, income: 2425, expenses: 305 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 50 }
# [Economy] Gig Report Generated { net: 1887, income: 2092, expenses: 205 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 50 }
# [Economy] Gig Report Generated { net: 2449, income: 2764, expenses: 315 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 50 }
# [Economy] Gig Report Generated { net: 1414, income: 1519, expenses: 105 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 40, fame: 100 }
# [Economy] Gig Report Generated { net: 2517, income: 2862, expenses: 345 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 95, fame: 100 }
# [Economy] Gig Report Generated { net: 3102, income: 3837, expenses: 735 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 95, fame: 100 }
# [Economy] Gig Report Generated { net: 3102, income: 3837, expenses: 735 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2637, income: 3062, expenses: 425 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2152, income: 2387, expenses: 235 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 90, fame: 200 }
# [Economy] Gig Report Generated { net: 3182, income: 3267, expenses: 85 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 100, fame: 200 }
# [Economy] Gig Report Generated { net: 3333, income: 4138, expenses: 805 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2506, income: 2812, expenses: 306 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2527, income: 2812, expenses: 285 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2507, income: 2812, expenses: 305 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2637, income: 3062, expenses: 425 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 655, income: 700, expenses: 45 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 0, fame: 100 }
# [Economy] Gig Report Generated { net: 2302, income: 2437, expenses: 135 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 100, fame: 100 }
# [Economy] Gig Report Generated { net: 3022, income: 3637, expenses: 615 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2527, income: 2812, expenses: 285 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2637, income: 3062, expenses: 425 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 75, fame: 150 }
# [Economy] Gig Report Generated { net: 2605, income: 2900, expenses: 295 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 85, fame: 5000 }
# [Economy] Gig Report Generated { net: 23055, income: 24450, expenses: 1395 }
# Subtest: calculateGigFinancials handles base case with ticket sales and guarantee
ok 8 - calculateGigFinancials handles base case with ticket sales and guarantee
  ---
  duration_ms: 3.880004
  type: 'test'
  ...
# Subtest: calculateGigFinancials applies fame scaling to fill rate
ok 9 - calculateGigFinancials applies fame scaling to fill rate
  ---
  duration_ms: 1.037766
  type: 'test'
  ...
# Subtest: calculateGigFinancials applies promo boost to fill rate
ok 10 - calculateGigFinancials applies promo boost to fill rate
  ---
  duration_ms: 1.533207
  type: 'test'
  ...
# Subtest: calculateGigFinancials applies price sensitivity penalty
ok 11 - calculateGigFinancials applies price sensitivity penalty
  ---
  duration_ms: 0.670961
  type: 'test'
  ...
# Subtest: calculateGigFinancials scales merch sales with performance
ok 12 - calculateGigFinancials scales merch sales with performance
  ---
  duration_ms: 0.677494
  type: 'test'
  ...
# Subtest: calculateGigFinancials applies S-rank merch bonus
ok 13 - calculateGigFinancials applies S-rank merch bonus
  ---
  duration_ms: 0.691618
  type: 'test'
  ...
# Subtest: calculateGigFinancials penalizes merch sales for misses
ok 14 - calculateGigFinancials penalizes merch sales for misses
  ---
  duration_ms: 0.727263
  type: 'test'
  ...
# Subtest: calculateGigFinancials handles sold out merch gracefully
ok 15 - calculateGigFinancials handles sold out merch gracefully
  ---
  duration_ms: 0.370699
  type: 'test'
  ...
# Subtest: calculateGigFinancials uses all inventory types for sales limit
ok 16 - calculateGigFinancials uses all inventory types for sales limit
  ---
  duration_ms: 0.669091
  type: 'test'
  ...
# Subtest: calculateGigFinancials includes transport costs based on distance
ok 17 - calculateGigFinancials includes transport costs based on distance
  ---
  duration_ms: 0.793402
  type: 'test'
  ...
# Subtest: calculateGigFinancials includes catering when enabled
ok 18 - calculateGigFinancials includes catering when enabled
  ---
  duration_ms: 0.600528
  type: 'test'
  ...
# Subtest: calculateGigFinancials supports new merch key
ok 19 - calculateGigFinancials supports new merch key
  ---
  duration_ms: 2.187628
  type: 'test'
  ...
# Subtest: calculateGigFinancials handles zero capacity venue
ok 20 - calculateGigFinancials handles zero capacity venue
  ---
  duration_ms: 0.483226
  type: 'test'
  ...
# Subtest: calculateGigFinancials handles extreme performance scores
ok 21 - calculateGigFinancials handles extreme performance scores
  ---
  duration_ms: 0.346903
  type: 'test'
  ...
# Subtest: calculateGigFinancials merch table modifier increases sales
ok 22 - calculateGigFinancials merch table modifier increases sales
  ---
  duration_ms: 0.345916
  type: 'test'
  ...
# Subtest: INCOME_CONSTANTS are properly defined
ok 23 - INCOME_CONSTANTS are properly defined
  ---
  duration_ms: 0.113693
  type: 'test'
  ...
# Subtest: EXPENSE_CONSTANTS are properly defined
ok 24 - EXPENSE_CONSTANTS are properly defined
  ---
  duration_ms: 0.095732
  type: 'test'
  ...
# Subtest: calculateGigFinancials net profit matches income minus expenses
ok 25 - calculateGigFinancials net profit matches income minus expenses
  ---
  duration_ms: 0.246268
  type: 'test'
  ...
# Subtest: calculateGigFinancials handles high fame with high price
ok 26 - calculateGigFinancials handles high fame with high price
  ---
  duration_ms: 0.240019
  type: 'test'
  ...
# Subtest: calculateTravelExpenses returns correct cost structure
ok 27 - calculateTravelExpenses returns correct cost structure
  ---
  duration_ms: 0.279429
  type: 'test'
  ...
# [ErrorHandler] Test error {
#   name: 'StateError',
#   message: 'Test error',
#   category: 'state',
#   severity: 'high',
#   context: {},
#   recoverable: true,
#   timestamp: 1770199415849,
#   stack: 'StateError: Test error\\n' +
#     '    at TestContext.<anonymous> (file:///app/tests/errorHandler.test.js:95:19)\\n' +
#     '    at Test.runInAsyncScope (node:async_hooks:214:14)\\n' +
#     '    at Test.run (node:internal/test_runner/test:1047:25)\\n' +
#     '    at async Promise.all (index 0)\\n' +
#     '    at async Suite.run (node:internal/test_runner/test:1442:7)\\n' +
#     '    at async Test.processPendingSubtests (node:internal/test_runner/test:744:7)'
# }
# [ErrorHandler] Regular error {
#   name: 'Error',
#   message: 'Regular error',
#   category: 'unknown',
#   severity: 'medium',
#   context: {},
#   recoverable: true,
#   timestamp: 1770199415854,
#   stack: 'Error: Regular error\\n' +
#     '    at TestContext.<anonymous> (file:///app/tests/errorHandler.test.js:104:19)\\n' +
#     '    at Test.runInAsyncScope (node:async_hooks:214:14)\\n' +
#     '    at Test.run (node:internal/test_runner/test:1047:25)\\n' +
#     '    at async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)'
# }
# [ErrorHandler] Test error {
#   name: 'StateError',
#   message: 'Test error',
#   category: 'state',
#   severity: 'high',
#   context: {},
#   recoverable: true,
#   timestamp: 1770199415855,
#   stack: 'StateError: Test error\\n' +
#     '    at TestContext.<anonymous> (file:///app/tests/errorHandler.test.js:122:19)\\n' +
#     '    at Test.runInAsyncScope (node:async_hooks:214:14)\\n' +
#     '    at Test.run (node:internal/test_runner/test:1047:25)\\n' +
#     '    at async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)'
# }
# [ErrorHandler] Test error {
#   name: 'StateError',
#   message: 'Test error',
#   category: 'state',
#   severity: 'high',
#   context: {},
#   recoverable: true,
#   timestamp: 1770199415855,
#   stack: 'StateError: Test error\\n' +
#     '    at TestContext.<anonymous> (file:///app/tests/errorHandler.test.js:134:19)\\n' +
#     '    at Test.runInAsyncScope (node:async_hooks:214:14)\\n' +
#     '    at Test.run (node:internal/test_runner/test:1047:25)\\n' +
#     '    at async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)'
# }
# [ErrorHandler] Fallback {
#   name: 'Error',
#   message: 'Fallback',
#   category: 'unknown',
#   severity: 'medium',
#   context: {},
#   recoverable: true,
#   timestamp: 1770199415856,
#   stack: 'Error\\n' +
#     '    at TestContext.<anonymous> (file:///app/tests/errorHandler.test.js:141:19)\\n' +
#     '    at Test.runInAsyncScope (node:async_hooks:214:14)\\n' +
#     '    at Test.run (node:internal/test_runner/test:1047:25)\\n' +
#     '    at async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)'
# }
# [ErrorHandler] Error 1 {
#   name: 'GameError',
#   message: 'Error 1',
#   category: 'unknown',
#   severity: 'medium',
#   context: {},
#   recoverable: true,
#   timestamp: 1770199415857,
#   stack: 'GameError: Error 1\\n' +
#     '    at TestContext.<anonymous> (file:///app/tests/errorHandler.test.js:157:17)\\n' +
#     '    at Test.runInAsyncScope (node:async_hooks:214:14)\\n' +
#     '    at Test.run (node:internal/test_runner/test:1047:25)\\n' +
#     '    at async Promise.all (index 0)\\n' +
#     '    at async Suite.run (node:internal/test_runner/test:1442:7)\\n' +
#     '    at async Test.processPendingSubtests (node:internal/test_runner/test:744:7)'
# }
# [ErrorHandler] Error 2 {
#   name: 'GameError',
#   message: 'Error 2',
#   category: 'unknown',
#   severity: 'medium',
#   context: {},
#   recoverable: true,
#   timestamp: 1770199415857,
#   stack: 'GameError: Error 2\\n' +
#     '    at TestContext.<anonymous> (file:///app/tests/errorHandler.test.js:158:17)\\n' +
#     '    at Test.runInAsyncScope (node:async_hooks:214:14)\\n' +
#     '    at Test.run (node:internal/test_runner/test:1047:25)\\n' +
#     '    at async Promise.all (index 0)\\n' +
#     '    at async Suite.run (node:internal/test_runner/test:1442:7)\\n' +
#     '    at async Test.processPendingSubtests (node:internal/test_runner/test:744:7)'
# }
# [ErrorHandler] Error 1 {
#   name: 'GameError',
#   message: 'Error 1',
#   category: 'unknown',
#   severity: 'medium',
#   context: {},
#   recoverable: true,
#   timestamp: 1770199415858,
#   stack: 'GameError: Error 1\\n' +
#     '    at TestContext.<anonymous> (file:///app/tests/errorHandler.test.js:165:17)\\n' +
#     '    at Test.runInAsyncScope (node:async_hooks:214:14)\\n' +
#     '    at Test.run (node:internal/test_runner/test:1047:25)\\n' +
#     '    at async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)'
# }
# [ErrorHandler] Error 1 {
#   name: 'GameError',
#   message: 'Error 1',
#   category: 'unknown',
#   severity: 'medium',
#   context: {},
#   recoverable: true,
#   timestamp: 1770199415858,
#   stack: 'GameError: Error 1\\n' +
#     '    at TestContext.<anonymous> (file:///app/tests/errorHandler.test.js:173:17)\\n' +
#     '    at Test.runInAsyncScope (node:async_hooks:214:14)\\n' +
#     '    at Test.run (node:internal/test_runner/test:1047:25)\\n' +
#     '    at async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)'
# }
# [ErrorHandler] Storage operation failed: test {
#   name: 'StorageError',
#   message: 'Storage operation failed: test',
#   category: 'storage',
#   severity: 'medium',
#   context: { originalError: 'Storage error' },
#   recoverable: true,
#   timestamp: 1770199415860,
#   stack: 'StorageError: Storage operation failed: test\\n' +
#     '    at safeStorageOperation (file:///app/src/utils/errorHandler.js:260:7)\\n' +
#     '    at TestContext.<anonymous> (file:///app/tests/errorHandler.test.js:194:20)\\n' +
#     '    at Test.runInAsyncScope (node:async_hooks:214:14)\\n' +
#     '    at Test.run (node:internal/test_runner/test:1047:25)\\n' +
#     '    at async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)'
# }
# [ErrorHandler] Storage operation failed: test {
#   name: 'StorageError',
#   message: 'Storage operation failed: test',
#   category: 'storage',
#   severity: 'medium',
#   context: { originalError: 'Storage error' },
#   recoverable: true,
#   timestamp: 1770199415860,
#   stack: 'StorageError: Storage operation failed: test\\n' +
#     '    at safeStorageOperation (file:///app/src/utils/errorHandler.js:260:7)\\n' +
#     '    at TestContext.<anonymous> (file:///app/tests/errorHandler.test.js:203:5)\\n' +
#     '    at Test.runInAsyncScope (node:async_hooks:214:14)\\n' +
#     '    at Test.run (node:internal/test_runner/test:1047:25)\\n' +
#     '    at async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)'
# }
# Subtest: Custom Error Classes
    # Subtest: GameError
        # Subtest: should create error with default values
        ok 1 - should create error with default values
          ---
          duration_ms: 1.157304
          type: 'test'
          ...
        # Subtest: should create error with custom options
        ok 2 - should create error with custom options
          ---
          duration_ms: 1.059941
          type: 'test'
          ...
        # Subtest: should convert to log object
        ok 3 - should convert to log object
          ---
          duration_ms: 0.569852
          type: 'test'
          ...
        1..3
    ok 1 - GameError
      ---
      duration_ms: 4.094882
      type: 'suite'
      ...
    # Subtest: StateError
        # Subtest: should have correct defaults
        ok 1 - should have correct defaults
          ---
          duration_ms: 0.307497
          type: 'test'
          ...
        1..1
    ok 2 - StateError
      ---
      duration_ms: 0.479544
      type: 'suite'
      ...
    # Subtest: StorageError
        # Subtest: should have correct defaults
        ok 1 - should have correct defaults
          ---
          duration_ms: 0.566098
          type: 'test'
          ...
        1..1
    ok 3 - StorageError
      ---
      duration_ms: 0.916456
      type: 'suite'
      ...
    # Subtest: GameLogicError
        # Subtest: should have correct defaults
        ok 1 - should have correct defaults
          ---
          duration_ms: 0.500926
          type: 'test'
          ...
        1..1
    ok 4 - GameLogicError
      ---
      duration_ms: 0.830002
      type: 'suite'
      ...
    1..4
ok 28 - Custom Error Classes
  ---
  duration_ms: 7.555345
  type: 'suite'
  ...
# Subtest: handleError
    # Subtest: should log GameError to error log
    ok 1 - should log GameError to error log
      ---
      duration_ms: 3.96276
      type: 'test'
      ...
    # Subtest: should handle regular Error
    ok 2 - should handle regular Error
      ---
      duration_ms: 1.16454
      type: 'test'
      ...
    # Subtest: should call addToast when not silent
    ok 3 - should call addToast when not silent
      ---
      duration_ms: 0.673936
      type: 'test'
      ...
    # Subtest: should not call addToast when silent
    ok 4 - should not call addToast when silent
      ---
      duration_ms: 0.70316
      type: 'test'
      ...
    # Subtest: should use fallback message for errors without message
    ok 5 - should use fallback message for errors without message
      ---
      duration_ms: 0.549842
      type: 'test'
      ...
    1..5
ok 29 - handleError
  ---
  duration_ms: 7.494516
  type: 'suite'
  ...
# Subtest: Error Log
    # Subtest: should maintain error log
    ok 1 - should maintain error log
      ---
      duration_ms: 0.969629
      type: 'test'
      ...
    # Subtest: should clear error log
    ok 2 - should clear error log
      ---
      duration_ms: 0.525672
      type: 'test'
      ...
    # Subtest: should return a copy of error log
    ok 3 - should return a copy of error log
      ---
      duration_ms: 0.809331
      type: 'test'
      ...
    1..3
ok 30 - Error Log
  ---
  duration_ms: 2.47879
  type: 'suite'
  ...
# Subtest: safeStorageOperation
    # Subtest: should return result on success
    ok 1 - should return result on success
      ---
      duration_ms: 0.348143
      type: 'test'
      ...
    # Subtest: should return fallback on error
    ok 2 - should return fallback on error
      ---
      duration_ms: 0.517393
      type: 'test'
      ...
    # Subtest: should log error to error log
    ok 3 - should log error to error log
      ---
      duration_ms: 0.57928
      type: 'test'
      ...
    1..3
ok 31 - safeStorageOperation
  ---
  duration_ms: 1.620919
  type: 'suite'
  ...
# Subtest: ErrorSeverity
    # Subtest: should have all severity levels
    ok 1 - should have all severity levels
      ---
      duration_ms: 0.137086
      type: 'test'
      ...
    1..1
ok 32 - ErrorSeverity
  ---
  duration_ms: 0.218866
  type: 'suite'
  ...
# Subtest: ErrorCategory
    # Subtest: should have all categories
    ok 1 - should have all categories
      ---
      duration_ms: 0.192095
      type: 'test'
      ...
    1..1
ok 33 - ErrorCategory
  ---
  duration_ms: 0.300156
  type: 'suite'
  ...
# Subtest: eventEngine.checkEvent returns null when category not found
ok 34 - eventEngine.checkEvent returns null when category not found
  ---
  duration_ms: 1.876929
  type: 'test'
  ...
# Subtest: eventEngine.checkEvent filters by trigger point
ok 35 - eventEngine.checkEvent filters by trigger point
  ---
  duration_ms: 0.559354
  type: 'test'
  ...
# Subtest: eventEngine.checkEvent respects cooldowns
ok 36 - eventEngine.checkEvent respects cooldowns
  ---
  duration_ms: 0.202393
  type: 'test'
  ...
# Subtest: eventEngine.checkEvent prioritizes pending events
ok 37 - eventEngine.checkEvent prioritizes pending events
  ---
  duration_ms: 0.213556
  type: 'test'
  ...
# Subtest: eventEngine.resolveChoice handles direct effect
ok 38 - eventEngine.resolveChoice handles direct effect
  ---
  duration_ms: 0.3628
  type: 'test'
  ...
# Subtest: eventEngine.resolveChoice handles skill check success
ok 39 - eventEngine.resolveChoice handles skill check success
  ---
  duration_ms: 0.279906
  type: 'test'
  ...
# Subtest: eventEngine.resolveChoice handles skill check failure
ok 40 - eventEngine.resolveChoice handles skill check failure
  ---
  duration_ms: 0.354499
  type: 'test'
  ...
# Subtest: eventEngine.resolveChoice uses luck stat for luck checks
ok 41 - eventEngine.resolveChoice uses luck stat for luck checks
  ---
  duration_ms: 0.215784
  type: 'test'
  ...
# Subtest: eventEngine.resolveChoice uses max member skill
ok 42 - eventEngine.resolveChoice uses max member skill
  ---
  duration_ms: 2.537161
  type: 'test'
  ...
# Subtest: eventEngine.resolveChoice preserves nextEventId
ok 43 - eventEngine.resolveChoice preserves nextEventId
  ---
  duration_ms: 0.557485
  type: 'test'
  ...
# Subtest: eventEngine.processOptions returns event when no processing needed
ok 44 - eventEngine.processOptions returns event when no processing needed
  ---
  duration_ms: 0.359809
  type: 'test'
  ...
# Subtest: eventEngine.processOptions handles van_breakdown with spare_tire
ok 45 - eventEngine.processOptions handles van_breakdown with spare_tire
  ---
  duration_ms: 0.212294
  type: 'test'
  ...
# Subtest: eventEngine.processOptions does not add spare tire option without inventory
ok 46 - eventEngine.processOptions does not add spare tire option without inventory
  ---
  duration_ms: 0.139829
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles resource effects
ok 47 - eventEngine.applyResult handles resource effects
  ---
  duration_ms: 0.302892
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles stat effects
ok 48 - eventEngine.applyResult handles stat effects
  ---
  duration_ms: 0.169366
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles harmony stat
ok 49 - eventEngine.applyResult handles harmony stat
  ---
  duration_ms: 0.115972
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles mood changes
ok 50 - eventEngine.applyResult handles mood changes
  ---
  duration_ms: 0.111149
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles stamina changes
ok 51 - eventEngine.applyResult handles stamina changes
  ---
  duration_ms: 0.106535
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles van fuel
ok 52 - eventEngine.applyResult handles van fuel
  ---
  duration_ms: 0.160817
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles van condition stat
ok 53 - eventEngine.applyResult handles van condition stat
  ---
  duration_ms: 0.112973
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles game over flag
ok 54 - eventEngine.applyResult handles game over flag
  ---
  duration_ms: 0.168214
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles story flags
ok 55 - eventEngine.applyResult handles story flags
  ---
  duration_ms: 0.190004
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles chain events
ok 56 - eventEngine.applyResult handles chain events
  ---
  duration_ms: 0.114965
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles composite effects
ok 57 - eventEngine.applyResult handles composite effects
  ---
  duration_ms: 0.171399
  type: 'test'
  ...
# Subtest: eventEngine.applyResult returns null for null result
ok 58 - eventEngine.applyResult returns null for null result
  ---
  duration_ms: 0.092917
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles unlock effects
ok 59 - eventEngine.applyResult handles unlock effects
  ---
  duration_ms: 0.107414
  type: 'test'
  ...
# Subtest: eventEngine.applyResult preserves nextEventId from result
ok 60 - eventEngine.applyResult preserves nextEventId from result
  ---
  duration_ms: 0.169711
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles time stat
ok 61 - eventEngine.applyResult handles time stat
  ---
  duration_ms: 0.122583
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles viral stat
ok 62 - eventEngine.applyResult handles viral stat
  ---
  duration_ms: 0.113834
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles inventory numeric increment
ok 63 - eventEngine.applyResult handles inventory numeric increment
  ---
  duration_ms: 0.133678
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles inventory non-numeric value
ok 64 - eventEngine.applyResult handles inventory non-numeric value
  ---
  duration_ms: 0.114853
  type: 'test'
  ...
# Subtest: eventEngine logic for inventory increment handles existing values
ok 65 - eventEngine logic for inventory increment handles existing values
  ---
  duration_ms: 0.12686
  type: 'test'
  ...
# Subtest: eventEngine logic allows negative inventory in delta
ok 66 - eventEngine logic allows negative inventory in delta
  ---
  duration_ms: 0.100429
  type: 'test'
  ...
# Subtest: resolveEventChoice returns delta for direct effects
ok 67 - resolveEventChoice returns delta for direct effects
  ---
  duration_ms: 1.792732
  type: 'test'
  ...
# Subtest: resolveEventChoice handles missing choices safely
ok 68 - resolveEventChoice handles missing choices safely
  ---
  duration_ms: 0.302071
  type: 'test'
  ...
# [GameState] Scene Change: MENU -> OVERWORLD
# [GameState] Scene Change: MENU -> OVERWORLD
# [GameState] Update Player { money: 1000 }
# [GameState] Update Player { fame: 50 }
# [GameState] Update Player { money: 1000 }
# [GameState] Update Band { harmony: 50 }
# [GameState] Update Band { members: [ { name: 'Test', mood: 100, stamina: 100 } ] }
# [GameState] State Reset (Debug)
# [GameState] Game Loaded
# [GameState] Game Loaded
# [GameState] Game Loaded
# Subtest: gameReducer
    # Subtest: CHANGE_SCENE
        # Subtest: should change the current scene
        ok 1 - should change the current scene
          ---
          duration_ms: 3.060828
          type: 'test'
          ...
        # Subtest: should preserve other state properties
        ok 2 - should preserve other state properties
          ---
          duration_ms: 0.547166
          type: 'test'
          ...
        1..2
    ok 1 - CHANGE_SCENE
      ---
      duration_ms: 4.780429
      type: 'suite'
      ...
    # Subtest: UPDATE_PLAYER
        # Subtest: should update player money
        ok 1 - should update player money
          ---
          duration_ms: 0.909845
          type: 'test'
          ...
        # Subtest: should update player fame
        ok 2 - should update player fame
          ---
          duration_ms: 2.500487
          type: 'test'
          ...
        # Subtest: should merge player updates with existing state
        ok 3 - should merge player updates with existing state
          ---
          duration_ms: 0.756143
          type: 'test'
          ...
        1..3
    ok 2 - UPDATE_PLAYER
      ---
      duration_ms: 4.473569
      type: 'suite'
      ...
    # Subtest: UPDATE_BAND
        # Subtest: should update band harmony
        ok 1 - should update band harmony
          ---
          duration_ms: 0.485836
          type: 'test'
          ...
        # Subtest: should update band members
        ok 2 - should update band members
          ---
          duration_ms: 0.729636
          type: 'test'
          ...
        1..2
    ok 3 - UPDATE_BAND
      ---
      duration_ms: 1.458271
      type: 'suite'
      ...
    # Subtest: UPDATE_SOCIAL
        # Subtest: should update social media followers
        ok 1 - should update social media followers
          ---
          duration_ms: 0.333906
          type: 'test'
          ...
        # Subtest: should preserve other social stats
        ok 2 - should preserve other social stats
          ---
          duration_ms: 0.430089
          type: 'test'
          ...
        1..2
    ok 4 - UPDATE_SOCIAL
      ---
      duration_ms: 0.920643
      type: 'suite'
      ...
    # Subtest: SET_GIG_MODIFIERS
        # Subtest: should update gig modifiers with object payload
        ok 1 - should update gig modifiers with object payload
          ---
          duration_ms: 0.412601
          type: 'test'
          ...
        # Subtest: should update gig modifiers with function payload
        ok 2 - should update gig modifiers with function payload
          ---
          duration_ms: 0.229612
          type: 'test'
          ...
        1..2
    ok 5 - SET_GIG_MODIFIERS
      ---
      duration_ms: 0.765452
      type: 'suite'
      ...
    # Subtest: ADD_TOAST
        # Subtest: should add toast to array
        ok 1 - should add toast to array
          ---
          duration_ms: 0.213869
          type: 'test'
          ...
        1..1
    ok 6 - ADD_TOAST
      ---
      duration_ms: 0.341972
      type: 'suite'
      ...
    # Subtest: REMOVE_TOAST
        # Subtest: should remove toast by id
        ok 1 - should remove toast by id
          ---
          duration_ms: 0.24016
          type: 'test'
          ...
        1..1
    ok 7 - REMOVE_TOAST
      ---
      duration_ms: 0.322391
      type: 'suite'
      ...
    # Subtest: CONSUME_ITEM
        # Subtest: should decrement numeric inventory item
        ok 1 - should decrement numeric inventory item
          ---
          duration_ms: 0.290455
          type: 'test'
          ...
        # Subtest: should set boolean inventory item to false
        ok 2 - should set boolean inventory item to false
          ---
          duration_ms: 0.355324
          type: 'test'
          ...
        # Subtest: should not go below zero
        ok 3 - should not go below zero
          ---
          duration_ms: 0.196826
          type: 'test'
          ...
        1..3
    ok 8 - CONSUME_ITEM
      ---
      duration_ms: 0.98982
      type: 'suite'
      ...
    # Subtest: RESET_STATE
        # Subtest: should reset to initial state
        ok 1 - should reset to initial state
          ---
          duration_ms: 1.854374
          type: 'test'
          ...
        1..1
    ok 9 - RESET_STATE
      ---
      duration_ms: 1.946959
      type: 'suite'
      ...
    # Subtest: LOAD_GAME
        # Subtest: should load saved state
        ok 1 - should load saved state
          ---
          duration_ms: 0.788682
          type: 'test'
          ...
        # Subtest: should migrate energy to catering in gigModifiers
        ok 2 - should migrate energy to catering in gigModifiers
          ---
          duration_ms: 0.366735
          type: 'test'
          ...
        # Subtest: should merge with default values for missing properties
        ok 3 - should merge with default values for missing properties
          ---
          duration_ms: 0.396875
          type: 'test'
          ...
        1..3
    ok 10 - LOAD_GAME
      ---
      duration_ms: 1.742903
      type: 'suite'
      ...
    # Subtest: unknown action
        # Subtest: should return current state for unknown action
        ok 1 - should return current state for unknown action
          ---
          duration_ms: 0.631079
          type: 'test'
          ...
        1..1
    ok 11 - unknown action
      ---
      duration_ms: 0.73972
      type: 'suite'
      ...
    1..11
ok 69 - gameReducer
  ---
  duration_ms: 20.777956
  type: 'suite'
  ...
# Subtest: ActionTypes
    # Subtest: should have all expected action types
    ok 1 - should have all expected action types
      ---
      duration_ms: 0.324581
      type: 'test'
      ...
    1..1
ok 70 - ActionTypes
  ---
  duration_ms: 0.417311
  type: 'suite'
  ...
# Subtest: applyEventDelta clamps player and band values
ok 71 - applyEventDelta clamps player and band values
  ---
  duration_ms: 1.487037
  type: 'test'
  ...
# Subtest: applyEventDelta updates social channels safely
ok 72 - applyEventDelta updates social channels safely
  ---
  duration_ms: 0.306758
  type: 'test'
  ...
# Subtest: applyEventDelta applies player updates
ok 73 - applyEventDelta applies player updates
  ---
  duration_ms: 1.774431
  type: 'test'
  ...
# Subtest: applyEventDelta clamps values
ok 74 - applyEventDelta clamps values
  ---
  duration_ms: 0.395076
  type: 'test'
  ...
# Subtest: applyEventDelta handles band inventory updates
ok 75 - applyEventDelta handles band inventory updates
  ---
  duration_ms: 0.327522
  type: 'test'
  ...
# Subtest: applyEventDelta handles social updates
ok 76 - applyEventDelta handles social updates
  ---
  duration_ms: 0.242496
  type: 'test'
  ...
# Subtest: applyEventDelta handles flags
ok 77 - applyEventDelta handles flags
  ---
  duration_ms: 0.316674
  type: 'test'
  ...
# Subtest: updateGigPerformanceStats tracks peak combo and hype
ok 78 - updateGigPerformanceStats tracks peak combo and hype
  ---
  duration_ms: 1.21108
  type: 'test'
  ...
# Subtest: buildGigStatsSnapshot includes required economy fields
ok 79 - buildGigStatsSnapshot includes required economy fields
  ---
  duration_ms: 1.074637
  type: 'test'
  ...
# Subtest: HQ Items Data Integrity
    # Subtest: validates all gear items
    ok 1 - validates all gear items
      ---
      duration_ms: 1.319912
      type: 'test'
      ...
    # Subtest: validates all instrument items
    ok 2 - validates all instrument items
      ---
      duration_ms: 0.384131
      type: 'test'
      ...
    # Subtest: validates all van items
    ok 3 - validates all van items
      ---
      duration_ms: 0.39149
      type: 'test'
      ...
    # Subtest: validates all hq items
    ok 4 - validates all hq items
      ---
      duration_ms: 0.224175
      type: 'test'
      ...
    1..4
ok 80 - HQ Items Data Integrity
  ---
  duration_ms: 5.687181
  type: 'suite'
  ...
# Subtest: getGenImageUrl returns correct URL structure
ok 81 - getGenImageUrl returns correct URL structure
  ---
  duration_ms: 1.325264
  type: 'test'
  ...
# Subtest: IMG_PROMPTS object exists
ok 82 - IMG_PROMPTS object exists
  ---
  duration_ms: 0.229883
  type: 'test'
  ...
# Subtest: MapGenerator generates a map with correct structure
ok 83 - MapGenerator generates a map with correct structure
  ---
  duration_ms: 12.923199
  type: 'test'
  ...
# Subtest: MapGenerator guarantees start node
ok 84 - MapGenerator guarantees start node
  ---
  duration_ms: 9.693617
  type: 'test'
  ...
# Subtest: MapGenerator guarantees finale node
ok 85 - MapGenerator guarantees finale node
  ---
  duration_ms: 1.933019
  type: 'test'
  ...
# Subtest: MapGenerator connections are valid
ok 86 - MapGenerator connections are valid
  ---
  duration_ms: 4.307131
  type: 'test'
  ...
# Subtest: MapGenerator ensures nodes do not overlap
ok 87 - MapGenerator ensures nodes do not overlap
  ---
  duration_ms: 3.387978
  type: 'test'
  ...
# Duplicate found: MTC (Layer 2)
# Subtest: MapGenerator should not have duplicate venues (if possible)
ok 88 - MapGenerator should not have duplicate venues (if possible)
  ---
  duration_ms: 18.349077
  type: 'test'
  ...
# Subtest: calculateNoteY returns target position at hit time
ok 89 - calculateNoteY returns target position at hit time
  ---
  duration_ms: 1.141356
  type: 'test'
  ...
# Subtest: calculateCrowdY offsets by combo intensity
ok 90 - calculateCrowdY offsets by combo intensity
  ---
  duration_ms: 0.370495
  type: 'test'
  ...
# Subtest: calculateLaneStartX centers lanes
ok 91 - calculateLaneStartX centers lanes
  ---
  duration_ms: 0.241019
  type: 'test'
  ...
# Subtest: buildRhythmLayout derives lane and hit line positions
ok 92 - buildRhythmLayout derives lane and hit line positions
  ---
  duration_ms: 0.284794
  type: 'test'
  ...
# Subtest: checkHit finds matching note within window
ok 93 - checkHit finds matching note within window
  ---
  duration_ms: 1.418206
  type: 'test'
  ...
# Subtest: checkHit ignores notes outside window
ok 94 - checkHit ignores notes outside window
  ---
  duration_ms: 0.223584
  type: 'test'
  ...
# Subtest: checkHit ignores wrong lane
ok 95 - checkHit ignores wrong lane
  ---
  duration_ms: 0.244898
  type: 'test'
  ...
# Subtest: checkHit ignores already hit or invisible notes
ok 96 - checkHit ignores already hit or invisible notes
  ---
  duration_ms: 0.29008
  type: 'test'
  ...
# Subtest: checkHit prioritizes closest note?
ok 97 - checkHit prioritizes closest note?
  ---
  duration_ms: 0.213816
  type: 'test'
  ...
# Subtest: generateNotesForSong creates correct note structure
ok 98 - generateNotesForSong creates correct note structure
  ---
  duration_ms: 2.497371
  type: 'test'
  ...
# Subtest: generateNotesForSong respects difficulty
ok 99 - generateNotesForSong respects difficulty
  ---
  duration_ms: 0.304352
  type: 'test'
  ...
# Subtest: getGigModifiers returns default modifiers for average band
ok 100 - getGigModifiers returns default modifiers for average band
  ---
  duration_ms: 2.229794
  type: 'test'
  ...
# Subtest: getGigModifiers grants telepathy bonus for high harmony
ok 101 - getGigModifiers grants telepathy bonus for high harmony
  ---
  duration_ms: 0.401136
  type: 'test'
  ...
# Subtest: getGigModifiers applies disconnect penalty for low harmony
ok 102 - getGigModifiers applies disconnect penalty for low harmony
  ---
  duration_ms: 0.270719
  type: 'test'
  ...
# Subtest: getGigModifiers has no special effects for mid harmony
ok 103 - getGigModifiers has no special effects for mid harmony
  ---
  duration_ms: 0.196079
  type: 'test'
  ...
# Subtest: getGigModifiers applies grumpy Matze penalty
ok 104 - getGigModifiers applies grumpy Matze penalty
  ---
  duration_ms: 0.435296
  type: 'test'
  ...
# Subtest: getGigModifiers does not apply Matze penalty when mood is okay
ok 105 - getGigModifiers does not apply Matze penalty when mood is okay
  ---
  duration_ms: 0.250802
  type: 'test'
  ...
# Subtest: getGigModifiers applies tired Lars speed increase
ok 106 - getGigModifiers applies tired Lars speed increase
  ---
  duration_ms: 0.383005
  type: 'test'
  ...
# Subtest: getGigModifiers does not apply Lars penalty when stamina is okay
ok 107 - getGigModifiers does not apply Lars penalty when stamina is okay
  ---
  duration_ms: 0.246758
  type: 'test'
  ...
# Subtest: getGigModifiers can apply multiple effects
ok 108 - getGigModifiers can apply multiple effects
  ---
  duration_ms: 0.655305
  type: 'test'
  ...
# Subtest: calculateGigPhysics returns physics object
ok 109 - calculateGigPhysics returns physics object
  ---
  duration_ms: 0.804271
  type: 'test'
  ...
# Subtest: calculateGigPhysics calculates hit windows based on skill
ok 110 - calculateGigPhysics calculates hit windows based on skill
  ---
  duration_ms: 0.298554
  type: 'test'
  ...
# Subtest: calculateGigPhysics skill increases hit windows
ok 111 - calculateGigPhysics skill increases hit windows
  ---
  duration_ms: 0.24513
  type: 'test'
  ...
# Subtest: calculateGigPhysics reduces speed for low stamina
ok 112 - calculateGigPhysics reduces speed for low stamina
  ---
  duration_ms: 0.188001
  type: 'test'
  ...
# Subtest: calculateGigPhysics normal speed for adequate stamina
ok 113 - calculateGigPhysics normal speed for adequate stamina
  ---
  duration_ms: 0.165536
  type: 'test'
  ...
# Subtest: calculateGigPhysics returns default multipliers
ok 114 - calculateGigPhysics returns default multipliers
  ---
  duration_ms: 0.143153
  type: 'test'
  ...
# Subtest: calculateGigPhysics applies blast machine trait for fast songs
ok 115 - calculateGigPhysics applies blast machine trait for fast songs
  ---
  duration_ms: 0.238396
  type: 'test'
  ...
# Subtest: calculateGigPhysics does not apply blast machine for slow songs
ok 116 - calculateGigPhysics does not apply blast machine for slow songs
  ---
  duration_ms: 0.165647
  type: 'test'
  ...
# Subtest: calculateGigPhysics includes avgStamina in result
ok 117 - calculateGigPhysics includes avgStamina in result
  ---
  duration_ms: 2.193522
  type: 'test'
  ...
# Subtest: calculateGigPhysics handles missing member gracefully
ok 118 - calculateGigPhysics handles missing member gracefully
  ---
  duration_ms: 0.182134
  type: 'test'
  ...
# Subtest: calculateGigPhysics handles missing skill property
ok 119 - calculateGigPhysics handles missing skill property
  ---
  duration_ms: 0.202368
  type: 'test'
  ...
# Subtest: Game Loop Logic Simulation
    # Subtest: Phase 1: Travel (Overworld)
    ok 1 - Phase 1: Travel (Overworld)
      ---
      duration_ms: 1.318825
      type: 'test'
      ...
    # Subtest: Phase 2: Refuel (Overworld)
    ok 2 - Phase 2: Refuel (Overworld)
      ---
      duration_ms: 0.242738
      type: 'test'
      ...
    # Subtest: Phase 3: Gig (PostGig)
    ok 3 - Phase 3: Gig (PostGig)
      ---
      duration_ms: 2.031923
      type: 'test'
      ...
    # Subtest: Phase 4: Next Travel Cycle
    ok 4 - Phase 4: Next Travel Cycle
      ---
      duration_ms: 0.311806
      type: 'test'
      ...
    1..4
ok 120 - Game Loop Logic Simulation
  ---
  duration_ms: 5.861247
  type: 'test'
  ...
# Subtest: SOCIAL_PLATFORMS contains expected platforms
ok 121 - SOCIAL_PLATFORMS contains expected platforms
  ---
  duration_ms: 3.498169
  type: 'test'
  ...
# Subtest: SOCIAL_PLATFORMS have multipliers
ok 122 - SOCIAL_PLATFORMS have multipliers
  ---
  duration_ms: 0.29598
  type: 'test'
  ...
# Subtest: calculateViralityScore returns base chance for average performance
ok 123 - calculateViralityScore returns base chance for average performance
  ---
  duration_ms: 0.267524
  type: 'test'
  ...
# Subtest: calculateViralityScore increases with high performance
ok 124 - calculateViralityScore increases with high performance
  ---
  duration_ms: 0.260289
  type: 'test'
  ...
# Subtest: calculateViralityScore applies performance multipliers
ok 125 - calculateViralityScore applies performance multipliers
  ---
  duration_ms: 0.289838
  type: 'test'
  ...
# Subtest: calculateViralityScore boosts for Kaminstube venue
ok 126 - calculateViralityScore boosts for Kaminstube venue
  ---
  duration_ms: 0.203932
  type: 'test'
  ...
# Subtest: calculateViralityScore boosts for stage diver event
ok 127 - calculateViralityScore boosts for stage diver event
  ---
  duration_ms: 0.329469
  type: 'test'
  ...
# Subtest: calculateViralityScore boosts for influencer event
ok 128 - calculateViralityScore boosts for influencer event
  ---
  duration_ms: 0.183467
  type: 'test'
  ...
# Subtest: calculateViralityScore is capped at 90%
ok 129 - calculateViralityScore is capped at 90%
  ---
  duration_ms: 0.578896
  type: 'test'
  ...
# Subtest: calculateViralityScore combines multiple bonuses
ok 130 - calculateViralityScore combines multiple bonuses
  ---
  duration_ms: 0.560744
  type: 'test'
  ...
# Subtest: generatePostOptions returns array of options
ok 131 - generatePostOptions returns array of options
  ---
  duration_ms: 0.392511
  type: 'test'
  ...
# Subtest: generatePostOptions includes moshpit option
ok 132 - generatePostOptions includes moshpit option
  ---
  duration_ms: 0.18819
  type: 'test'
  ...
# Subtest: generatePostOptions includes technical option
ok 133 - generatePostOptions includes technical option
  ---
  duration_ms: 0.187481
  type: 'test'
  ...
# Subtest: generatePostOptions includes band pic option
ok 134 - generatePostOptions includes band pic option
  ---
  duration_ms: 0.196755
  type: 'test'
  ...
# Subtest: generatePostOptions scales mosh viral chance
ok 135 - generatePostOptions scales mosh viral chance
  ---
  duration_ms: 0.187191
  type: 'test'
  ...
# Subtest: generatePostOptions all have required properties
ok 136 - generatePostOptions all have required properties
  ---
  duration_ms: 0.169869
  type: 'test'
  ...
# Subtest: resolvePost handles viral success
ok 137 - resolvePost handles viral success
  ---
  duration_ms: 0.282856
  type: 'test'
  ...
# Subtest: resolvePost handles non-viral post
ok 138 - resolvePost handles non-viral post
  ---
  duration_ms: 0.151626
  type: 'test'
  ...
# Subtest: resolvePost viral multiplies by 10
ok 139 - resolvePost viral multiplies by 10
  ---
  duration_ms: 0.149804
  type: 'test'
  ...
# Subtest: resolvePost handles edge case of 0 base followers
ok 140 - resolvePost handles edge case of 0 base followers
  ---
  duration_ms: 1.498445
  type: 'test'
  ...
# Subtest: resolvePost threshold at exact viral chance
ok 141 - resolvePost threshold at exact viral chance
  ---
  duration_ms: 0.132952
  type: 'test'
  ...
# Subtest: resolvePost preserves all platforms
ok 142 - resolvePost preserves all platforms
  ---
  duration_ms: 0.226367
  type: 'test'
  ...
# Subtest: resolvePost returns consistent structure
ok 143 - resolvePost returns consistent structure
  ---
  duration_ms: 0.132742
  type: 'test'
  ...
# Subtest: calculateViralityScore handles low performance
ok 144 - calculateViralityScore handles low performance
  ---
  duration_ms: 0.105836
  type: 'test'
  ...
# Subtest: generatePostOptions viral chances are reasonable
ok 145 - generatePostOptions viral chances are reasonable
  ---
  duration_ms: 0.332349
  type: 'test'
  ...
1..145
# tests 207
# suites 45
# pass 205
# fail 1
# cancelled 0
# skipped 1
# todo 0
# duration_ms 807.323729
