
> neurotoxic-game@0.0.0 test
> node --test

TAP version 13
# Subtest: AudioManager setup
ok 1 - AudioManager setup # SKIP Skipping Audio Manager tests due to dependency browser requirements: Cannot find package 'howler' imported from /app/src/utils/AudioManager.js
  ---
  duration_ms: 4.031399
  type: 'test'
  ...
# Subtest: CHARACTERS data integrity
ok 2 - CHARACTERS data integrity
  ---
  duration_ms: 1.559274
  type: 'test'
  ...
# Subtest: SONGS_DB data integrity
ok 3 - SONGS_DB data integrity
  ---
  duration_ms: 0.51728
  type: 'test'
  ...
# Subtest: UPGRADES_DB data integrity
ok 4 - UPGRADES_DB data integrity
  ---
  duration_ms: 2.287523
  type: 'test'
  ...
# Subtest: ALL_VENUES data integrity
ok 5 - ALL_VENUES data integrity
  ---
  duration_ms: 0.397061
  type: 'test'
  ...
# Subtest: EVENTS_DB integrity
ok 6 - EVENTS_DB integrity
  ---
  duration_ms: 1.779668
  type: 'test'
  ...
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2527, income: 2812, expenses: 285 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 10 }
# [Economy] Gig Report Generated { net: 1082, income: 1197, expenses: 115 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 1000 }
# [Economy] Gig Report Generated { net: 2120, income: 2425, expenses: 305 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 50 }
# [Economy] Gig Report Generated { net: 1887, income: 2092, expenses: 205 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 50 }
# [Economy] Gig Report Generated { net: 2449, income: 2764, expenses: 315 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 50 }
# [Economy] Gig Report Generated { net: 1414, income: 1519, expenses: 105 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 40, fame: 100 }
# [Economy] Gig Report Generated { net: 2517, income: 2862, expenses: 345 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 95, fame: 100 }
# [Economy] Gig Report Generated { net: 3102, income: 3837, expenses: 735 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 95, fame: 100 }
# [Economy] Gig Report Generated { net: 3102, income: 3837, expenses: 735 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2637, income: 3062, expenses: 425 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2152, income: 2387, expenses: 235 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 90, fame: 200 }
# [Economy] Gig Report Generated { net: 3182, income: 3267, expenses: 85 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 100, fame: 200 }
# [Economy] Gig Report Generated { net: 3333, income: 4138, expenses: 805 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2506, income: 2812, expenses: 306 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2527, income: 2812, expenses: 285 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2507, income: 2812, expenses: 305 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2637, income: 3062, expenses: 425 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 655, income: 700, expenses: 45 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 0, fame: 100 }
# [Economy] Gig Report Generated { net: 2302, income: 2437, expenses: 135 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 100, fame: 100 }
# [Economy] Gig Report Generated { net: 3022, income: 3637, expenses: 615 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2527, income: 2812, expenses: 285 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 80, fame: 100 }
# [Economy] Gig Report Generated { net: 2637, income: 3062, expenses: 425 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 75, fame: 150 }
# [Economy] Gig Report Generated { net: 2605, income: 2900, expenses: 295 }
# [Economy] Calculating Gig Financials { gig: undefined, score: 85, fame: 5000 }
# [Economy] Gig Report Generated { net: 23055, income: 24450, expenses: 1395 }
# Subtest: calculateGigFinancials handles base case with ticket sales and guarantee
ok 7 - calculateGigFinancials handles base case with ticket sales and guarantee
  ---
  duration_ms: 4.655826
  type: 'test'
  ...
# Subtest: calculateGigFinancials applies fame scaling to fill rate
ok 8 - calculateGigFinancials applies fame scaling to fill rate
  ---
  duration_ms: 1.164754
  type: 'test'
  ...
# Subtest: calculateGigFinancials applies promo boost to fill rate
ok 9 - calculateGigFinancials applies promo boost to fill rate
  ---
  duration_ms: 1.88201
  type: 'test'
  ...
# Subtest: calculateGigFinancials applies price sensitivity penalty
ok 10 - calculateGigFinancials applies price sensitivity penalty
  ---
  duration_ms: 0.552199
  type: 'test'
  ...
# Subtest: calculateGigFinancials scales merch sales with performance
ok 11 - calculateGigFinancials scales merch sales with performance
  ---
  duration_ms: 0.743141
  type: 'test'
  ...
# Subtest: calculateGigFinancials applies S-rank merch bonus
ok 12 - calculateGigFinancials applies S-rank merch bonus
  ---
  duration_ms: 0.644673
  type: 'test'
  ...
# Subtest: calculateGigFinancials penalizes merch sales for misses
ok 13 - calculateGigFinancials penalizes merch sales for misses
  ---
  duration_ms: 0.827216
  type: 'test'
  ...
# Subtest: calculateGigFinancials handles sold out merch gracefully
ok 14 - calculateGigFinancials handles sold out merch gracefully
  ---
  duration_ms: 0.541144
  type: 'test'
  ...
# Subtest: calculateGigFinancials uses all inventory types for sales limit
ok 15 - calculateGigFinancials uses all inventory types for sales limit
  ---
  duration_ms: 0.727252
  type: 'test'
  ...
# Subtest: calculateGigFinancials includes transport costs based on distance
ok 16 - calculateGigFinancials includes transport costs based on distance
  ---
  duration_ms: 0.873159
  type: 'test'
  ...
# Subtest: calculateGigFinancials includes catering when enabled
ok 17 - calculateGigFinancials includes catering when enabled
  ---
  duration_ms: 0.53392
  type: 'test'
  ...
# Subtest: calculateGigFinancials supports new merch key
ok 18 - calculateGigFinancials supports new merch key
  ---
  duration_ms: 0.458955
  type: 'test'
  ...
# Subtest: calculateGigFinancials handles zero capacity venue
ok 19 - calculateGigFinancials handles zero capacity venue
  ---
  duration_ms: 2.483696
  type: 'test'
  ...
# Subtest: calculateGigFinancials handles extreme performance scores
ok 20 - calculateGigFinancials handles extreme performance scores
  ---
  duration_ms: 0.385547
  type: 'test'
  ...
# Subtest: calculateGigFinancials merch table modifier increases sales
ok 21 - calculateGigFinancials merch table modifier increases sales
  ---
  duration_ms: 0.323426
  type: 'test'
  ...
# Subtest: INCOME_CONSTANTS are properly defined
ok 22 - INCOME_CONSTANTS are properly defined
  ---
  duration_ms: 0.109694
  type: 'test'
  ...
# Subtest: EXPENSE_CONSTANTS are properly defined
ok 23 - EXPENSE_CONSTANTS are properly defined
  ---
  duration_ms: 0.096896
  type: 'test'
  ...
# Subtest: calculateGigFinancials net profit matches income minus expenses
ok 24 - calculateGigFinancials net profit matches income minus expenses
  ---
  duration_ms: 0.410845
  type: 'test'
  ...
# Subtest: calculateGigFinancials handles high fame with high price
ok 25 - calculateGigFinancials handles high fame with high price
  ---
  duration_ms: 0.290273
  type: 'test'
  ...
# Subtest: calculateTravelExpenses returns correct cost structure
not ok 26 - calculateTravelExpenses returns correct cost structure
  ---
  duration_ms: 1.404164
  type: 'test'
  location: '/app/tests/economyEngine.test.js:551:1'
  failureType: 'testCodeFailure'
  error: |-
    Distance should be 50 for center node

    20 !== 50

  code: 'ERR_ASSERTION'
  name: 'AssertionError'
  expected: 50
  actual: 20
  operator: 'strictEqual'
  stack: |-
    TestContext.<anonymous> (file:///app/tests/economyEngine.test.js:562:10)
    Test.runInAsyncScope (node:async_hooks:214:14)
    Test.run (node:internal/test_runner/test:1047:25)
    Test.processPendingSubtests (node:internal/test_runner/test:744:18)
    Test.postRun (node:internal/test_runner/test:1173:19)
    Test.run (node:internal/test_runner/test:1101:12)
    async Test.processPendingSubtests (node:internal/test_runner/test:744:7)
  ...
# Subtest: eventEngine.checkEvent returns null when category not found
ok 27 - eventEngine.checkEvent returns null when category not found
  ---
  duration_ms: 2.035073
  type: 'test'
  ...
# Subtest: eventEngine.checkEvent filters by trigger point
ok 28 - eventEngine.checkEvent filters by trigger point
  ---
  duration_ms: 0.579194
  type: 'test'
  ...
# Subtest: eventEngine.checkEvent respects cooldowns
ok 29 - eventEngine.checkEvent respects cooldowns
  ---
  duration_ms: 0.212238
  type: 'test'
  ...
# Subtest: eventEngine.checkEvent prioritizes pending events
ok 30 - eventEngine.checkEvent prioritizes pending events
  ---
  duration_ms: 0.192418
  type: 'test'
  ...
# Subtest: eventEngine.resolveChoice handles direct effect
ok 31 - eventEngine.resolveChoice handles direct effect
  ---
  duration_ms: 0.376783
  type: 'test'
  ...
# Subtest: eventEngine.resolveChoice handles skill check success
ok 32 - eventEngine.resolveChoice handles skill check success
  ---
  duration_ms: 0.276582
  type: 'test'
  ...
# Subtest: eventEngine.resolveChoice handles skill check failure
ok 33 - eventEngine.resolveChoice handles skill check failure
  ---
  duration_ms: 0.394854
  type: 'test'
  ...
# Subtest: eventEngine.resolveChoice uses luck stat for luck checks
ok 34 - eventEngine.resolveChoice uses luck stat for luck checks
  ---
  duration_ms: 0.316403
  type: 'test'
  ...
# Subtest: eventEngine.resolveChoice uses max member skill
ok 35 - eventEngine.resolveChoice uses max member skill
  ---
  duration_ms: 1.821151
  type: 'test'
  ...
# Subtest: eventEngine.resolveChoice preserves nextEventId
ok 36 - eventEngine.resolveChoice preserves nextEventId
  ---
  duration_ms: 0.605672
  type: 'test'
  ...
# Subtest: eventEngine.processOptions returns event when no processing needed
ok 37 - eventEngine.processOptions returns event when no processing needed
  ---
  duration_ms: 0.334787
  type: 'test'
  ...
# Subtest: eventEngine.processOptions handles van_breakdown with spare_tire
ok 38 - eventEngine.processOptions handles van_breakdown with spare_tire
  ---
  duration_ms: 0.186803
  type: 'test'
  ...
# Subtest: eventEngine.processOptions does not add spare tire option without inventory
ok 39 - eventEngine.processOptions does not add spare tire option without inventory
  ---
  duration_ms: 0.14292
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles resource effects
ok 40 - eventEngine.applyResult handles resource effects
  ---
  duration_ms: 0.377021
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles stat effects
ok 41 - eventEngine.applyResult handles stat effects
  ---
  duration_ms: 0.145213
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles harmony stat
ok 42 - eventEngine.applyResult handles harmony stat
  ---
  duration_ms: 0.115955
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles mood changes
ok 43 - eventEngine.applyResult handles mood changes
  ---
  duration_ms: 0.125672
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles stamina changes
ok 44 - eventEngine.applyResult handles stamina changes
  ---
  duration_ms: 0.117727
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles van fuel
ok 45 - eventEngine.applyResult handles van fuel
  ---
  duration_ms: 0.180114
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles van condition stat
ok 46 - eventEngine.applyResult handles van condition stat
  ---
  duration_ms: 0.1125
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles game over flag
ok 47 - eventEngine.applyResult handles game over flag
  ---
  duration_ms: 0.103007
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles story flags
ok 48 - eventEngine.applyResult handles story flags
  ---
  duration_ms: 0.183564
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles chain events
ok 49 - eventEngine.applyResult handles chain events
  ---
  duration_ms: 0.122429
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles composite effects
ok 50 - eventEngine.applyResult handles composite effects
  ---
  duration_ms: 0.152988
  type: 'test'
  ...
# Subtest: eventEngine.applyResult returns null for null result
ok 51 - eventEngine.applyResult returns null for null result
  ---
  duration_ms: 0.152568
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles unlock effects
ok 52 - eventEngine.applyResult handles unlock effects
  ---
  duration_ms: 0.116302
  type: 'test'
  ...
# Subtest: eventEngine.applyResult preserves nextEventId from result
ok 53 - eventEngine.applyResult preserves nextEventId from result
  ---
  duration_ms: 0.114972
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles time stat
ok 54 - eventEngine.applyResult handles time stat
  ---
  duration_ms: 0.109796
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles viral stat
ok 55 - eventEngine.applyResult handles viral stat
  ---
  duration_ms: 0.113725
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles inventory numeric increment
ok 56 - eventEngine.applyResult handles inventory numeric increment
  ---
  duration_ms: 0.137035
  type: 'test'
  ...
# Subtest: eventEngine.applyResult handles inventory non-numeric value
ok 57 - eventEngine.applyResult handles inventory non-numeric value
  ---
  duration_ms: 0.119483
  type: 'test'
  ...
# Subtest: eventEngine logic for inventory increment handles existing values
ok 58 - eventEngine logic for inventory increment handles existing values
  ---
  duration_ms: 0.144558
  type: 'test'
  ...
# Subtest: eventEngine logic prevents negative inventory in delta
not ok 59 - eventEngine logic prevents negative inventory in delta
  ---
  duration_ms: 1.236402
  type: 'test'
  location: '/app/tests/eventEngine.test.js:458:1'
  failureType: 'testCodeFailure'
  error: |-
    Should clamp inventory to 0 in delta

    -5 !== 0

  code: 'ERR_ASSERTION'
  name: 'AssertionError'
  expected: 0
  actual: -5
  operator: 'strictEqual'
  stack: |-
    TestContext.<anonymous> (file:///app/tests/eventEngine.test.js:468:10)
    Test.runInAsyncScope (node:async_hooks:214:14)
    Test.run (node:internal/test_runner/test:1047:25)
    Test.processPendingSubtests (node:internal/test_runner/test:744:18)
    Test.postRun (node:internal/test_runner/test:1173:19)
    Test.run (node:internal/test_runner/test:1101:12)
    async Test.processPendingSubtests (node:internal/test_runner/test:744:7)
  ...
# Subtest: resolveEventChoice returns delta for direct effects
ok 60 - resolveEventChoice returns delta for direct effects
  ---
  duration_ms: 1.632022
  type: 'test'
  ...
# Subtest: resolveEventChoice handles missing choices safely
ok 61 - resolveEventChoice handles missing choices safely
  ---
  duration_ms: 0.259536
  type: 'test'
  ...
# Subtest: applyEventDelta clamps player and band values
ok 62 - applyEventDelta clamps player and band values
  ---
  duration_ms: 1.715151
  type: 'test'
  ...
# Subtest: applyEventDelta updates social channels safely
ok 63 - applyEventDelta updates social channels safely
  ---
  duration_ms: 0.378629
  type: 'test'
  ...
# Subtest: applyEventDelta applies player updates
ok 64 - applyEventDelta applies player updates
  ---
  duration_ms: 1.473754
  type: 'test'
  ...
# Subtest: applyEventDelta clamps values
ok 65 - applyEventDelta clamps values
  ---
  duration_ms: 0.384433
  type: 'test'
  ...
# Subtest: applyEventDelta handles band inventory updates
ok 66 - applyEventDelta handles band inventory updates
  ---
  duration_ms: 0.357891
  type: 'test'
  ...
# Subtest: applyEventDelta handles social updates
ok 67 - applyEventDelta handles social updates
  ---
  duration_ms: 0.250298
  type: 'test'
  ...
# Subtest: applyEventDelta handles flags
ok 68 - applyEventDelta handles flags
  ---
  duration_ms: 0.291353
  type: 'test'
  ...
# Subtest: updateGigPerformanceStats tracks peak combo and hype
ok 69 - updateGigPerformanceStats tracks peak combo and hype
  ---
  duration_ms: 1.237066
  type: 'test'
  ...
# Subtest: buildGigStatsSnapshot includes required economy fields
ok 70 - buildGigStatsSnapshot includes required economy fields
  ---
  duration_ms: 1.0932
  type: 'test'
  ...
# Subtest: getGenImageUrl returns correct URL structure
ok 71 - getGenImageUrl returns correct URL structure
  ---
  duration_ms: 1.351276
  type: 'test'
  ...
# Subtest: IMG_PROMPTS object exists
ok 72 - IMG_PROMPTS object exists
  ---
  duration_ms: 0.300573
  type: 'test'
  ...
# Subtest: MapGenerator generates a map with correct structure
ok 73 - MapGenerator generates a map with correct structure
  ---
  duration_ms: 12.832741
  type: 'test'
  ...
# Subtest: MapGenerator guarantees start node
ok 74 - MapGenerator guarantees start node
  ---
  duration_ms: 3.218145
  type: 'test'
  ...
# Subtest: MapGenerator guarantees finale node
ok 75 - MapGenerator guarantees finale node
  ---
  duration_ms: 7.498947
  type: 'test'
  ...
# Subtest: MapGenerator connections are valid
ok 76 - MapGenerator connections are valid
  ---
  duration_ms: 7.230206
  type: 'test'
  ...
# Subtest: MapGenerator ensures nodes do not overlap
ok 77 - MapGenerator ensures nodes do not overlap
  ---
  duration_ms: 0.850946
  type: 'test'
  ...
# Duplicate found: MTC (Layer 2)
# Subtest: MapGenerator should not have duplicate venues (if possible)
ok 78 - MapGenerator should not have duplicate venues (if possible)
  ---
  duration_ms: 18.188126
  type: 'test'
  ...
# Subtest: calculateNoteY returns target position at hit time
ok 79 - calculateNoteY returns target position at hit time
  ---
  duration_ms: 1.366049
  type: 'test'
  ...
# Subtest: calculateCrowdY offsets by combo intensity
ok 80 - calculateCrowdY offsets by combo intensity
  ---
  duration_ms: 0.359817
  type: 'test'
  ...
# Subtest: calculateLaneStartX centers lanes
ok 81 - calculateLaneStartX centers lanes
  ---
  duration_ms: 0.295836
  type: 'test'
  ...
# Subtest: buildRhythmLayout derives lane and hit line positions
ok 82 - buildRhythmLayout derives lane and hit line positions
  ---
  duration_ms: 0.312059
  type: 'test'
  ...
# Subtest: checkHit finds matching note within window
ok 83 - checkHit finds matching note within window
  ---
  duration_ms: 1.556199
  type: 'test'
  ...
# Subtest: checkHit ignores notes outside window
ok 84 - checkHit ignores notes outside window
  ---
  duration_ms: 0.292933
  type: 'test'
  ...
# Subtest: checkHit ignores wrong lane
ok 85 - checkHit ignores wrong lane
  ---
  duration_ms: 0.192942
  type: 'test'
  ...
# Subtest: checkHit ignores already hit or invisible notes
ok 86 - checkHit ignores already hit or invisible notes
  ---
  duration_ms: 0.204633
  type: 'test'
  ...
# Subtest: checkHit prioritizes closest note?
ok 87 - checkHit prioritizes closest note?
  ---
  duration_ms: 0.266669
  type: 'test'
  ...
# Subtest: generateNotesForSong creates correct note structure
ok 88 - generateNotesForSong creates correct note structure
  ---
  duration_ms: 4.320033
  type: 'test'
  ...
# Subtest: generateNotesForSong respects difficulty
ok 89 - generateNotesForSong respects difficulty
  ---
  duration_ms: 0.506639
  type: 'test'
  ...
# Subtest: getGigModifiers returns default modifiers for average band
ok 90 - getGigModifiers returns default modifiers for average band
  ---
  duration_ms: 3.38204
  type: 'test'
  ...
# Subtest: getGigModifiers grants telepathy bonus for high harmony
ok 91 - getGigModifiers grants telepathy bonus for high harmony
  ---
  duration_ms: 0.393296
  type: 'test'
  ...
# Subtest: getGigModifiers applies disconnect penalty for low harmony
ok 92 - getGigModifiers applies disconnect penalty for low harmony
  ---
  duration_ms: 0.206767
  type: 'test'
  ...
# Subtest: getGigModifiers has no special effects for mid harmony
ok 93 - getGigModifiers has no special effects for mid harmony
  ---
  duration_ms: 0.258789
  type: 'test'
  ...
# Subtest: getGigModifiers applies grumpy Matze penalty
ok 94 - getGigModifiers applies grumpy Matze penalty
  ---
  duration_ms: 0.396922
  type: 'test'
  ...
# Subtest: getGigModifiers does not apply Matze penalty when mood is okay
ok 95 - getGigModifiers does not apply Matze penalty when mood is okay
  ---
  duration_ms: 0.182939
  type: 'test'
  ...
# Subtest: getGigModifiers applies tired Lars speed increase
ok 96 - getGigModifiers applies tired Lars speed increase
  ---
  duration_ms: 0.471738
  type: 'test'
  ...
# Subtest: getGigModifiers does not apply Lars penalty when stamina is okay
ok 97 - getGigModifiers does not apply Lars penalty when stamina is okay
  ---
  duration_ms: 0.190649
  type: 'test'
  ...
# Subtest: getGigModifiers can apply multiple effects
ok 98 - getGigModifiers can apply multiple effects
  ---
  duration_ms: 0.819441
  type: 'test'
  ...
# Subtest: calculateGigPhysics returns physics object
ok 99 - calculateGigPhysics returns physics object
  ---
  duration_ms: 0.778482
  type: 'test'
  ...
# Subtest: calculateGigPhysics calculates hit windows based on skill
ok 100 - calculateGigPhysics calculates hit windows based on skill
  ---
  duration_ms: 0.273601
  type: 'test'
  ...
# Subtest: calculateGigPhysics skill increases hit windows
ok 101 - calculateGigPhysics skill increases hit windows
  ---
  duration_ms: 0.427698
  type: 'test'
  ...
# Subtest: calculateGigPhysics reduces speed for low stamina
ok 102 - calculateGigPhysics reduces speed for low stamina
  ---
  duration_ms: 0.184104
  type: 'test'
  ...
# Subtest: calculateGigPhysics normal speed for adequate stamina
ok 103 - calculateGigPhysics normal speed for adequate stamina
  ---
  duration_ms: 0.153476
  type: 'test'
  ...
# Subtest: calculateGigPhysics returns default multipliers
ok 104 - calculateGigPhysics returns default multipliers
  ---
  duration_ms: 0.136355
  type: 'test'
  ...
# Subtest: calculateGigPhysics applies blast machine trait for fast songs
ok 105 - calculateGigPhysics applies blast machine trait for fast songs
  ---
  duration_ms: 0.432527
  type: 'test'
  ...
# Subtest: calculateGigPhysics does not apply blast machine for slow songs
ok 106 - calculateGigPhysics does not apply blast machine for slow songs
  ---
  duration_ms: 0.277298
  type: 'test'
  ...
# Subtest: calculateGigPhysics includes avgStamina in result
ok 107 - calculateGigPhysics includes avgStamina in result
  ---
  duration_ms: 0.328967
  type: 'test'
  ...
# Subtest: calculateGigPhysics handles missing member gracefully
ok 108 - calculateGigPhysics handles missing member gracefully
  ---
  duration_ms: 0.177123
  type: 'test'
  ...
# Subtest: calculateGigPhysics handles missing skill property
ok 109 - calculateGigPhysics handles missing skill property
  ---
  duration_ms: 1.4387
  type: 'test'
  ...
# Subtest: SOCIAL_PLATFORMS contains expected platforms
ok 110 - SOCIAL_PLATFORMS contains expected platforms
  ---
  duration_ms: 3.42911
  type: 'test'
  ...
# Subtest: SOCIAL_PLATFORMS have multipliers
ok 111 - SOCIAL_PLATFORMS have multipliers
  ---
  duration_ms: 0.333167
  type: 'test'
  ...
# Subtest: calculateViralityScore returns base chance for average performance
ok 112 - calculateViralityScore returns base chance for average performance
  ---
  duration_ms: 0.224907
  type: 'test'
  ...
# Subtest: calculateViralityScore increases with high performance
ok 113 - calculateViralityScore increases with high performance
  ---
  duration_ms: 0.225686
  type: 'test'
  ...
# Subtest: calculateViralityScore applies performance multipliers
ok 114 - calculateViralityScore applies performance multipliers
  ---
  duration_ms: 0.401196
  type: 'test'
  ...
# Subtest: calculateViralityScore boosts for Kaminstube venue
ok 115 - calculateViralityScore boosts for Kaminstube venue
  ---
  duration_ms: 0.197575
  type: 'test'
  ...
# Subtest: calculateViralityScore boosts for stage diver event
ok 116 - calculateViralityScore boosts for stage diver event
  ---
  duration_ms: 0.339603
  type: 'test'
  ...
# Subtest: calculateViralityScore boosts for influencer event
ok 117 - calculateViralityScore boosts for influencer event
  ---
  duration_ms: 0.191519
  type: 'test'
  ...
# Subtest: calculateViralityScore is capped at 90%
ok 118 - calculateViralityScore is capped at 90%
  ---
  duration_ms: 0.575967
  type: 'test'
  ...
# Subtest: calculateViralityScore combines multiple bonuses
ok 119 - calculateViralityScore combines multiple bonuses
  ---
  duration_ms: 0.542272
  type: 'test'
  ...
# Subtest: generatePostOptions returns array of options
ok 120 - generatePostOptions returns array of options
  ---
  duration_ms: 0.486185
  type: 'test'
  ...
# Subtest: generatePostOptions includes moshpit option
ok 121 - generatePostOptions includes moshpit option
  ---
  duration_ms: 0.192395
  type: 'test'
  ...
# Subtest: generatePostOptions includes technical option
ok 122 - generatePostOptions includes technical option
  ---
  duration_ms: 0.154732
  type: 'test'
  ...
# Subtest: generatePostOptions includes band pic option
ok 123 - generatePostOptions includes band pic option
  ---
  duration_ms: 0.200466
  type: 'test'
  ...
# Subtest: generatePostOptions scales mosh viral chance
ok 124 - generatePostOptions scales mosh viral chance
  ---
  duration_ms: 0.203148
  type: 'test'
  ...
# Subtest: generatePostOptions all have required properties
ok 125 - generatePostOptions all have required properties
  ---
  duration_ms: 0.195534
  type: 'test'
  ...
# Subtest: resolvePost handles viral success
ok 126 - resolvePost handles viral success
  ---
  duration_ms: 0.195918
  type: 'test'
  ...
# Subtest: resolvePost handles non-viral post
ok 127 - resolvePost handles non-viral post
  ---
  duration_ms: 0.20026
  type: 'test'
  ...
# Subtest: resolvePost viral multiplies by 10
ok 128 - resolvePost viral multiplies by 10
  ---
  duration_ms: 0.140083
  type: 'test'
  ...
# Subtest: resolvePost handles edge case of 0 base followers
ok 129 - resolvePost handles edge case of 0 base followers
  ---
  duration_ms: 1.520931
  type: 'test'
  ...
# Subtest: resolvePost threshold at exact viral chance
ok 130 - resolvePost threshold at exact viral chance
  ---
  duration_ms: 0.242893
  type: 'test'
  ...
# Subtest: resolvePost preserves all platforms
ok 131 - resolvePost preserves all platforms
  ---
  duration_ms: 0.203999
  type: 'test'
  ...
# Subtest: resolvePost returns consistent structure
ok 132 - resolvePost returns consistent structure
  ---
  duration_ms: 0.12885
  type: 'test'
  ...
# Subtest: calculateViralityScore handles low performance
ok 133 - calculateViralityScore handles low performance
  ---
  duration_ms: 0.108501
  type: 'test'
  ...
# Subtest: generatePostOptions viral chances are reasonable
ok 134 - generatePostOptions viral chances are reasonable
  ---
  duration_ms: 0.147302
  type: 'test'
  ...
1..134
# tests 134
# suites 0
# pass 131
# fail 2
# cancelled 0
# skipped 1
# todo 0
# duration_ms 666.417627
